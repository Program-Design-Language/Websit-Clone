<!DOCTYPE html>
<html lang="ja">
<head>
  <script data-ad-client="ca-pub-6511020045004282" async src="../../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" tppabs="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async src="../../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" tppabs="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6511020045004282",
      enable_page_level_ads: true
    });
  </script>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>増殖した条件付き書式を整理統合する｜VBAサンプル集</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="コピペによって条件付き書式は際限なく増加していきます。あまり増えすぎると、Excelの動作が遅くなる場合もありますし、条件や書式を変更したい時にも困ることになります。このような場合は、条件付き書式を消して再設定するしかなくなります、これを解決するVBAを考えてみました。">
  <meta name="keywords" content="サンプル集,エクセル,Excel,マクロ,VBA">
  <link rel="icon" type="image/x-icon" href="../images/favicon_excel.png">
  <link rel="stylesheet" href="../css/style.css-20210304.css" tppabs="https://excel-ubara.com/css/style.css?20210304">
  <link rel="stylesheet" href="../css/slide.css-20210304.css" tppabs="https://excel-ubara.com/css/slide.css?20210304">
  <link rel="canonical" href="https://excel-ubara.com/excelvba5/EXCELVBA262.html" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="増殖した条件付き書式を整理統合する｜VBAサンプル集" />
  <meta property="og:description" content="コピペによって条件付き書式は際限なく増加していきます。あまり増えすぎると、Excelの動作が遅くなる場合もありますし、条件や書式を変更したい時にも困ることになります。このような場合は、条件付き書式を消して再設定するしかなくなります、これを解決するVBAを考えてみました。" />
  <meta property="og:image" content="https://excel-ubara.com/excelvba5/image113.jpg" />
  <meta property="og:url" content="https://excel-ubara.com/excelvba5/EXCELVBA262.html" />
  <meta property="og:site_name" content="エクセルの神髄" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="増殖した条件付き書式を整理統合する｜VBAサンプル集" />
  <meta name="twitter:description" content="コピペによって条件付き書式は際限なく増加していきます。あまり増えすぎると、Excelの動作が遅くなる場合もありますし、条件や書式を変更したい時にも困ることになります。このような場合は、条件付き書式を消して再設定するしかなくなります、これを解決するVBAを考えてみました。" />
  <meta name="twitter:image" content="https://excel-ubara.com/excelvba5/image113.jpg" />
  <meta name="twitter:site" content="@yamaoka_ss" />
  <script src="../../code.jquery.com/jquery-3.3.1.min.js" tppabs="https://code.jquery.com/jquery-3.3.1.min.js" async></script>
  <script type="text/javascript" src="../js/fix.js" tppabs="https://excel-ubara.com/js/fix.js" async></script>
  <script type="text/javascript" src="../js/fixmenu_pagetop.js-20210304" tppabs="https://excel-ubara.com/js/fixmenu_pagetop.js?20210304" async></script>
  <script type="text/javascript" src="../js/CopyDisp.js-20210304" tppabs="https://excel-ubara.com/js/CopyDisp.js?20210304" async></script>
</head>

<body class="c2">
  <header>
    <div class="inner">
      <p id="logo"><a href="../index.htm" tppabs="https://excel-ubara.com/"><img src="../images/logo.png" tppabs="https://excel-ubara.com/images/logo.png" alt="エクセルの神髄"></a></p>
      <div id="contact">
        <h1>VBAサンプル集<br>増殖した条件付き書式を整理統合する</h1>ExcelマクロVBAの実用サンプル、エクセルVBA集と解説
      </div>
    </div>
  </header>

  <!--PC用（801px以上端末）メニュー-->
  <nav id="dropmenu">
    <ul class="inner">
      <li><a href="../excel_index.html" tppabs="https://excel-ubara.com/excel_index.html">Excel全般<span>Excel</span></a>
        <ul>
          <li><A href="../excel1/index.htm" tppabs="https://excel-ubara.com/excel1/">エクセル入門</A></li>
          <li><A href="../excel2/index.htm" tppabs="https://excel-ubara.com/excel2/">エクセル基本操作</A></li>
          <li><A href="../excel3/index.htm" tppabs="https://excel-ubara.com/excel3/">エクセル関数応用</A></li>
          <li><A href="../excel4/index.htm" tppabs="https://excel-ubara.com/excel4/">エクセル挑戦問題</A></li>
          <li><A href="../EXCEL/excel_reference.html" tppabs="https://excel-ubara.com/EXCEL/excel_reference.html">Excelリファレンス</A></li>
          <li><A href="../excel5/index.htm" tppabs="https://excel-ubara.com/excel5/">エクセル雑感</A></li>
        </ul>
      </li>
      <li><a href="../excel_vba1.html" tppabs="https://excel-ubara.com/excel_vba1.html">マクロVBA入門編<span>VBA Beginner</span></a>
        <ul>
          <li><a href="../excelvba1/index.htm" tppabs="https://excel-ubara.com/excelvba1/">マクロVBA入門</a></li>
          <li><a href="../excelvba1r/index.htm" tppabs="https://excel-ubara.com/excelvba1r/">マクロVBA再入門</a></li>
          <li><a href="../excelvba2/index.htm" tppabs="https://excel-ubara.com/excelvba2/">マクロ記録でVBA</a></li>
          <li><a href="../excelvba9/index.htm" tppabs="https://excel-ubara.com/excelvba9/">マクロVBA練習問題</a></li>
          <li><a href="../MOS_VBA/index.htm" tppabs="https://excel-ubara.com/MOS_VBA/">VBAエキスパート対策</a></li>
          <li><A href="../excelvba8/index.htm" tppabs="https://excel-ubara.com/excelvba8/">マクロVBA関数</A></li>
          <li><A href="../vba100/index.htm" tppabs="https://excel-ubara.com/vba100/">VBA100本ノック</A></li>
        </ul>
      </li>
      <li><a href="../excel_vba2.html" tppabs="https://excel-ubara.com/excel_vba2.html">マクロVBA応用編<span>VBA Advanced</span></a>
        <ul>
          <li><A href="../excelvba3/index.htm" tppabs="https://excel-ubara.com/excelvba3/">ユーザーフォーム入門</A></li>
          <li><A href="../vba_class/index.htm" tppabs="https://excel-ubara.com/vba_class/">VBAクラス入門</A></li>
          <li><A href="index.htm" tppabs="https://excel-ubara.com/excelvba5/">マクロVBAサンプル集</A></li>
          <li><A href="../excelvba4/index.htm" tppabs="https://excel-ubara.com/excelvba4/">マクロVBA技術解説</A></li>
          <li><A href="../excelvba7/index.htm" tppabs="https://excel-ubara.com/excelvba7/">エクセル顧客管理</A></li>
          <li><A href="../EXCEL/vba_reference.html" tppabs="https://excel-ubara.com/EXCEL/vba_reference.html">VBAリファレンス</A></li>
        </ul>
      </li>
      <li><a href="../excel_other.html" tppabs="https://excel-ubara.com/excel_other.html">その他（Excel以外）<span>Other than Excel</span></a>
        <ul>
          <li><A href="../python/index.htm" tppabs="https://excel-ubara.com/python/">Python入門</A></li>
          <li><A href="../vba_sql/index.htm" tppabs="https://excel-ubara.com/vba_sql/">SQL入門</A></li>
          <li><A href="../spreadsheet1/index.htm" tppabs="https://excel-ubara.com/spreadsheet1/">スプレッドシート入門</A></li>
          <li><A href="../apps_script1/index.htm" tppabs="https://excel-ubara.com/apps_script1/">GAS入門</A></li>
        </ul>
      </li>
      <li><a href="../siteguide.html" tppabs="https://excel-ubara.com/siteguide.html">サイト案内<span>site map</span></a>
        <ul>
          <li><A href="../EXCELNEW.html" tppabs="https://excel-ubara.com/EXCELNEW.html">新着記事一覧</A></li>
          <li><A href="../EXCELRANK.html" tppabs="https://excel-ubara.com/EXCELRANK.html">アクセスランキング</A></li>
          <li><A href="../sitemap.html" tppabs="https://excel-ubara.com/sitemap.html">サイトマップ&nbsp;&nbsp;</A></li>
          <li><a href="../business/index.htm" tppabs="https://excel-ubara.com/business/">旧トップページ&nbsp;&nbsp;</a></li>
          <li><A href="../query.html" tppabs="https://excel-ubara.com/query.html">お問い合わせ&nbsp;&nbsp;</A></li>
        </ul>
      </li>
    </ul>
  </nav>

  <div id="pan"><ul itemscope itemtype="http://schema.org/BreadcrumbList">
<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="item" href="../index.htm" tppabs="https://excel-ubara.com/">
<span itemprop="name">ホーム</span></a>
<meta itemprop="position" content="1" />
</li>
<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="item" href="../excel_vba2.html" tppabs="https://excel-ubara.com/excel_vba2.html">
<span itemprop="name">マクロVBA応用編</span></a>
<meta itemprop="position" content="2" />
</li>
<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="item" href="index.htm" tppabs="https://excel-ubara.com/excelvba5/">
<span itemprop="name">マクロVBAサンプル集</span></a>
<meta itemprop="position" content="3" />
</li>
<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="item" href="EXCELVBA262.html" tppabs="https://excel-ubara.com/excelvba5/EXCELVBA262.html">
<span itemprop="name">増殖した条件付き書式を整理統合する</span></a>
<meta itemprop="position" content="4" />
</li>
</ul></div>
  <div class="ads1">
    <center>
    <script async src="../../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" tppabs="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- yama21 -->
    <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-6511020045004282"
        data-ad-slot="1104944574"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    </center>
  </div>

  <div id="contents" class="inner">
    <div id="contents-in">
      <div id="main">
        <section>
          <span style="line-height:20px;float:right" align="right">最終更新日：2020-12-09</span>
<h2 align="center">増殖した条件付き書式を整理統合する</h2><p><br>
コピペによって条件付き書式は際限なく増加していきます。<br>
あまり増えすぎると、Excelの動作が遅くなる場合もありますし、条件や書式を変更したい時にも困ることになります。<br>
このような場合は、条件付き書式を消して再設定するしかなくなります、<br><div class="br2"><br></div>
これを解決するVBAを考えてみました。<br><div class="br2"><br></div></p>
<h3>条件付き書式の増殖に関する、Microsoft サポート </h3>
<div class="main-indent"><a href="javascript:if(confirm('https://support.microsoft.com/ja-jp/help/2537195  \n\nļ޷ Teleport Ultra , Ϊ һ·ⲿΪʼַĵַ  \n\nڷϴ?'))window.location='https://support.microsoft.com/ja-jp/help/2537195'" tppabs="https://support.microsoft.com/ja-jp/help/2537195" target="_blank">Excel 2007 条件付き書式をコピーした場合、以前より条件付き書式が増加する<br>
</a><br>
こちらのページは結構有名かもしれないので、見たことのある人もいるかもしれません。<br>
2007で変更になった仕様によるとの言い訳は仕方ないとして、<br>
回避策が書かれていますが、<br><div class="br2"><br></div>
<strong>回避策</strong>
</div>
<div class="main-indent">
<div class="main-indent"><i>条件付き書式の増加により動作が遅くなった場合、 以下の手順で条件付き書式を削除後、条件付き書式を再度設定します。<br>
[ホーム] タブの [ルールのクリア]-[シート全体からルールをクリア] を選択します。<br>
同じ条件を設定するセルを適宜選択し、条件付き書式を設定します。</i><br><div class="br2"><br></div>
これは回避策ではなく、事後処理（というか事故処理）ですよね。</div>
<strong>状況</strong>
</div>
<div class="main-indent">
<div class="main-indent"><i><strong>この動作は仕様です。</strong></i><br><div class="br2"><br></div>
</div>
</div>
<div class="main-indent">最後は言い切りましたね。<br>
その潔さは認めます。<br>
そうです、ソフト作成において最終最後の言葉です。<br><div class="br2"><br></div>
</div>
<div class="main-indent">
<div class="ads1">
<script async src="../../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" tppabs="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-6511020045004282"
     data-ad-slot="6991829975"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div></div><h3>増殖した条件付き書式の実例と対応</h3>
<div class="main-indent"><img src="image113.jpg" tppabs="https://excel-ubara.com/excelvba5/image113.jpg" width="696" height="321" border="0" alt="VBA マクロ 条件付き書式"><br><div class="br2"><br></div>
右のスクロールバーを見てもらえれば分かる通り、<br>
こうなってしまっては、手作業での修正は諦めた方が良いでしょう。<br><div class="br2"><br></div>
<img src="image310.jpg" tppabs="https://excel-ubara.com/excelvba5/image310.jpg" width="457" height="431" border="0" alt="VBA マクロ 条件付き書式"><br><div class="br2"><br></div>
全て削除してから再度条件付き書式を設定するか、<br>
1行だけ残して（2行目を残すなら、3行目から最下行まで選択して）、ルールをクリアして、<br>
2行目の条件付き書式の適用範囲を変更します。<br><div class="br2"><br></div>
これをVBAにするのは簡単です。<br>
自動記録でも十分でしょう、セル範囲くらいを変更すれば使えます。<br><div class="br2"><br></div>
しかし、<br>
行方向・列方向に飛び飛びの範囲に設定されていたりすると、もうお手上げになります。<br><div class="br2"><br></div>
ちなみに、条件付き書式が設定されているセルを全て選択するには、<br>
ジャンプ（Ctrl+G）→セル選択<br><div class="br2"><br></div>
<img src="image55.jpg" tppabs="https://excel-ubara.com/excelvba5/image55.jpg" width="358" height="395" border="0" alt="VBA マクロ 条件付き書式"><br><div class="br2"><br></div>
</div>
<h3>簡単なVBAでの対応 </h3>
<div class="main-indent">
<h4>全ての条件付き書式をクリアして再設定</h4>
</div>
<div class="main-indent">
<div class="main-indent">
<form>
<input type="button" value="VBAをコピー" onclick="fncVbaCopy(this)">
</form>
<div class="table-scroll"><code class="vbacode"><table border="1" cellpadding="10">
  <tbody>
    <tr>
      <td>Sub sample1()<br>
      　　With Worksheets(&quot;Sheet1&quot;).Range(&quot;A1:A10&quot;)<br>
      　　　　.FormatConditions.Delete<br>
      　　　　.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, Formula1:=&quot;90%&quot;<br>
      　　　　.FormatConditions(1).Interior.Color = vbRed<br>
      　　　　.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, Formula1:=&quot;100%&quot;<br>
      　　　　.FormatConditions(2).Interior.Color = vbYellow<br>
      　　End With<br>
      End Sub</td>
    </tr>
  </tbody>
</table></code></div><br>
マクロの自動記録で作成されたVBAを変更すれば簡単に作成できま。<br><div class="br2"><br></div>
</div>
</div>
<div class="main-indent">
<h4>2行目の条件付き書式だけ残しクリア後に、2行目の適用範囲を変更</h4>
</div>
<div class="main-indent">
<div class="main-indent">
<form>
<input type="button" value="VBAをコピー" onclick="fncVbaCopy(this)">
</form>
<div class="table-scroll"><code class="vbacode"><table border="1" cellpadding="10">
  <tbody>
    <tr>
      <td>Sub sample2()<br>
      　　Dim ws As Worksheet<br>
      　　Dim fObj As Object<br>
      　　Dim i As Long<br>
      　　Set ws = ActiveSheet<br>
      　　ws.Range(&quot;3:1000&quot;).FormatConditions.Delete<br>
      　　For i = ws.Rows(2).FormatConditions.Count To 1 Step -1<br>
      　　　　Set fObj = ws.Rows(2).FormatConditions(i)<br>
      　　　　fObj.ModifyAppliesToRange fObj.AppliesTo.Resize(999)<br>
      　　Next<br>
      End Sub</td>
    </tr>
  </tbody>
</table></code></div><br>
<strong>For Each</strong>で処理したVBAコードを試して見たところ、<br>
同一セル範囲に同一条件付き書式があるような特殊な場合、<br>
<font color="#ff0000">Excelが落ちてしまう事がありました。</font><br><div class="br2"><br></div>
このVBAコードであれば問題ないと思いますが、<br>
使う時には、必ずバックアップしてから実行する等の注意をしてください。<br><div class="br2"><br></div>
</div>
VBAの条件付き書式の基本については、<br>
<strong><a href="../excelvba1/EXCELVBA391.html" tppabs="https://excel-ubara.com/excelvba1/EXCELVBA391.html" target="_blank">マクロVBA入門：第91回.条件付き書式（FormatCondition）</a></strong><div class="details">条件付き書式は、シート上で設定しておいた方が良いのですが、事前に設定しておけない場合は、VBAで条件付き書式を設定します。VBAで条件付き書式を設定する場合は、セル（Rangeオブジェクト）のFormatConditionsコレクションにFormatConditionオブジェクトを追加することで行います。</div>
こちらを参考にしてください。<br>
</div>
<h3>VBAで条件付き書式を整理統合した結果</h3>
<div class="main-indent">この後に掲載してあるVBAであれば、上の画像の条件付き書式が、このように整理統合されます。<br><div class="br2"><br></div>
<img src="image47.jpg" tppabs="https://excel-ubara.com/excelvba5/image47.jpg" width="696" height="321" border="0" alt="VBA マクロ 条件付き書式"><br><div class="br2"><br></div>
1行目は、歯抜けの範囲に同じ条件付き書式が設定されていたようです。<br>
これは、私が実際に使っているExcelですが、行挿入して書式が抜けている行があったという事です。<br>
ここまで統合されれば、設定漏れも分かりますし、手作業で直すも簡単です。<br><div class="br2"><br></div>
こんなVBAが欲しかったという人が多くいるのではないかとの思いで作成してみました。<br>
私自身が、このVBAによって今後の作業がかなり楽になると思っています。<br><div class="br2"><br></div>
</div>
<div class="main-indent">
<div class="ads1">
<script async src="../../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" tppabs="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-6511020045004282"
     data-ad-slot="7467492230"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div></div><h3>今回のVBAコードの発想について</h3>
<div class="main-indent">この仕様については、私も結構悩まされてきました。<br>
手作業で、幾度となく条件付き書式を再設定してきました。<br>
頻繁に発生するシートの場合は、<br>
先に示したようなVBAで、<br>
条件付き書式を削除して再設定できるようにマクロを用意しておいたりして対処してきました。<br><div class="br2"><br></div>
常々、この仕様は困ったものだとの思いと、なんとか出来ないものかとの思いは持っていました。<br><div class="br2"><br></div>
最近も条件付き書式が増加しているシートがあったので、手作業で再設定していて、<br>
「これ、なんとか出来ないかなー、出来ないことないはずだよなー」、と思い立ち、<br>
いろいろ考えてみたのですが、これがかなり難しい。<br><div class="br2"><br></div>
<strong>・何をもって、増殖してしまった条件付き書式と判定するのか</strong><br>
<strong>・何をもって、同じ条件付き書式と判定するのか</strong><br><div class="br2"><br></div>
VBAコードのプログラミング以前に、仕様を決定出来ないのです。<br>
頭を整理して、良く考えてみました。<br>
問題は、<br>
数式が同じかどうか・・・<br><div class="br2"><br></div>
</div>
<div class="main-indent">
<h4>数式が同じかどうかの判定</h4>
</div>
<div class="main-indent">
<div class="main-indent">適用先：=<strong>$A$1:$A$10</strong><br>
<img src="image121.jpg" tppabs="https://excel-ubara.com/excelvba5/image121.jpg" width="395" height="246" border="0" alt="VBA マクロ 条件付き書式"><br><div class="br2"><br></div>
適用先：=<strong>$A$11:$A$20</strong><br>
<img src="image192.jpg" tppabs="https://excel-ubara.com/excelvba5/image192.jpg" width="395" height="246" border="0" alt="VBA マクロ 条件付き書式"><br><div class="br2"><br></div>
この2つの条件付き書式は同じものです。<br>
コピペで作ったものです。<br><div class="br2"><br></div>
セル範囲の条件付き書式では、多くの数式は相対参照で書かれています。<br>
つまり、コピーで増えた条件付き書式の数式は、コピペ先のセル参照に変更されています。<br><div class="br2"><br></div>
条件付き書式が設定されているセルと、数式が参照しているセルの位置関係が同じかどうか、<br>
そんな判定をどのようにしたら良いのか・・・<br><div class="br2"><br></div>
当初は、<br>
<strong>同じセルにコピペして、その数式が同じなら同じ数式ではないか！</strong><br>
このように考えてVBAを作成して公開しましたが、<br>
しかし、この記事をお読みになった方からより良い情報をいただきました。<br>
<strong>数式をR1C1形式に変換して比較</strong><br>
確かに、言われてみればその通りで、<br>
条件付き書式の適用範囲の先頭セルを起点としたR1C1形式で比較すれば数式の同一性が判定できます。<br>
そして、数式をR1C1形式に変換するには、ApplicationのConvertFormulaメソッドを使います。<br><div class="br2"><br></div>
また、分断されているセル範囲を連続セル範囲へ変換する方法も、<br>
単純にUnionするだけだったものを力業で統合していたので改修しました。<br>
さらに、全VBAを見直し、プロシージャーの単位も変更しました。<br>
結果として、大幅に簡易なVBAになったと思います。<br><div class="br2"><br></div>
</div>
</div>
<h3>Application.ConvertFormulaメソッド</h3>
<div class="main-indent">A1およびR1C1参照スタイルの間の数式でのセル参照を、相対参照と絶対参照の間、またはその両方に変換します。<br><div class="br2"><br></div>
<strong>Application.ConvertFormula (Formula, FromReferenceStyle, ToReferenceStyle,
ToAbsolute, RelativeTo)</strong><br><div class="br2"><br></div>
<div class="table-scroll"><table border="1" cellpadding="5">
<tbody>
  <tr>
    <td>名前</td>
    <td>必須</td>
    <td>説明</td>
  </tr>
  <tr>
    <td>Formula</td>
    <td>必須</td>
    <td>変換する数式を含む文字列を指定します。<br>
      必ず有効な数式を指定し、数式の先頭には等号 (=) を付けてください。</td>
  </tr>
  <tr>
    <td>FromReferenceStyle</td>
    <td>必須</td>
    <td>変換前の参照形式を、XlReferenceStyleの定数で指定します。</td>
  </tr>
  <tr>
    <td>ToReferenceStyle</td>
    <td>省略可</td>
    <td>取得する参照スタイルを指定するXlReferenceStyleの定数です。<br>
      この引数を省略すると参照形式は変更されず、引数FromReferenceStyleで指定された形式が使用されます。</td>
  </tr>
  <tr>
    <td>ToAbsolute</td>
    <td>省略可</td>
    <td>変換された参照型を指定するXlReferenceTypeの定数です。<br>
      この引数を省略すると、参照の種類は変更されません。</td>
  </tr>
  <tr>
    <td>RelativeTo</td>
    <td>省略可</td>
    <td>1 つのセルを含むRangeオブジェクトを指定します。<br>
      このセルは、相対参照の基点となります。</td>
  </tr>
</tbody>
</table></div><br>
</div>
<h3>増殖した条件付き書式を整理統合するVBA</h3>
<div class="main-indent">
<form>
<input type="button" value="VBAをコピー" onclick="fncVbaCopy(this)">
</form>
<div class="table-scroll"><code class="vbacode"><table border="1" cellpadding="10">
  <tbody>
    <tr>
      <td>Option Explicit<br><div class="br2"><br></div>
<span style="color:#009900;">'条件付き書式を格納する構造体</span><br>
Type tFormat<br>
　　AppliesTo As Range <span style="color:#009900;">'適用範囲</span><br>
　　Formula1 As String <span style="color:#009900;">'数式1</span><br>
　　Formula2 As String <span style="color:#009900;">'数式2</span><br>
　　Operator As String <span style="color:#009900;">'演算子</span><br>
　　NumberFormat As String <span style="color:#009900;">'表示形式</span><br>
　　FontBold As String <span style="color:#009900;">'太字</span><br>
　　FontColor As String <span style="color:#009900;">'文字色</span><br>
　　InteriorColor As String <span style="color:#009900;">'塗りつぶし色</span><br>
　　<span style="color:#009900;">'追加判定したいプロパティはここに追加</span><br>
End Type<br><div class="br2"><br></div>
Public Sub UnionFormatConditions(ByVal ws As Worksheet, _<br>
　　　　　　　　　　　　　　　　 Optional ByVal NewName As String = &quot;&quot;)<br>
　　<span style="color:#009900;">'条件付き書式を格納する構造体配列</span><br>
　　Dim fAry() As tFormat<br>
　<br>
　　<span style="color:#009900;">'条件付き書式が無い場合は終了</span><br>
　　If ws.Cells.FormatConditions.Count = 0 Then Exit Sub<br>
　<br>
　　<span style="color:#009900;">'オプションにより元シートをコピー</span><br>
　　If NewName &lt;&gt; &quot;&quot; Then<br>
　　　　ws.Copy After:=ws<br>
　　　　Set ws = ActiveSheet<br>
　　　　ws.Name = NewName <span style="color:#009900;">'シート名のチェックは省略しています。</span><br>
　　End If<br>
　<br>
　　<span style="color:#009900;">'条件付き書式を構造体配列へ格納</span><br>
　　Call SetFormatToType(fAry, ws)<br>
　<br>
　　<span style="color:#009900;">'同一条件付き書式の結合：配列内でセル範囲指定文字列を結合</span><br>
　　Call JoinAppliesTo(fAry, ws)<br>
　<br>
　　<span style="color:#009900;">'条件付き書式の統合：配列内のAppliesをFormatConditionに適用</span><br>
　　Call ModifyApplies(fAry, ws)<br>
End Sub<br><div class="br2"><br></div>
<span style="color:#009900;">'条件付き書式を構造体配列へ格納</span><br>
Private Sub SetFormatToType(ByRef fAry() As tFormat, _<br>
　　　　　　　　　　　　　　ByVal ws As Worksheet)<br>
　　Dim i As Long<br>
　　Dim fObj As FormatCondition<br>
　　On Error Resume Next <span style="color:#009900;">'.Formula2が取得できない場合の対処</span><br>
　<br>
　　ReDim fAry(ws.Cells.FormatConditions.Count)<br>
　　For i = 1 To ws.Cells.FormatConditions.Count<br>
　　　　Set fObj = ws.Cells.FormatConditions(i)<br>
　　　　Set fAry(i).AppliesTo = fObj.AppliesTo<br>
　　　　fAry(i).Formula1 = fObj.Formula1<br>
　　　　fAry(i).Formula2 = fObj.Formula2<br>
　　　　fAry(i).Operator = fObj.Operator<br>
　　　　fAry(i).NumberFormat = fObj.NumberFormat<br>
　　　　fAry(i).FontBold = fObj.Font.Bold<br>
　　　　fAry(i).FontColor = fObj.Font.Color<br>
　　　　fAry(i).InteriorColor = fObj.Interior.Color<br>
　　　　<span style="color:#009900;">'追加判定したいプロパティはここに追加</span><br>
　　<br>
　　　　<span style="color:#009900;">'数式エラーの条件付き書式は削除をする</span><br>
　　　　If isErrorFormula(fAry(i).Formula1) Or _<br>
　　　　　 isErrorFormula(fAry(i).Formula1) Then<br>
　　　　　　Set fAry(i).AppliesTo = Nothing<br>
　　　　End If<br>
　　Next<br>
End Sub<br><div class="br2"><br></div>
<span style="color:#009900;">'条件付き書式の数式エラー判定</span><br>
Private Function isErrorFormula(ByVal sFormula As String) As Boolean<br>
　　If IsError(Evaluate(sFormula)) Then<br>
　　　　isErrorFormula = True<br>
　　Else<br>
　　　　isErrorFormula = False<br>
　　End If<br>
End Function<br><div class="br2"><br></div>
<span style="color:#009900;">'同一条件付き書式の結合：配列内でセル範囲指定文字列を結合</span><br>
Private Sub JoinAppliesTo(ByRef fAry() As tFormat, _<br>
　　　　　　　　　　　　　 ByVal ws As Worksheet)<br>
　　Dim i1 As Long, i2 As Long<br>
　　For i1 = 1 To UBound(fAry)<br>
　　　　For i2 = 1 To i1 - 1<br>
　　　　　　<span style="color:#009900;">'計算式1,2、文字色、塗りつぶしの一致判定</span><br>
　　　　　　If isMatchFormat(fAry(i1), fAry(i2), ws) Then<br>
　　　　　　　　Set fAry(i2).AppliesTo = Union(fAry(i2).AppliesTo, fAry(i1).AppliesTo)<br>
　　　　　　　　Set fAry(i1).AppliesTo = Nothing<br>
　　　　　　　　Exit For<br>
　　　　　　End If<br>
　　　　Next<br>
　　Next<br>
End Sub<br><div class="br2"><br></div>
<span style="color:#009900;">'計算式1,2、演算子、文字色、塗りつぶしの一致判定</span><br>
Private Function isMatchFormat(ByRef fAry1 As tFormat, _<br>
　　　　　　　　　　　　　　　 ByRef fAry2 As tFormat, _<br>
　　　　　　　　　　　　　　　 ByVal ws As Worksheet) As Boolean<br>
　　If fAry1.AppliesTo Is Nothing Or _<br>
　　　 fAry2.AppliesTo Is Nothing Then<br>
　　　　Exit Function<br>
　　End If<br>
　<br>
　　Dim sFormula1 As String, sFormula2 As String<br>
　　isMatchFormat = True<br>
　<br>
　　<span style="color:#009900;">'計算式1</span><br>
　　sFormula1 = ToR1C1(fAry1.Formula1, fAry1.AppliesTo)<br>
　　sFormula2 = ToR1C1(fAry2.Formula1, fAry2.AppliesTo)<br>
　　If sFormula1 &lt;&gt; sFormula2 Then isMatchFormat = False<br>
　<br>
　　<span style="color:#009900;">'計算式2</span><br>
　　sFormula1 = ToR1C1(fAry1.Formula2, fAry1.AppliesTo)<br>
　　sFormula2 = ToR1C1(fAry2.Formula2, fAry2.AppliesTo)<br>
　　If sFormula1 &lt;&gt; sFormula2 Then isMatchFormat = False<br>
　<br>
　　<span style="color:#009900;">'演算子</span><br>
　　If fAry1.Operator &lt;&gt; fAry2.Operator Then isMatchFormat = False<br>
　<br>
　　<span style="color:#009900;">'表示形式</span><br>
　　If fAry1.NumberFormat &lt;&gt; fAry2.NumberFormat Then isMatchFormat = False<br>
　<br>
　　<span style="color:#009900;">'太字</span><br>
　　If fAry1.FontBold &lt;&gt; fAry2.FontBold Then isMatchFormat = False<br>
　<br>
　　<span style="color:#009900;">'文字色</span><br>
　　If fAry1.FontColor &lt;&gt; fAry2.FontColor Then isMatchFormat = False<br>
　<br>
　　<span style="color:#009900;">'塗りつぶし</span><br>
　　If fAry1.InteriorColor &lt;&gt; fAry2.InteriorColor Then isMatchFormat = False<br>
　<br>
　　<span style="color:#009900;">'追加判定したいプロパティはここに追加</span><br>
End Function<br><div class="br2"><br></div>
<span style="color:#009900;">'A1形式をR1C1形式に変換</span><br>
Private Function ToR1C1(ByVal sFormula As String, _<br>
　　　　　　　　　　　　　　　ByVal sAppliesTo As Range)<br>
　　If sFormula = &quot;&quot; Then Exit Function<br>
　　Dim rng As Range<br>
　　ToR1C1 = Application.ConvertFormula(sFormula, xlA1, xlR1C1, , sAppliesTo.Item(1))<br>
End Function<br><div class="br2"><br></div>
<span style="color:#009900;">'条件付き書式の統合：配列内のAppliesをFormatConditionに適用</span><br>
Private Sub ModifyApplies(ByRef fAry() As tFormat, _<br>
　　　　　　　　　　　　　ByVal ws As Worksheet)<br>
　　Dim i As Long<br>
　　Dim fObj As Object<br>
　　For i = ws.Cells.FormatConditions.Count To 1 Step -1<br>
　　　　Set fObj = ws.Cells.FormatConditions(i)<br>
　　　　If fAry(i).AppliesTo Is Nothing Then<br>
　　　　　　fObj.Delete<br>
　　　　Else<br>
　　　　　　If fObj.AppliesTo.Address &lt;&gt; fAry(i).AppliesTo.Address Then<br>
　　　　　　　　fObj.ModifyAppliesToRange fAry(i).AppliesTo<br>
　　　　　　End If<br>
　　　　End If<br>
　　Next<br>
End Sub</td>
    </tr>
  </tbody>
</table></code></div><br>
<strong>同じ条件付き書式かどうかの判定</strong>は、<br><div class="br2"><br></div>
<strong>・数式1<br>
・数式2<br>
・演算子<br>
・表示形式<br>
・太字<br>
・文字色<br>
・塗りつぶし</strong><br><div class="br2"><br></div>
以上で判定しています。<br>
従って、例えば、<br>
A1:A10は、&gt;1という条件でFont.Size = 10<br>
A11:A20は、&gt;1という条件でFont.Size = 11<br>
これは、同じ条件付き書式として判定し統合されてしまいます。<br><div class="br2"><br></div>
実際に、このような設定を使う事がそうそうあるとは思えませんが、<br>
これを別の条件付き書式として判定したい場合は、<br>
上記VBAコードの、<br>
<strong>'追加判定したいプロパティはここに追加</strong><br>
これが<strong>3箇所</strong>ありますので、そこにプロパティを追加してください。<br><div class="br2"><br></div>
</div>
<div class="main-indent">
<div class="ads1">
<script async src="../../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" tppabs="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-6511020045004282"
     data-ad-slot="5140526405"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div></div><h3>条件付き書式で設定できる書式</h3>
<div class="main-indent">セルの書式設定のほとんどを指定できるので多くのプロパティがあります。<br>
VBAでこの違いを全て判定するのは、ちょっとコードを書くのが面倒です。<br>
特に罫線とかは、かなり多くなってしまいます。<br>
実際のところは、<br>
面倒と言うよりサンプルVBAコードとして長くなるだけで意味がないと思いました。<br><div class="br2"><br></div>
しかし、そもそも、<br>
同じ数式、つまり同じ条件なのに書式のごく一部が違うというような設定を、多用すること自体に問題があるようにも思いますし、<br>
そんな使い方は、そうそうあるものではないだろうと思います。<br>
そして何より、あくまでサンプルVBAだという事で理解してください。<br><div class="br2"><br></div>
以下は、条件付き書式で設定できるプロパティの一覧になります。</div>
<div class="main-indent">
<div class="main-indent"><strong>NumberFormatLocal</strong><br>
<strong>Font.Bold</strong><br>
Font.Italic<br>
Font.Underline<br>
Font.Strikethrough<br>
<strong>Font.Color</strong><br>
Font.TintAndShade<br>
Borders(xlLeft).LineStyle<br>
Borders(xlLeft).TintAndShade<br>
Borders(xlLeft).Weight<br>
Borders(xlRight).LineStyle<br>
Borders(xlRight).TintAndShade<br>
Borders(xlRight).Weight<br>
Borders(xlTop).LineStyle<br>
Borders(xlTop).TintAndShade<br>
Borders(xlTop).Weight<br>
Borders(xlBottom).LineStyle<br>
Borders(xlBottom).TintAndShade<br>
Borders(xlBottom).Weight<br>
Interior.Pattern<br>
Interior.PatternThemeColor<br>
<strong>Interior.Color</strong><br>
Interior.TintAndShade<br>
Interior.PatternTintAndShade<br>
StopIfTrue</div>
</div>
<div class="main-indent">つまり、すべてのプロパティの違いを判定したいのなら、<br>
先のVBAコードの、<br>
'追加判定したいプロパティはこの上に追加<br>
この部分に、既に入れてある、<br>NumberFormatLocal<br>
Font.Bold<br>
FontColor<br>
InteriorColor<br>
これ以外を全て追加すれば良いという事です。<br><div class="br2"><br></div>
ですが、正確にはこれで全てと言う訳ではありません。<br>
塗りつぶし効果でグラデーションを付けている場合に、<br>
その違いまで判定するなら、さらに多くのプロパティの判定が必要になります。<br><div class="br2"><br></div>
先にも述べましたが、同じ条件でグラデーションだけを変えるなどという使い方が実際にあるとは思えませんが、<br>
もし使っているというのなら、基本的にシートの作成を考え直した方が良いと思います。<br><div class="br2"><br></div>
</div>
<h3>増殖した条件付き書式を整理統合するVBAの使い方</h3>
<div class="main-indent">上記VBAコード先頭の、<br>
<strong>「UnionFormatConditions」がメインのプロシージャー</strong>です。<br><div class="br2"><br></div>
オプションのNewNameが設定されていれば、<br>
元シートをコピーしてから条件付き書式を整理統合します。<br><div class="br2"><br></div>
VBAコードの詳細解説は省きますが、VBAコード内のコメントを参考に読み解いてみてください。<br>
以下で使い方を説明します。<br><div class="br2"><br></div>
</div>
<div class="main-indent">
<h4>アクティブシートの条件付き書式を整理統合</h4>
</div>
<div class="main-indent">
<div class="main-indent">
<form>
<input type="button" value="VBAをコピー" onclick="fncVbaCopy(this)">
</form>
<div class="table-scroll"><code class="vbacode"><table border="1" cellpadding="10">
  <tbody>
    <tr>
      <td>Sub sample1()<br>
      　　Application.ScreenUpdating = False<br>
      　　Application.Calculation = xlCalculationManual<br>
      　　<br>
      　　Dim ws As Worksheet<br>
      　　Set ws = ActiveSheet<br>
      　　<strong>Call UnionFormatConditions(ws, ws.Name &amp; &quot;_test&quot;)</strong><br>
      　　<br>
      　　Application.Calculation = xlCalculationAutomatic<br>
      　　Application.ScreenUpdating = True<br>
      End Sub</td>
    </tr>
  </tbody>
</table></code></div><br>
アクティブシートなので、念のためシートをコピーするオプションを指定しています。<br>
整理統合されているかの確認をしやすいので、テスト用とも言えます。<br><div class="br2"><br></div>
</div>
</div>
<div class="main-indent">
<h4>ブック全てのシートの条件付き書式を整理統合する</h4>
</div>
<div class="main-indent">
<div class="main-indent">
<form>
<input type="button" value="VBAをコピー" onclick="fncVbaCopy(this)">
</form>
<div class="table-scroll"><code class="vbacode"><table border="1" cellpadding="10">
  <tbody>
    <tr>
      <td>Sub sample2()<br>
      　　Dim FileName As Variant<br>
      　　Dim wb As Workbook<br>
      　　Dim ws As Worksheet<br>
      　　<br>
      　　FileName = Application.GetOpenFilename(FileFilter:=&quot;Excelファイル, *.xls*&quot;)<br>
      　　If FileName = False Then<br>
      　　　　Exit Sub<br>
      　　End If<br>
      　　<br>
      　　Application.ScreenUpdating = False<br>
      　　Application.Calculation = xlCalculationManual<br>
      　　<br>
      　　Set wb = Workbooks.Open(FileName:=FileName, UpdateLinks:=0, ReadOnly:=True)<br>
      　　<br>
      　　For Each ws In wb.Worksheets<br>
      　　　　<strong>Call UnionFormatConditions(ws)</strong><br>
      　　Next<br>
      　　<br>
      　　Application.Calculation = xlCalculationAutomatic<br>
      　　Application.ScreenUpdating = True<br>
      　　<br>
      　　FileName = Application.GetSaveAsFilename(InitialFileName:=wb.Name, _<br>
      　　　　　　　　　　　　　　　　　　　　　　 FileFilter:=&quot;Excelファイル,*.xls*&quot;)<br>
      　　If FileName = False Then<br>
      　　　　Exit Sub<br>
      　　End If<br>
      　　wb.SaveAs FileName<br>
      　　wb.Close SaveChanges:=True<br>
      End Sub</td>
    </tr>
  </tbody>
</table></code></div><br>
ダイアログで対象のファイルを選択し、<br>
保存時にもダイアログでファイルを指定できるようにしています。<br>
全シートが変更になるので、別ブックで保存し確認できるようにしています。<br><div class="br2"><br></div>
</div>
</div>
<h3>増殖した条件付き書式を整理統合の最後</h3>
<div class="main-indent">こうやって、VBAコードを書いてみると、<br>
Excelそのものも修正出来ないこともないように思われました。<br>
「条件付き書式の最適化」<br>
このようなボタンを配置して、条件付き書式を整理統合出来れば良いと思う。<br><div class="br2"><br></div>
・「もとに戻す」は難しいかもしれません。<br>
・不具合も出るかもしれません。<br><div class="br2"><br></div>
かなり勝手な言い分としては、<br>
実行時に注意のメッセージを出せば良いことではないかと思うのです。<br>
特殊な使い方をしている場合を考慮して先に進まないよりは、大多数の人の利益を優先すべきではないでしょうか。<br>
それこそ最後には、「それは仕様です」、と言い切ってしまえば良い話だと私は思います。<br><div class="br2"><br></div>
まだ作成して自分で確認しただけのVBAなので、バグが無いとは言えません。<br>
といいますか、このくらいのVBAになると、バグというか想定外は存在するのが普通です。<br>
上記のVBAコードを使用して、Excelファイルが壊れてしまった等の苦情は受け付けませんが、<br>
<strong>バグ報告は大歓迎</strong>です。<br>
もしくは、<br>
<strong>「もっと簡単にできるよ」、なんて情報は大大歓迎</strong>です。<br><div class="br2"><br></div>
</div>

          
<HR>
<div class="ads1">
<center>
<script async src="../../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" tppabs="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- yama3 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-6511020045004282"
     data-ad-slot="8239480723"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<script async src="../../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" tppabs="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-6511020045004282"
     data-ad-slot="6847508570"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</center>
</div>
          <section>
<br><A name="same"><h3>同じテーマ「<a href="index.htm" tppabs="https://excel-ubara.com/excelvba5/">マクロVBAサンプル集</a>」の記事</h3><p>
<A href="EXCELVBA213.html" tppabs="https://excel-ubara.com/excelvba5/EXCELVBA213.html">印刷ダイアログを使用する（xlDialogPrint）</A><br>
<A href="EXCELVBA214.html" tppabs="https://excel-ubara.com/excelvba5/EXCELVBA214.html">名前定義の一覧と削除（Name）</A><br>
<A href="EXCELVBA240.html" tppabs="https://excel-ubara.com/excelvba5/EXCELVBA240.html">シートを名前順に並べ替える</A><br>
<A href="EXCELVBA250.html" tppabs="https://excel-ubara.com/excelvba5/EXCELVBA250.html">数式内の不要なシート名を削除する（HasFormula）</A><br>
<A href="EXCELVBA258.html" tppabs="https://excel-ubara.com/excelvba5/EXCELVBA258.html">数式の参照しているセルを取得する</A><br>
<span class="strrev">増殖した条件付き書式を整理統合する</span><br>
<A href="EXCELVBA263.html" tppabs="https://excel-ubara.com/excelvba5/EXCELVBA263.html">条件付き書式で変更された書式を取得する</A><br>
<A href="EXCELVBA272.html" tppabs="https://excel-ubara.com/excelvba5/EXCELVBA272.html">セル結合/解除でセル値を退避/回復</A><br>
<A href="EXCELVBA273.html" tppabs="https://excel-ubara.com/excelvba5/EXCELVBA273.html">セル結合なんて絶対に許さないんだからね</A><br>
<A href="EXCELVBA274.html" tppabs="https://excel-ubara.com/excelvba5/EXCELVBA274.html">セルの数式をネスト色分けしてコメント表示</A><br>
<A href="EXCELVBA277.html" tppabs="https://excel-ubara.com/excelvba5/EXCELVBA277.html">セル結合して表を見やすくする（非推奨）</A><br></p>
</A>
          </section>
          <section id="new">
<br><h3><A name="new">新着記事<span class="newicon">NEW</span> </a>・・・<A href="../EXCELNEW.html" tppabs="https://excel-ubara.com/EXCELNEW.html">新着記事一覧を見る</A></h3><p><A href="../vba100/VBA100_100.html" tppabs="https://excel-ubara.com/vba100/VBA100_100.html">VBA100本ノック 100本目：WEBから100本ノックのリストを取得｜VBA練習問題</A>（3月3日）<br>
<A href="../vba100/VBA100_099.html" tppabs="https://excel-ubara.com/vba100/VBA100_099.html">VBA100本ノック 99本目：自動席替え（行列と前後左右が全て違うように）｜VBA練習問題</A>（3月2日）<br>
<A href="../vba100/VBA100_098.html" tppabs="https://excel-ubara.com/vba100/VBA100_098.html">VBA100本ノック 98本目：席替えルールが守られているか確認｜VBA練習問題</A>（3月1日）<br>
<A href="../vba100/VBA100_097.html" tppabs="https://excel-ubara.com/vba100/VBA100_097.html">VBA100本ノック 97本目：Accessデータを取得（グループ集計）｜VBA練習問題</A>（2月27日）<br>
<A href="../vba100/VBA100_096.html" tppabs="https://excel-ubara.com/vba100/VBA100_096.html">VBA100本ノック 96本目：Accessデータを取得（マスタ結合&amp;抽出）｜VBA練習問題</A>（2月26日）<br>
<A href="../vba100/VBA100_095.html" tppabs="https://excel-ubara.com/vba100/VBA100_095.html">VBA100本ノック 95本目：図形のテキストを検索するフォーム作成｜VBA練習問題</A>（2月24日）<br>
<A href="../vba100/VBA100_094.html" tppabs="https://excel-ubara.com/vba100/VBA100_094.html">VBA100本ノック 94本目：表範囲からHTMLのtableタグを作成｜VBA練習問題</A>（2月23日）<br>
<A href="../vba100/VBA100_093.html" tppabs="https://excel-ubara.com/vba100/VBA100_093.html">VBA100本ノック 93本目：複数ブックを連結して再分割｜VBA練習問題</A>（2月22日）<br>
<A href="../vba100/VBA100_092.html" tppabs="https://excel-ubara.com/vba100/VBA100_092.html">VBA100本ノック 92本目：セルの色を16進で返す関数｜VBA練習問題</A>（2月20日）<br>
<A href="../vba100/VBA100_091.html" tppabs="https://excel-ubara.com/vba100/VBA100_091.html">VBA100本ノック 91本目：時間計算（残業時間の月間合計）｜VBA練習問題</A>（2月19日）<br></p>

          </section>
          <section id="rank">
<br><h3><A name="rank">アクセスランキング </a>・・・ <A href="../EXCELRANK.html" tppabs="https://excel-ubara.com/EXCELRANK.html">ランキング一覧を見る</A></h3><p>1.<A href="../excelvba1/EXCELVBA318.html" tppabs="https://excel-ubara.com/excelvba1/EXCELVBA318.html">最終行の取得（End,Rows.Count）｜VBA入門</A><br>2.<A href="../excelvba1/EXCELVBA311.html" tppabs="https://excel-ubara.com/excelvba1/EXCELVBA311.html">RangeとCellsの使い方｜VBA入門</A><br>3.<A href="../excelvba1/EXCELVBA312.html" tppabs="https://excel-ubara.com/excelvba1/EXCELVBA312.html">変数宣言のDimとデータ型｜VBA入門</A><br>4.<A href="../excelvba1/EXCELVBA301.html" tppabs="https://excel-ubara.com/excelvba1/EXCELVBA301.html">マクロって何？VBAって何？｜VBA入門</A><br>5.<A href="../excelvba1/EXCELVBA310.html" tppabs="https://excel-ubara.com/excelvba1/EXCELVBA310.html">Range以外の指定方法（Cells,Rows,Columns）｜VBA入門</A><br>6.<A href="../excelvba1/EXCELVBA341.html" tppabs="https://excel-ubara.com/excelvba1/EXCELVBA341.html">セルのコピー&amp;値の貼り付け（PasteSpecial）｜VBA入門</A><br>7.<A href="../excelvba1/EXCELVBA316.html" tppabs="https://excel-ubara.com/excelvba1/EXCELVBA316.html">繰り返し処理（For Next)｜VBA入門</A><br>8.<A href="../excelvba1/EXCELVBA308.html" tppabs="https://excel-ubara.com/excelvba1/EXCELVBA308.html">セルに文字を入れるとは（Range,Value）｜VBA入門</A><br>9.<A href="../excelvba1/EXCELVBA304.html" tppabs="https://excel-ubara.com/excelvba1/EXCELVBA304.html">マクロはどこに書くの（VBEの起動）｜VBA入門</A><br>10.<A href="../excelvba1/EXCELVBA306.html" tppabs="https://excel-ubara.com/excelvba1/EXCELVBA306.html">とにかく書いてみよう（Sub,End Sub）｜VBA入門</A><br></p>
          </section>
<br>
          <HR>
          <div><ul>
<li><a href="../index.htm" tppabs="https://excel-ubara.com/">ホーム</a></li>
<li><a href="../excel_vba2.html" tppabs="https://excel-ubara.com/excel_vba2.html">マクロVBA応用編</a></li>
<li><a href="index.htm" tppabs="https://excel-ubara.com/excelvba5/">マクロVBAサンプル集</a></li>
<li><span class="strrev2"><strong>増殖した条件付き書式を整理統合する</strong></span></li>
</ul></div><br>
          <strong>このサイトがお役に立ちましたら「シェア」「Bookmark」をお願いいたします。</strong><br>
          <div class="ninja_onebutton">
            <script type="text/javascript">
              //<![CDATA[
              (function(d){
              if(typeof(window.NINJA_CO_JP_ONETAG_BUTTON_dbb4ddbe09aac6bed0b2564afb27c6f2)=='undefined'){
                  document.write("<sc"+"ript type='text\/javascript' src='\/\/omt.shinobi.jp\/b\/dbb4ddbe09aac6bed0b2564afb27c6f2'><\/sc"+"ript>");
              }else{
                  window.NINJA_CO_JP_ONETAG_BUTTON_dbb4ddbe09aac6bed0b2564afb27c6f2.ONETAGButton_Load();}
              })(document);
              //]]>
            </script><span class="ninja_onebutton_hidden" style="display:none;"></span><span style="display:none;" class="ninja_onebutton_hidden"></span>
          </div>
<br>
          <script>
            (function() {
              var cx = 'partner-pub-6511020045004282:1071452572';
              var gcse = document.createElement('script');
              gcse.type = 'text/javascript';
              gcse.async = true;
              gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(gcse, s);
            })();
          </script>
          <gcse:searchbox-only></gcse:searchbox-only>
<br>
          記述には細心の注意をしたつもりですが、<br>
          間違いやご指摘がありましたら、<A href="../query.html" tppabs="https://excel-ubara.com/query.html" target="_blank">「お問い合わせ」</A>からお知らせいただけると幸いです。<br>
          掲載のVBAコードは動作を保証するものではなく、あくまでVBA学習のサンプルとして掲載しています。<br>
          掲載のVBAコードは自己責任でご使用ください。万一データ破損等の損害が発生しても責任は負いません。
        </section>
      </div> <!--/#main-->

      <div id="sub">
        <nav>
          <h2>エクセル全般</h2>
          <ul class="submenu">
            <li><A href="../excel1/index.htm" tppabs="https://excel-ubara.com/excel1/">エクセル入門</A></li>
            <li><A href="../excel2/index.htm" tppabs="https://excel-ubara.com/excel2/">エクセル基本操作</A></li>
            <li><A href="../excel3/index.htm" tppabs="https://excel-ubara.com/excel3/">エクセル関数応用</A></li>
            <li><A href="../excel4/index.htm" tppabs="https://excel-ubara.com/excel4/">エクセル挑戦問題</A></li>
            <li><A href="../EXCEL/excel_reference.html" tppabs="https://excel-ubara.com/EXCEL/excel_reference.html">Excelリファレンス</A></li>
            <li><A href="../excel5/index.htm" tppabs="https://excel-ubara.com/excel5/">エクセル雑感</A></li>
          </ul>
          <h2>マクロVBA入門編</h2>
          <ul class="submenu">
            <li><A href="../excelvba1/index.htm" tppabs="https://excel-ubara.com/excelvba1/">マクロVBA入門</A></li>
            <li><A href="../excelvba1r/index.htm" tppabs="https://excel-ubara.com/excelvba1r/">マクロVBA再入門</A></li>
            <li><A href="../excelvba2/index.htm" tppabs="https://excel-ubara.com/excelvba2/">マクロ記録でVBA</A></li>
            <li><A href="../excelvba9/index.htm" tppabs="https://excel-ubara.com/excelvba9/">マクロVBA練習問題</A></li>
            <li><A href="../MOS_VBA/index.htm" tppabs="https://excel-ubara.com/MOS_VBA/">VBAエキスパート対策</A></li>
            <li><A href="../excelvba8/index.htm" tppabs="https://excel-ubara.com/excelvba8/">マクロVBA関数</A></li>
            <li><A href="../vba100/index.htm" tppabs="https://excel-ubara.com/vba100/">VBA100本ノック</A></li>
          </ul>
          <h2>マクロVBA応用編</h2>
          <ul class="submenu">
            <li><A href="../excelvba3/index.htm" tppabs="https://excel-ubara.com/excelvba3/">ユーザーフォーム入門</A></li>
            <li><A href="../vba_class/index.htm" tppabs="https://excel-ubara.com/vba_class/">VBAクラス入門</A></li>
            <li><A href="index.htm" tppabs="https://excel-ubara.com/excelvba5/">マクロVBAサンプル集</A></li>
            <li><A href="../excelvba4/index.htm" tppabs="https://excel-ubara.com/excelvba4/">マクロVBA技術解説</A></li>
            <li><A href="../excelvba7/index.htm" tppabs="https://excel-ubara.com/excelvba7/">エクセル顧客管理</A></li>
            <li><A href="../EXCEL/vba_reference.html" tppabs="https://excel-ubara.com/EXCEL/vba_reference.html">VBAリファレンス</A></li>
          </ul>
          <h2>その他（Excel以外）</h2>
          <ul class="submenu">
            <li><a href="../vba_sql/index.htm" tppabs="https://excel-ubara.com/vba_sql/">SQL入門</a></li>
            <li><A href="../spreadsheet1/index.htm" tppabs="https://excel-ubara.com/spreadsheet1/">スプレッドシート入門</A></li>
            <li><A href="../apps_script1/index.htm" tppabs="https://excel-ubara.com/apps_script1/">GAS入門</A></li>
            <li><A href="../python/index.htm" tppabs="https://excel-ubara.com/python/">Python入門</A></li>
          </ul>
          <h2>サイト案内</h2>
          <ul class="submenu">
            <li><A href="../EXCELNEW.html" tppabs="https://excel-ubara.com/EXCELNEW.html">新着記事一覧</A></li>
            <li><A href="../EXCELRANK.html" tppabs="https://excel-ubara.com/EXCELRANK.html">アクセスランキング</A></li>
            <li><A href="../sitemap.html" tppabs="https://excel-ubara.com/sitemap.html">サイトマップ</A></li>
            <li><a href="../business/index.htm" tppabs="https://excel-ubara.com/business/">事業案内</a></li>
            <li><A href="../query.html" tppabs="https://excel-ubara.com/query.html">お問い合わせ&nbsp&nbsp</A></li>
          </ul>
        </nav>

        <section>
          
<HR>
<div class="ads1">
<CENTER>
<script async src="../../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" tppabs="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- yama22 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-6511020045004282"
     data-ad-slot="9686142173"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</CENTER>
</div>
          

          

          <HR>
          <div><ul>
<li><a href="../index.htm" tppabs="https://excel-ubara.com/">ホーム</a></li>
<li><a href="../excel_vba2.html" tppabs="https://excel-ubara.com/excel_vba2.html">マクロVBA応用編</a></li>
<li><a href="index.htm" tppabs="https://excel-ubara.com/excelvba5/">マクロVBAサンプル集</a></li>
<li><span class="strrev2"><strong>増殖した条件付き書式を整理統合する</strong></span></li>
</ul></div><br>
          このサイトがお役に立ちましたら「シェア」「Bookmark」をお願いいたします。<br>

          <div class="ninja_onebutton">
            <script type="text/javascript">
              //<![CDATA[
              (function(d){
              if(typeof(window.NINJA_CO_JP_ONETAG_BUTTON_dbb4ddbe09aac6bed0b2564afb27c6f2)=='undefined'){
                  document.write("<sc"+"ript type='text\/javascript' src='\/\/omt.shinobi.jp\/b\/dbb4ddbe09aac6bed0b2564afb27c6f2'><\/sc"+"ript>");
              }else{
                  window.NINJA_CO_JP_ONETAG_BUTTON_dbb4ddbe09aac6bed0b2564afb27c6f2.ONETAGButton_Load();}
              })(document);
              //]]>
            </script><span class="ninja_onebutton_hidden" style="display:none;"></span><span style="display:none;" class="ninja_onebutton_hidden"></span>
          </div>
          本文下部へ<br>
          <div class="main-indent">
            <strong><A href="#same">同じテーマの記事</A></strong><br>
            <strong><A href="#new">新着記事</A></strong><br>
            <strong><A href="#rank">アクセスランク</A></strong><br>
          </div>
          <div class="ads2">
            <script>
              (function() {
                var cx = 'partner-pub-6511020045004282:1071452572';
                var gcse = document.createElement('script');
                gcse.type = 'text/javascript';
                gcse.async = true;
                gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(gcse, s);
              })();
            </script>
            <gcse:searchbox-only></gcse:searchbox-only>
          </div>
<br><nav><h2>おすすめ関連記事</h2><ul class="submenu"><li><a href="../excelvba1/EXCELVBA391.html" tppabs="https://excel-ubara.com/excelvba1/EXCELVBA391.html" target="_blank">マクロVBA入門：第91回.条件付き書式<br></a></li></ul></nav>
          

          
<HR>
<div class="ads2">
<script async src="../../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" tppabs="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 新サイド下 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-6511020045004282"
     data-ad-slot="1968934163"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div><br>
        </section>
      </div> <!--/#sub-->
    </div> <!--/#contents-in-->
  </div> <!--/#contents-->

  <footer>
    <div id="footermenu" class="inner">
      <ul>
        <li><a href="../excel_index.html" tppabs="https://excel-ubara.com/excel_index.html">■Excel全般</a></li>
        <li><A href="../excel1/index.htm" tppabs="https://excel-ubara.com/excel1/">エクセル入門</A></li>
        <li><A href="../excel2/index.htm" tppabs="https://excel-ubara.com/excel2/">エクセル基本操作</A></li>
        <li><A href="../excel3/index.htm" tppabs="https://excel-ubara.com/excel3/">エクセル関数応用</A></li>
        <li><A href="../excel4/index.htm" tppabs="https://excel-ubara.com/excel4/">エクセル挑戦問題</A></li>
        <li><A href="../EXCEL/excel_reference.html" tppabs="https://excel-ubara.com/EXCEL/excel_reference.html">Excelリファレンス</A></li>
        <li><A href="../excel5/index.htm" tppabs="https://excel-ubara.com/excel5/">エクセル雑感</A></li>
      </ul>
      <ul>
        <li><a href="../excel_vba1.html" tppabs="https://excel-ubara.com/excel_vba1.html">■マクロVBA入門編</a></li>
        <li><A href="../excelvba1/index.htm" tppabs="https://excel-ubara.com/excelvba1/">マクロVBA入門</A></li>
        <li><A href="../excelvba1r/index.htm" tppabs="https://excel-ubara.com/excelvba1r/">マクロVBA再入門</A></li>
        <li><A href="../excelvba2/index.htm" tppabs="https://excel-ubara.com/excelvba2/">マクロ記録でVBA</A></li>
        <li><A href="../excelvba9/index.htm" tppabs="https://excel-ubara.com/excelvba9/">マクロVBA練習問題</A></li>
        <li><A href="../MOS_VBA/index.htm" tppabs="https://excel-ubara.com/MOS_VBA/">VBAエキスパート対策</A></li>
        <li><A href="../excelvba8/index.htm" tppabs="https://excel-ubara.com/excelvba8/">マクロVBA関数</A></li>
        <li><A href="../vba100/index.htm" tppabs="https://excel-ubara.com/vba100/">VBA100本ノック</A></li>
      </ul>
      <ul>
        <li><a href="../excel_vba2.html" tppabs="https://excel-ubara.com/excel_vba2.html">■マクロVBA応用編</a></li>
        <li><A href="../excelvba3/index.htm" tppabs="https://excel-ubara.com/excelvba3/">ユーザーフォーム入門</A></li>
        <li><A href="../vba_class/index.htm" tppabs="https://excel-ubara.com/vba_class/">VBAクラス入門</A></li>
        <li><A href="index.htm" tppabs="https://excel-ubara.com/excelvba5/">マクロVBAサンプル集</A></li>
        <li><A href="../excelvba4/index.htm" tppabs="https://excel-ubara.com/excelvba4/">マクロVBA技術解説</A></li>
        <li><A href="../excelvba7/index.htm" tppabs="https://excel-ubara.com/excelvba7/">エクセル顧客管理</A></li>
        <li><A href="../EXCEL/vba_reference.html" tppabs="https://excel-ubara.com/EXCEL/vba_reference.html">VBAリファレンス</A></li>
      </ul>
      <ul>
        <li><A href="../python/index.htm" tppabs="https://excel-ubara.com/python/">■Python入門</A></li>
        <li><a href="../vba_sql/index.htm" tppabs="https://excel-ubara.com/vba_sql/">■SQL入門</a></li>
        <li><A href="../spreadsheet1/index.htm" tppabs="https://excel-ubara.com/spreadsheet1/">■スプレッドシート入門</A></li>
        <li><A href="../apps_script1/index.htm" tppabs="https://excel-ubara.com/apps_script1/">■Google Apps Script入門</A></li>
        <li><A href="../excel_course/index.htm" tppabs="https://excel-ubara.com/excel_course/">■エクセル講座セミナー</A></li>
        <li><A href="../business/index.htm" tppabs="https://excel-ubara.com/business/">■事業案内</A></li>
        <li><A href="../business/sitemap.html" tppabs="https://excel-ubara.com/business/sitemap.html">■サイトマップ</A></li>
      </ul>
    </div> <!--/footermenu-->
    <div id="copyright">
      <small>エクセルの神髄 ｜ Copyright&copy; 2010 <A href="../index.htm" tppabs="https://excel-ubara.com/">鵜原パソコンソフト研究所</A></small>
    </div>
  </footer>

  <p class="nav-fix-pos-pagetop"><a href="#">↑</a></p>

  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37178461-1']);
    _gaq.push(['_trackPageview']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'https://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
<!--License20150309TPg-->
</body>
</html>
