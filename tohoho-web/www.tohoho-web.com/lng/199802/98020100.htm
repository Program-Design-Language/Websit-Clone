<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>最終更新日の表示が変なんです。</title>
<link rel="stylesheet" href="../style.css" tppabs="http://www.tohoho-web.com/lng/style.css">
</head>
<body>
<h3>最終更新日の表示が変なんです。</h3>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199802/index.htm">[上に]</a>
[前に]
<a href="98020200.htm" tppabs="http://www.tohoho-web.com/lng/199802/98020200.htm">[次に]</a>
<hr>
<span class=name>Asuka</span>
<span class=email><a href="mailto:Asuka@dp.u-netsurf.or.jp">[E-Mail]</a></span>
<span class=time>1998/02/01(日) 23:54:26</span><br>
最終更新日を表示させたいと思って、<br>
<br>
&lt;script language="JavaScript"&gt;<br>
document.write(document.lastModified);<br>
&lt;/script&gt;<br>
<br>
と入力してみましたが、なぜかいつも９時間遅れています。<br>
例えば２０時だったら１１時となるのです。原因はいったい<br>
何なのでしょうか。パソコン側の設定ではないと思うのですが・・・<br>
<hr>
<span class=name>B-Cus</span>
<span class=time>1998/02/02(月) 00:41:00</span><br>
<font color="#CC8000">&gt; なぜかいつも９時間遅れています。</font><br>
<br>
GMT(世界標準時)になっているんでしょう。<br>
<br>
サーバの設定次第かと思いますが、詳しい解決方法は<br>
わかりません。<br>
<hr>
<span class=name>とほほ</span>
<span class=time>1998/02/02(月) 00:56:29</span><br>
Date.parse()を用いて日付を解釈して自前で日本時間に直せばよいかな。<br>
<hr>
<span class=name>としみ</span>
<span class=email><a href="mailto:toshimi@mxp.mesh.ne.jp">[E-Mail]</a></span>
<span class=time>1998/02/02(月) 16:18:04</span><br>
JavaScriptはクライアント(ブラウザ)側で動作するのでサーバは関係ないと思います。<br>
ＯＳの設定じゃないですか？<br>
<hr>
<span class=name>とほほ</span>
<span class=time>1998/02/02(月) 22:48:20</span><br>
そういえばそうだ。「パソコン側の設定」だ・・・・(にが笑い)<br>
<hr>
<span class=name>miyasiro</span>
<span class=time>1998/02/03(火) 01:48:10</span><br>
えっ？<br>
document.lastModified は、サーバーから送られて来る HTML ファイルの<br>
最終更新日時をそのまま使ってるんじゃぁないんですか？<br>
<hr>
<span class=name>miyasiro</span>
<span class=time>1998/02/03(火) 01:54:15</span><br>
あっ！そうか。<br>
NN では、ローカルでも表示できましたね。<br>
ということは、最初の質問の Java Script を埋め込んだ HTML ファイルが<br>
ローカルにあるのか、サーバーにあるのか、<br>
によるのかな？<br>
（オンラインで書いてるので、まるっきり違うかも…）<br>
<hr>
<span class=name>としみ</span>
<span class=email><a href="mailto:toshimi@mxp.mesh.ne.jp">[E-Mail]</a></span>
<span class=time>1998/02/03(火) 13:22:52</span><br>
<font color="#CC8000">&gt; document.lastModified は、サーバーから送られて来る HTML ファイルの</font><br>
<font color="#CC8000">&gt; 最終更新日時をそのまま使ってるんじゃぁないんですか？</font><br>
サーバからの日付をそのまま表示しているわけではないようです。<br>
サーバからはＧＭＴで送られてくるのを、ブラウザ側ではローカル時間に変更しているようです。<br>
ＯＳ側の設定が正しいかどうかは以下のコードで確認できると思います。<br>
<br>
&lt;SCRIPT LANGUAGE=JavaScript&gt;<br>
var today = new Date();<br>
alert('TimezoneOffset='+ today.getTimezoneOffset()/60);<br>
&lt;/SCRIPT&gt;<br>
<br>
この結果が-9ならＯＫです。<br>
<hr>
<span class=name>Asuka</span>
<span class=time>1998/02/03(火) 15:01:09</span><br>
レスが遅れて申し訳ありません<br>
B-cusさん、とほほさん、としみさん、miyasiroさん、<br>
本当にありがとうございます。<br>
<br>
最初に、すいませんです。どうも完全にこちらの状況を<br>
書いていなかったようですね。すべてローカルです。そして<br>
ブラウザはIE4.0を使用していました。<br>
<br>
まだJavaScriptにはあまり詳しくないのですが、lastModifiedは<br>
ただ単に、そのソースファイルが更新された日付、Windowsなら<br>
プロパティで見られるその日付を表示するのではないでしょうか。<br>
<br>
上のとしみさんのソースを入力してみたら、ちゃんと-9とでました。<br>
ますますわけわからなくなったので、ブラウザを変えてみることに<br>
しました。すると・・・<br>
一応解決･･･なのかどうかはわかりませんがどうもこれはブラウザの<br>
問題のようでしたよ。僕はIE4.0を使ってHTMLの編集をしているの<br>
ですが、IEを使ってみたときのみ表示がおかしくなるようです。<br>
NNを使って見てみたところ、表示に問題はありませんでした。<br>
う〜ん、これがIE4.0の呪いですか（笑）。それともやっぱり<br>
僕が悪いのかな？<br>
<br>
迷惑ついでにもう一つ質問させていただきます。<br>
最終更新日のうち何年何月何日だけを取り出すことはできますか？<br>
getYear()みたいに。<br>
<br>
<br>
<hr>
<span class=name>miyasiro</span>
<span class=time>1998/02/03(火) 16:00:10</span><br>
To:としみ さん<br>
<font color="#CC8000">&gt;サーバからの日付をそのまま表示しているわけではないようです。</font><br>
<font color="#CC8000">&gt;サーバからはＧＭＴで送られてくるのを、ブラウザ側ではローカル時間に変更しているようです。</font><br>
これは知りませんでした。なるほど、クライアントは、普通自分のローカル時間での<br>
前回のアクセスの日時を lastModified の表示日時と比較するでしょうから、その方が<br>
合理的ですよね。<br>
ありがとうございます。<br>
<br>
To:Asuka さん<br>
NN なら<br>
d = new Date(document.lastModified)<br>
で d.getYear() などが使えます。<br>
ただ、IE3 だと、ローカルでは全て 70/1/1 になってしまいました。<br>
IE4 は分かりません。<br>
<hr>
<span class=name>hiro-kim</span>
<span class=time>1998/02/03(火) 20:22:11</span><br>
年月日だけを表示させたい場合，私は単純に，"02/03/98"という８文字長の文字列として切り出しています。<br>
　　document.write(document.lastModified.substring(0,8))<br>
<br>
ちなみに，ＮＮでは正常だがＩＥでは異常な lastModifiedの件ですけれども，set TZ=JST-9 を autoexec.batに指定して再起動したらＩＥでもうまくいくんじゃないかなあ，と試してみたら<br>
　　ダメ<br>
でした，念のため。<br>
<hr>
<span class=name>miyasiro</span>
<span class=time>1998/02/03(火) 21:54:44</span><br>
ちょっと勘違いがありました。<br>
IE3 の場合、ローカルでは document.lastModified が正しい日付を返さないと<br>
思い込んでいたのですが、実際はちゃんと更新日付を返してました。<br>
ただ、「火 2 03 21:24:06 1998」というような形式なので、Date() や<br>
Date.parse() の引数に使っても 0 と解釈されて 70/1/1 になってしまう<br>
ということで、ローカルかどうかは関係ありませんでした。すいません。<br>
<br>
To:hiro-kim さん<br>
<font color="#CC8000">&gt;set TZ=JST-9</font><br>
DOS の環境変数が Windows アプリに影響を与えるようなことが他にあるのでしょうか？<br>
<hr>
<span class=name>とほほ</span>
<span class=time>1998/02/03(火) 22:23:29</span><br>
なんだか、これまでのみなさんの意見を読んでいると、<br>
「lastModified は使い物にならないから使わない」<br>
というのが一番現実解になっちゃいそうですね・・・<br>
WebAutoなどでダウンロードしたページのlastModified<br>
はダウンロードした日になっちゃいそうだし・・・・<br>
<hr>
<span class=name>としみ</span>
<span class=email><a href="mailto:toshi@mxp.mesh.ne.jp">[E-Mail]</a></span>
<span class=time>1998/02/04(水) 12:56:59</span><br>
<font color="#CC8000">&gt;&gt;set TZ=JST-9</font><br>
<font color="#CC8000">&gt;DOS の環境変数が Windows アプリに影響を与えるようなことが他にあるのでしょうか？</font><br>
<br>
Windows NT 4.0での話ですが、NN3(3.04で確認)だと環境変数TZを参照しているようです。<br>
TZを設定しないとTimezoneOffset/60は８になります。<br>
ちなみにNN4では参照していないようです。<br>
<hr>
<span class=name>Asuka</span>
<span class=time>1998/02/04(水) 13:04:05</span><br>
<span class=resolv>[[解決]]</span><br>
とほほさんのおっしゃるように、「lastModifiedは使わない」<br>
というのが一番いいような気がしてきました。<br>
でも一応miyasiroさんに教わった<br>
<br>
last=new Date(document.lastModified);<br>
document.write(last.getYear()+"/"+・・・・・・・・);<br>
<br>
という形で表示しようと思います。<br>
まあ結局lastModifiedが悪い訳ではなさそうです。<br>
だから解決ということにしようと思いますが。<br>
でも・・となると原因はブラウザ・・(？)・・なのかな・・<br>
う〜〜ん<br>
<br>
また何かトラブったらこのラウンジに駆け込んでくるかも<br>
しれませんが、その時もよろしくお願いいたします。<br>
レスをくれた方々、本当にありがとうございました。<br>
<br>
<br>
<hr>
<span class=name>miyasiro</span>
<span class=time>1998/02/04(水) 23:21:25</span><br>
To: としみ さん<br>
<font color="#CC8000">&gt;TZを設定しないとTimezoneOffset/60は８になります。</font><br>
なるほど、そういうこともあるんですか。覚えておきます。<br>
DOS 時代には、参照するツールがいくつかあったので、set TZ=JST-9 は<br>
設定していたのですが…<br>
<hr>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199802/index.htm">[上に]</a>
[前に]
<a href="98020200.htm" tppabs="http://www.tohoho-web.com/lng/199802/98020200.htm">[次に]</a>
</body>
</html>
