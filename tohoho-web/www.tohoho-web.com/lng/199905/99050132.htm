<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>表の１行を選択状態にするには？</title>
<link rel="stylesheet" href="../style.css" tppabs="http://www.tohoho-web.com/lng/style.css">
</head>
<body>
<h3>表の１行を選択状態にするには？</h3>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199905/index.htm">[上に]</a>
<a href="99050131.htm" tppabs="http://www.tohoho-web.com/lng/199905/99050131.htm">[前に]</a>
<a href="99050133.htm" tppabs="http://www.tohoho-web.com/lng/199905/99050133.htm">[次に]</a>
<hr>
<span class=name>ばーばぱぱ</span>
<span class=time>1999/05/24(月) 11:17:18</span><br>
表のある部分をクリックするとその行全体を選択状態にすることは<br>
可能でしょうか？<br>
いろいろ調べたのですが、テキストの入力エリアの文字を選択状態に<br>
する document.Form名.Textオブジェクト名.SELECT()しか<br>
分かりませんでした。<br>
どうか教えてください。お願いします。<br>
<hr>
<span class=name>Nobu3</span>
<span class=time>1999/05/24(月) 16:57:22</span><br>
選択状態というのが「コピー」などをするための行為ならば「はずれ」ですが、<br>
IE4ではタグ単位でなら背景などの色は変更できます。<br>
<br>
function sel(){<br>
window.event.srcElement.style.backgroundColor=Math.floor(Math.random()*16777216);<br>
}<br>
document.onclick=sel;<br>
<br>
ただし、これは無差別です（bodyにも効いてしまうので・・・）。<br>
限定させるならば、<br>
<br>
function sel2(act){<br>
act.style.backgroundColor=Math.floor(Math.random()*16777216);<br>
}<br>
<br>
色を変更したいタグに「onclick="sel2(this)"」を付け足します。<br>
どのタグでもできます（たぶん）。<br>
<br>
でも、はずれの匂いが濃厚・・・<br>
<br>
<hr>
<span class=name>ばーばぱぱ</span>
<span class=time>1999/05/24(月) 17:51:26</span><br>
Nobu3さん、せっかく発言してくださったのに、<br>
はずれなんです。そうです、つまりドラッグ状態にしたいのです。<br>
説明不足でごめんなさい。皆さん勘違いしてしまったんでは<br>
ないでしょうか。<br>
改めて、解答をよろしくお願いします。<br>
<hr>
<span class=name>みんこ</span>
<span class=time>1999/05/25(火) 09:01:59</span><br>
Macだったらふつーに３回クリックで一行選択できますが...。<br>
<br>
<hr>
<span class=name>たこすけ</span>
<span class=time>1999/05/25(火) 09:24:30</span><br>
window.find()で見つかった文字列は<br>
選択された状態になるので、コレを利用してみてはどうでしょう？<br>
<br>
NC4以上限定でセルがまたげない等の規制がありますが・・・・。<br>
<hr>
<span class=name>ぱよ☆</span>
<span class=email><a href="mailto:payo@studio-critt.com">[E-Mail]</a></span>
<span class=time>1999/05/25(火) 09:48:51</span><br>
えっと、わたしも確実なものではないんですが(^^;)<br>
<br>
document.Form名.Textオブジェクト名.focus();<br>
document.Form名.Textオブジェクト名.select();<br>
<br>
とやったらその選択されたところが選択された状態になっていた<br>
記憶があります。ブラウザーによって違ったりするんでしょうか...<br>
(^^;) ちゃんとお答え出来なくてスミマセン。<br>
<br>
<hr>
<span class=name>ばーばぱぱ</span>
<span class=time>1999/05/26(水) 17:23:05</span><br>
えーと、ぱよ☆さんのやり方だと選択状態にならないので<br>
背景色を使うことにしました。<br>
そこで、１行クリックして背景色を変更した後、<br>
他の行をクリックした場合、<br>
その行の背景色を変更し、前にクリックした行の背景色を<br>
元に戻すには、どうしたらよいでしょうか？<br>
ちなみにブラウザはＩＥ４です。<br>
<br>
<hr>
<span class=name>Nobu3</span>
<span class=time>1999/05/26(水) 17:41:54</span><br>
var lst;<br>
function sel(){<br>
if(lst)lst.style.backgroundColor=document.body.style.backgroundColor;<br>
lst=window.event.srcElement;<br>
if(lst.tagName=='BODY')return;<br>
window.event.srcElement.style.backgroundColor='blue';<br>
}<br>
document.onclick=sel;<br>
<br>
こんなものですか？<br>
<br>
<hr>
<span class=name>Nobu3</span>
<span class=time>1999/05/26(水) 17:45:18</span><br>
lst.style.backgroundColor='blue';<br>
<br>
あ、最後の文もこっちのほうが簡単ですね。<br>
#当然（？）、ホームページに使ってもNNでは動きませんよ？<br>
<br>
<hr>
<span class=name>ばーばぱぱ</span>
<span class=time>1999/05/27(木) 11:06:57</span><br>
Nobu3さん、ソースありがとうございます。<br>
しかし、このソースだと行ではなく、１つのセルにしか<br>
きかないのです。<br>
ちゃんと&lt;TR&gt;にonclick="sel()"としているにもかかわらず<br>
なんで行単位で変更してくれないのでしょう。<br>
いろいろ試したのですが分かりませんでした。<br>
どこか変更したらできますか？<br>
<br>
<hr>
<span class=name>Nobu3</span>
<span class=time>1999/05/27(木) 11:17:34</span><br>
失礼しました。<br>
今のスクリプトはボディ以外の単品（タグ）に対して自動的に効くようになってます。<br>
「onclick="sel()"」は必要ありません。<br>
改造版を以下に書きます。<br>
<br>
var lst;<br>
function sel(){<br>
if(lst)lst.style.backgroundColor=document.body.style.backgroundColor;<br>
if(window.event.srcElement.tagName=='TD'){<br>
lst=window.event.srcElement.parentElement;<br>
lst.style.backgroundColor='blue';<br>
}<br>
}<br>
document.onclick=sel;<br>
<br>
テーブルに対してのみ反応します。<br>
セルをクリックすると、その行のセルの背景が変わります。<br>
関係無いところをクリックすると、元に戻ります。（たぶん）<br>
<br>
<hr>
<span class=name>ばーばぱぱ</span>
<span class=time>1999/05/27(木) 11:44:33</span><br>
たびたびすみません。<br>
テーブルがいくつかあり、１つのテーブルに限定して<br>
行いたいとき、どうしたらよいですか。<br>
あと、元の色に戻すとき、色を指定（BODYと色が違うので）<br>
できますか。<br>
<hr>
<span class=name>Nobu3</span>
<span class=time>1999/05/27(木) 13:05:34</span><br>
クラスを指定してやれば、限定させる事ができます。<br>
また、色は指定できます。（実際に最後の行でしています。）<br>
document.body.style.backgroundColorを好きな色にすれば良いです。<br>
<br>
変更させたい&lt;td&gt;に「class=sample」とか適当につけて、<br>
<br>
if(window.event.srcElement.tagName=='TD'){<br>
<br>
を<br>
<br>
if((window.event.srcElement.tagName=='TD')&amp;&amp;(window.event.srcElement.className=='sample')){<br>
<br>
にすればできるでしょう。<br>
<br>
ただ、そこまで限定させるのなら、上に書いた「sel2()」の方を使うのが良いかもしれません。<br>
やってる事はほぼ同じなので、ちょっと考えればできるでしょう。<br>
試行錯誤が勉強になります。<br>
<br>
<hr>
<span class=name>ばーばぱぱ</span>
<span class=time>1999/05/27(木) 13:32:06</span><br>
<span class=resolv>[[解決]]</span><br>
Nobu3様、本当にありがとうございます。<br>
おかげで助かりました。これからも勉強して<br>
分からないことがあったら教えてください。<br>
<br>
<hr>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199905/index.htm">[上に]</a>
<a href="99050131.htm" tppabs="http://www.tohoho-web.com/lng/199905/99050131.htm">[前に]</a>
<a href="99050133.htm" tppabs="http://www.tohoho-web.com/lng/199905/99050133.htm">[次に]</a>
</body>
</html>
