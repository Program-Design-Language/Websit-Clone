<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>メール送信フォームの送信先を複数にできますか？</title>
<link rel="stylesheet" href="../style.css" tppabs="http://www.tohoho-web.com/lng/style.css">
</head>
<body>
<h3>メール送信フォームの送信先を複数にできますか？</h3>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199905/index.htm">[上に]</a>
<a href="99050053.htm" tppabs="http://www.tohoho-web.com/lng/199905/99050053.htm">[前に]</a>
<a href="99050055.htm" tppabs="http://www.tohoho-web.com/lng/199905/99050055.htm">[次に]</a>
<hr>
<span class=name>hiro</span>
<span class=email><a href="mailto:hiroshi@aimnow.com">[E-Mail]</a></span>
<span class=time>1999/05/14(金) 00:10:44</span><br>
皆さん、はじめまして。<br>
<br>
CGIを自分で書くことができないので、無料のメール送信ファームを<br>
利用しています。今度、その送信先を２箇所にしたいと考えていますが、<br>
可能でしょうか？<br>
<br>
もし可能でしたら、「wwwmail.txt」の下記の箇所に、どのように<br>
２つのメールアドレスを書けば良いのでしょうか？<br>
<br>
アドバイスよろしくお願いいたします。<br>
<br>
# ★ 送信先メールアドレス<br>
#&nbsp;&nbsp;&nbsp;&nbsp;$mailto = 'abc@xxx.yyy.zzz'; のようにあなたのメールアドレスに<br>
#&nbsp;&nbsp;&nbsp;&nbsp;書き換えてください。<br>
$mailto = '';<br>
<hr>
<span class=name>ふじ</span>
<span class=time>1999/05/14(金) 01:21:38</span><br>
$mailtpo = 'abc@xxx.yyy.zzz,efg@aaa.bbb.ccc';<br>
<hr>
<span class=name>ふじ</span>
<span class=time>1999/05/14(金) 01:22:27</span><br>
あ、間違えた。<br>
$mailtpo -&gt; $mailto<br>
です。<br>
<hr>
<span class=name>hiro</span>
<span class=time>1999/05/14(金) 12:28:12</span><br>
ふじさん、アドバイスありがとうございます。<br>
<br>
このようにやってみたのですが、一つのメールアドレスにしか<br>
送信されません。なぜなのでしょう？<br>
<br>
一つには届くのでCGIはきちんと動いていると思いますが、<br>
二つ目に届かない場合には、どのような箇所を確認すれば<br>
良いのでしょうか？<br>
<br>
アドバイスお願いいたします。<br>
<hr>
<span class=name>なえ</span>
<span class=time>1999/05/14(金) 13:15:00</span><br>
ふじさんのやり方でだめなら、おそらくその無料のメール送信CGIが<br>
一件しか送れないような仕様になってるんじゃないでしょうか？<br>
<hr>
<span class=name>hiro</span>
<span class=time>1999/05/14(金) 16:05:52</span><br>
なえさん、ありがとうございます。<br>
そういうこともあるのですね。<br>
<br>
試したのはこちらの「とほほさんのメール送信フォーム<br>
(wwwmail.cgi)」と「ネットサーフレスキュー<br>
[裏技]さんのwebform.cgi」です。<br>
<br>
これらのCGIで複数のメールに送信できないとすると、<br>
他の可能な無料CGIを、どなたかご存じではないでしょうか？<br>
<hr>
<span class=name>ふじ</span>
<span class=time>1999/05/14(金) 16:33:12</span><br>
もしかして、sendmailの方に制限を掛けているかもしれません。<br>
だとすると、CGIの方で<br>
<br>
foreach $mailto('aaa@bbb.ccc' , 'xxx@yyy.zzz'){<br>
...<br>
メイルを送信する部分<br>
...<br>
}<br>
などとして、２回送信するようにしないといけないかもしれませんね。<br>
<hr>
<span class=name>hiro</span>
<span class=time>1999/05/14(金) 19:46:38</span><br>
ふじさん、ありがとうございます。<br>
<br>
教えていただいたことを試してみたいのですが、CGIが<br>
詳しくありません。少しお教えいただけますか。<br>
<br>
これはCGI本体の中にあるメール送信部分を上記のように囲み、<br>
メールの送信先を２箇所、先に書き込んでしまうということ<br>
ですね。ただCGIの中で、どこが「メイルを送信する部分」<br>
なのかがはっきりしません。<br>
<br>
「メイルを送信する部分」は、通常どのように書きはじめて<br>
いるのでしょうか？<br>
<br>
「wwwmail.cgi」もしくは「webform.cgi」を例に<br>
教えていただくことはできますでしょうか？<br>
<br>
また、上記のような追加書き込みをすると、以下のように<br>
なっている箇所は、空欄にしておけばよいのでしょうか？<br>
<br>
# ★ 送信先メールアドレス<br>
#&nbsp;&nbsp;&nbsp;&nbsp;$mailto = 'abc@xxx.yyy.zzz'; のようにあなたのメールアドレスに<br>
#&nbsp;&nbsp;&nbsp;&nbsp;書き換えてください。<br>
$mailto = '';<br>
<hr>
<span class=name>ふじ</span>
<span class=time>1999/05/15(土) 01:57:45</span><br>
wwwmail.cgiを例に取りますと、<br>
<br>
foreach $mailto ('aaa@bbb.ccc' , 'xxx@yyy.zzz'){<br>
#-----ここから<br>
#<br>
# メールヘッダを作成する<br>
#<br>
{<br>
	&amp;jcode'convert(*subject, "jis");<br>
	$mailhead&nbsp;&nbsp;= "To: $mailto\n";<br>
	if ($FORM{'EMAIL'} ne "(unknown)") {<br>
.........<br>
中略<br>
.........<br>
	unless (print OUT $mailbody) {<br>
	&nbsp;&nbsp;&nbsp;&nbsp;&amp;errexit("メールの送信に失敗しました。");<br>
	}<br>
	close(OUT);<br>
}<br>
#-----ここまで<br>
}<br>
<br>
と、上記のように括ればよろしいかと。<br>
この場合、最初の $mailto の設定は空のままでよいです。<br>
<hr>
<span class=name>hiro</span>
<span class=time>1999/05/15(土) 08:18:58</span><br>
ふじさん、本当にありがとうございます。<br>
２カ所のメールアドレスへの送信はうまくいきました。<br>
<br>
ただ「wwwmail.cgi」の場合、「ブラウザ画面に送信結果を書き出す」<br>
ようになっていますが、ユーザーに書いていただいたメッセージ内容が<br>
重複して表示されてしまいます。これを防ぐことはできないでしょうか？<br>
<br>
細かくお聞きしてばかりで申し訳ありません。<br>
<br>
例）<br>
name=太郎<br>
email=aaa@bbb.com<br>
comments=こんにちは<br>
name=太郎<br>
email=aaa@bbb.com<br>
comments=こんにちは<br>
<hr>
<span class=name>ふじ</span>
<span class=time>1999/05/15(土) 15:06:12</span><br>
#<br>
# メールボディを作成する<br>
#<br>
{<br>
$mailbody = '';<br>
for ($i = 0; $i &lt; $cnt; $i++) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;$mailbody .= "$FORM[$i] = $FORM{$FORM[$i]}\n";<br>
}<br>
<br>
上記のように、<br>
$mailbody = '';<br>
を追加すればいいでしょう。<br>
（繰り返しているから、$mailbody を一回毎にクリアしないと）<br>
<hr>
<span class=name>hiro</span>
<span class=time>1999/05/15(土) 17:26:23</span><br>
ふじさん、うまく解決できました。<br>
本当にありがとうございました。<br>
<br>
最後に大したことではないのですが、ブラウザ画面に<br>
送信結果が表示された時、一点疑問が出てきました。<br>
<br>
「Cc:」として、記入された方のメールアドレスが表示<br>
されていますが、私がテストをしたアドレスに、メールが<br>
送られることはありませんでした。「Cc:」に関しては<br>
以下の部分が関係ありそうですが、これは何のために<br>
書かれているのでしょうか？<br>
<br>
# メールヘッダを作成する<br>
（中略）<br>
	if ($FORM{'EMAIL'} ne "(unknown)") {<br>
		$mailhead .= "Cc: $FORM{'EMAIL'}\n";<br>
	}<br>
<hr>
<span class=name>ふじ</span>
<span class=time>1999/05/15(土) 21:59:13</span><br>
sendmailは、To:とCc:に同じアドレスがあると、<br>
まとめて１通しか送らないようです。<br>
<br>
普通、Cc:で指定したアドレスにもメイルが送られますが、<br>
hiroさんの環境ではsendmailで1つの宛先にしか送信できない<br>
制限を掛けている可能性があるので、Cc:を無視しているのかも知れません。<br>
<hr>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199905/index.htm">[上に]</a>
<a href="99050053.htm" tppabs="http://www.tohoho-web.com/lng/199905/99050053.htm">[前に]</a>
<a href="99050055.htm" tppabs="http://www.tohoho-web.com/lng/199905/99050055.htm">[次に]</a>
</body>
</html>
