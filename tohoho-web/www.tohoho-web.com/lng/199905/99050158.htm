<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>テーブルのデータを取得しテキストに貼り付けるには？</title>
<link rel="stylesheet" href="../style.css" tppabs="http://www.tohoho-web.com/lng/style.css">
</head>
<body>
<h3>テーブルのデータを取得しテキストに貼り付けるには？</h3>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199905/index.htm">[上に]</a>
<a href="99050157.htm" tppabs="http://www.tohoho-web.com/lng/199905/99050157.htm">[前に]</a>
<a href="99050159.htm" tppabs="http://www.tohoho-web.com/lng/199905/99050159.htm">[次に]</a>
<hr>
<span class=name>ばーばぱぱ</span>
<span class=time>1999/05/26(水) 15:57:08</span><br>
ボタンが押された時、選択されているテーブルのセルの内容が<br>
テキストボックスにコピーされるという様な処理をしたいの<br>
ですが、どなたかサンプルをいただけないでしょうか？<br>
また、defaultValueを使うのでしょうか？<br>
<hr>
<span class=name>ばーばぱぱ</span>
<span class=time>1999/05/27(木) 17:18:42</span><br>
&lt;TR&gt;のbackgroundColorがyellowのものを見つけて、<br>
&lt;TD&gt;の内容をそれぞれのテキストに表示する処理<br>
なんですけど、どなたか助言お願いします。<br>
<br>
<hr>
<span class=name>Nobu3</span>
<span class=time>1999/05/27(木) 17:59:51</span><br>
前の質問と関連してるんですね・・・<br>
そういう場合は、解決してからの方が手間がかかりませんね。<br>
<br>
スクリプトは、<br>
function txcopy(){<br>
	cnt=0;<br>
	for(i=0;i&lt;document.all.length;i++){<br>
		if((document.all[i].tagName=='TD')&amp;&amp;(document.all[i].parentElement.style.backgroundColor=='blue')){<br>
			document.fm1.elements[cnt].value=document.all[i].innerHTML;<br>
			cnt++;<br>
		}<br>
	}<br>
}<br>
<br>
ボディは、<br>
&lt;form name=fm1&gt;<br>
&lt;input type=text&gt;&lt;input type=text&gt;&lt;input type=text&gt;&lt;br&gt;<br>
&lt;input type=button onclick="txcopy()"&gt;<br>
&lt;/form&gt;<br>
<br>
こんな感じでしょうか？<br>
スクリプトを見ればわかるでしょうが、かなり手抜きです。<br>
&lt;td&gt;は３つまでじゃないと、とんでもないことになります。<br>
もっと処理の早い方法もあるし・・・<br>
あと、これはＩＥ４用なので。その辺はご理解を。<br>
<br>
<hr>
<span class=name>Nobu3</span>
<span class=time>1999/05/27(木) 18:01:04</span><br>
あぁ・・・<br>
背景は「yellow」でしたっけ・・・<br>
すいません。<br>
でも、わかりますよね。<br>
<br>
<hr>
<span class=name>ばーばぱぱ</span>
<span class=time>1999/05/28(金) 10:18:17</span><br>
Nobu3さんいつもありがとうございます。<br>
たびたびすみませんが、このセルの内容は、このテキストに<br>
というようなことはできますか？<br>
また、上のスクリプトで、どこでテキストの場所を指定するのですか？<br>
document.fm1.elements[cnt].valueのelements[cnt]でしょうか？<br>
さらにdocumentの前にフレームの指定はできるのでしょうか？<br>
いろいろ質問してすみませんが、助言よろしくお願いします。<br>
<hr>
<span class=name>Nobu3</span>
<span class=time>1999/05/28(金) 12:45:04</span><br>
１．cntは成功するたびに１ずつ増えるので、それによって出力を変更すればできます。<br>
<br>
２．elements[cnt]です。それを変更すれば良いです。<br>
<br>
３．documentはwindow（frame）の子オブジェクト（？）なので、指定できます。<br>
<br>
<hr>
<span class=name>ばーばぱぱ</span>
<span class=time>1999/05/28(金) 14:39:55</span><br>
とりあえず、テキストに挿入することができたのですが、<br>
ラジオボタンにチェックを入れることができません。<br>
&lt;TD&gt;の内容によってチェックする場所がかわる様にifを<br>
つかったのですが、うまくいきません。<br>
<br>
if(parent.No2.document.all[i++]=="　内"){<br>
parent.No1.document.FORM1.naigai(0).checked=true;}<br>
else{<br>
if(parent.No2.document.all[i]=="　外"){<br>
parent.No1.document.FORM1.naigai(1).checked=true;}<br>
}<br>
<br>
どこかおかしな所があたら教えてください。<br>
naigaiはラジオボタンのNameです。<br>
<br>
<hr>
<span class=name>ばーばぱぱ</span>
<span class=time>1999/05/28(金) 14:58:26</span><br>
すみません。追加質問です。<br>
Nobe3の教えてくれた方法で行ったら、テキストには表示されたのですが、<br>
コンポボックスに表示されないのですが、なぜですか？<br>
<hr>
<span class=name>Nobu3</span>
<span class=time>1999/05/28(金) 15:14:33</span><br>
document.all[i++].innerHTMLです。たぶん。<br>
<br>
コンボって&lt;select&gt;のことですか？<br>
それなら、&lt;select&gt;ではなく、&lt;option&gt;を直に変更しなくてはいけません。<br>
&lt;option&gt;はvalueではなくtextというプロパティがあるので、そちらで変更できるでしょう。<br>
<br>
document.fm1.sl1.options[0].value='最初の値（目に見えない）';<br>
document.fm1.sl1.options[0].text='最初のテキスト（文字列）';<br>
<br>
<hr>
<span class=name>ばーばぱぱ</span>
<span class=time>1999/05/28(金) 16:42:00</span><br>
教えてくれたとおりにしたのですが、<br>
コンボボックスに表示されません。<br>
もしかして、あらかじめ登録しておかなければいけないのでしょうか。<br>
とりあえず、修正したソースを見てください。<br>
おかしなところがあったら教えてください。<br>
<br>
parent.No1.document.FORM1.Yomu.options[0].value=parent.No2.document.all[i++].innerHTML;<br>
parent.No1.document.FORM1.Yomu.options[0].text=parent.No2.document.all[i].innerHTML;<br>
<br>
&lt;option&gt;のvalueをtextに変更したのですが、<br>
これで良かったのでしょうか？<br>
<hr>
<span class=name>Nobu3</span>
<span class=time>1999/05/28(金) 16:59:18</span><br>
え〜っと・・・<br>
&lt;form&gt;の中身はどうなってます？<br>
スクリプトはあってるようですけど、なんか誤解されてるような気が・・・<br>
<br>
&lt;option value="..."&gt;は<br>
&lt;option text="..."&gt;なんて書いてはダメですよ。<br>
っていうか・・・書いても無視するから関係無いけど・・・<br>
<br>
あと、一応確認ですが、&lt;text&gt;ではうまくいってるんですね？<br>
<br>
<hr>
<span class=name>Nobu3</span>
<span class=time>1999/05/28(金) 17:00:48</span><br>
あ、Yomuって名前は、どのタグにつけてます？<br>
<br>
<hr>
<span class=name>ばーばぱぱ</span>
<span class=time>1999/05/28(金) 17:15:23</span><br>
Yomuはここにあります。<br>
&lt;SELECT name="Yomu"&gt;<br>
&lt;OPTION text="用務"&gt;用務&lt;/OPTION&gt;<br>
<br>
フォームの中身ってこういうことですよね。<br>
&lt;FORM NAME="FORM1"&gt;<br>
<br>
テキストではうまくいっています。<br>
<br>
<hr>
<span class=name>Nobu3</span>
<span class=time>1999/05/28(金) 17:29:00</span><br>
あ〜・・・<br>
まず訂正：&lt;text&gt;は&lt;input type=text&gt;です。<br>
<br>
１．&lt;/select&gt;は書いてないのですか？<br>
２．&lt;form&gt;〜&lt;/form&gt;のことです・・・。<br>
<br>
うちの環境では、うまくいってますが・・・<br>
そのページは公開できないのですか？<br>
無理なら、スクリプト（特に分岐部分とか）見せてくれません？<br>
<br>
あと、&lt;option text="..."&gt;はダメだと書きました。<br>
<br>
<hr>
<span class=name>ばーばぱｐ</span>
<span class=time>1999/05/28(金) 17:36:40</span><br>
<span class=resolv>[[解決]]</span><br>
Nobu3さん、お手数かけました。<br>
&lt;option value=""&gt;にしたらできました。<br>
勘違いしていたようです。<br>
<br>
&lt;/select&gt;は書いてあります。<br>
<br>
このページは業務用なので公開できないと思います。<br>
切羽詰まった時、公開するかもしれないので<br>
その時は、助言よろしくお願いします。<br>
<hr>
<span class=name>Nobu3</span>
<span class=time>1999/05/28(金) 17:36:42</span><br>
「プロパティ」というのはスクリプトで使う言葉で、HTMLでは使いません。<br>
あと、<br>
<font color="#CC8000">&gt;&lt;option&gt;はvalueではなくtextというプロパティがあるので、そちらで変更できるでしょう。</font><br>
これは誤解を招く書き方でした。<br>
valueの他にtextというプロパティがあり、表示される文字列は、textの方です。<br>
と言いたかったんですが・・・苦しい (^^;;;<br>
<br>
<hr>
<span class=name>ばーばぱぱ</span>
<span class=time>1999/05/28(金) 17:39:12</span><br>
おっと、重なってしまったようですね。<br>
改めて、Nobu3さんありがとうございました。<br>
本当に助かりました。<br>
<hr>
<span class=name>Nobu3</span>
<span class=time>1999/05/28(金) 17:42:16</span><br>
２秒差でおそかった・・・<br>
<br>
業務用ですか。<br>
いきなりではなく、簡単なサンプルを作ってからのほうが安全ですよ。<br>
そのほうが公開もできるし、解決も速くなるでしょうし。<br>
あと、用語関係は覚えてくださいね。<br>
こっちも話しにくいです（笑）<br>
<br>
<hr>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199905/index.htm">[上に]</a>
<a href="99050157.htm" tppabs="http://www.tohoho-web.com/lng/199905/99050157.htm">[前に]</a>
<a href="99050159.htm" tppabs="http://www.tohoho-web.com/lng/199905/99050159.htm">[次に]</a>
</body>
</html>
