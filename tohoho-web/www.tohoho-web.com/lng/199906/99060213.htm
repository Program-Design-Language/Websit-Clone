<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>外部JavaScript関数の引数の指定の仕方は？</title>
<link rel="stylesheet" href="../style.css" tppabs="http://www.tohoho-web.com/lng/style.css">
</head>
<body>
<h3>外部JavaScript関数の引数の指定の仕方は？</h3>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199906/index.htm">[上に]</a>
<a href="99060212.htm" tppabs="http://www.tohoho-web.com/lng/199906/99060212.htm">[前に]</a>
<a href="99060214.htm" tppabs="http://www.tohoho-web.com/lng/199906/99060214.htm">[次に]</a>
<hr>
<span class=name>Junko</span>
<span class=time>1999/06/22(火) 12:27:12</span><br>
JavaScript初心者です。<br>
汎用的に利用できるよう、どの画面のどのフィールドからも使われる<br>
関数を外部JavaScriptとして別ファイルに分けたいと思っています。<br>
<br>
そこで別ファイルに分けたときの関数の引数の指定の仕方<br>
なのですが、例えば以下の関数を外部ファイルにした場合、<br>
フォームからの引数の設定の仕方はどうすればよいのですか？<br>
<br>
function TextAreaLen(val) {<br>
////////////////////////////////////////////////////////////<br>
// 引数:TEXTAREAの値<br>
// TEXTAREAの入力バイト数を返す<br>
////////////////////////////////////////////////////////////<br>
var len;<br>
var i=0;<br>
var escval;<br>
escval=escape(val);<br>
len=escval.length;<br>
<br>
for(; (i=escval.indexOf('%', i))&gt;-1; i++) {<br>
len -= escval.charAt(i+1)=='u' ? 4 : 2;<br>
}<br>
return(len);<br>
}<br>
<br>
上記の関数を内部的に持ったら、<br>
<br>
&lt;form name="Form1" action="xxxx" method="post" onSubmit="return Check(this)"&gt;<br>
-----<br>
function Check(form){<br>
&nbsp;&nbsp;if(TextAreaLen(form.fld1.value)&gt;100){<br>
&nbsp;&nbsp;&nbsp;&nbsp;alert("fld1は100桁以内で入力してください");<br>
&nbsp;&nbsp;&nbsp;&nbsp;return false;<br>
&nbsp;&nbsp;}<br>
 ・<br>
 ・<br>
 ・<br>
&nbsp;&nbsp;else{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return true;<br>
&nbsp;&nbsp;}<br>
}<br>
<br>
と、なるというのは分かるんですけど・・・<br>
どなたかよろしくお願いします。<br>
<hr>
<span class=name>Nobu3</span>
<span class=time>1999/06/22(火) 16:07:49</span><br>
外部ファイルの使い方は知っていますか？<br>
&lt;script type="text/javascript" src="hoge.js"&gt;&lt;/script&gt;<br>
<br>
うまく取りこめたら、内部に持っている関数と同じように扱えます。<br>
ただし、変数はページの表示毎に初期化されるので注意してください。<br>
<hr>
<span class=name>Junko</span>
<span class=time>1999/06/22(火) 18:49:12</span><br>
<span class=resolv>[[解決]]</span><br>
<font color="#CC8000">&gt;うまく取りこめたら、内部に持っている関数と同じように扱えます。</font><br>
うまく取り込めてたんですが、どうやらコーディングミスだったようです。内部的な関数と同じ引数指定で通ったようです。<br>
JavaScriptのオブジェクトに弱いので、ちゃんと理解はしていないのですが・・・別に外部内部で引数の扱いに違いはないのですね？<br>
お騒がせして申し訳ありません。ありがとうございました。<br>
<hr>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199906/index.htm">[上に]</a>
<a href="99060212.htm" tppabs="http://www.tohoho-web.com/lng/199906/99060212.htm">[前に]</a>
<a href="99060214.htm" tppabs="http://www.tohoho-web.com/lng/199906/99060214.htm">[次に]</a>
</body>
</html>
