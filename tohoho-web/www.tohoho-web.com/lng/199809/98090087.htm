<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>Perlで全角文字の文字数を数えるには？</title>
<link rel="stylesheet" href="../style.css" tppabs="http://www.tohoho-web.com/lng/style.css">
</head>
<body>
<h3>Perlで全角文字の文字数を数えるには？</h3>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199809/index.htm">[上に]</a>
<a href="98090086.htm" tppabs="http://www.tohoho-web.com/lng/199809/98090086.htm">[前に]</a>
<a href="98090088.htm" tppabs="http://www.tohoho-web.com/lng/199809/98090088.htm">[次に]</a>
<hr>
<span class=name>ふに</span>
<span class=time>1998/09/28(月) 15:08:49</span><br>
Perl5で全角文字の文字数を数えようとして、lengthを使ったところ<br>
全角文字＊２の数が帰ってきます。どうも純粋なバイト数を返しているようです。<br>
全角・半角入り交じった文字列を数えなければいけないため、<br>
単純に２で割る訳にもいかず困っています。<br>
<br>
どなたか教えていただけますでしょうか。<br>
<br>
perl -v<br>
This is perl, version 5.004_04 built for sun4-solaris<br>
<br>
文字コードはＥＵＣです。<br>
<br>
よろしくお願いします。<br>
<hr>
<span class=name>Tiot</span>
<span class=email><a href="mailto:tiot@pat.hi-ho.ne.jp">[E-Mail]</a></span>
<span class=time>1998/09/28(月) 17:42:19</span><br>
jcode.plを使ってすべて全角にしておいてから、文字数を数えて2で割るというのはどうでしょう？<br>
<a href="98090081.htm" tppabs="http://www.tohoho-web.com/lng/199809/98090081.htm">../199809/98090081.htm</a><br>
を参照にしてください（まだ解決していませんが）。<br>
あとは正規表現で半角だけ、全角だけと分離しておいてから、別々に数えておいて足しあわせてもいいかも。<br>
ちなみにjperlを使ってもバイト数で返されてしまいます。<br>
こういった用途の、ライブラリかモジュールかを探せば有るかも知れません。<br>
ご存知の方がいらっしゃったら教えて下さい。<br>
＃solarisうらやましいな。<br>
<hr>
<span class=name>匿名希望</span>
<span class=time>1998/09/28(月) 19:19:02</span><br>
検査対象が$lineに入っているとして、<br>
<br>
$n = $line =~ tr/\xa1-\xfe/\xa1-\xfe/;<br>
<br>
この$nを2で割った値が全角文字の字数です。これはよく使われる<br>
技法です。<br>
manに載っている例では、*の個数を数えるには tr/*/*/<br>
<hr>
<span class=name>ふに</span>
<span class=time>1998/09/28(月) 19:53:27</span><br>
<span class=resolv>[[解決]]</span><br>
Tiotさん、匿名希望さん　早速のお応えありがとうございました。<br>
おかげさまで、全角文字の文字数を取り出すことができました。<br>
<br>
この方法だと、半角文字はカウントされないんですね。気をつけなければ・・・<br>
<br>
<hr>
<span class=name>Tiot</span>
<span class=time>1998/09/28(月) 21:40:05</span><br>
<font color="#CC8000">&gt;この方法だと、半角文字はカウントされないんですね。</font><br>
$m = $a =~ tr/\x00-\x7f/\x00-\x7f/;<br>
で、半角文字数です。<br>
コントロール＋英数字や空白を入れないなら\x21-\x7e。<br>
念のため。<br>
＃とか言いながら僕もさっきまでこの方法を知りませんでした。<br>
ありがとうございます。＞匿名希望さん<br>
<hr>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199809/index.htm">[上に]</a>
<a href="98090086.htm" tppabs="http://www.tohoho-web.com/lng/199809/98090086.htm">[前に]</a>
<a href="98090088.htm" tppabs="http://www.tohoho-web.com/lng/199809/98090088.htm">[次に]</a>
</body>
</html>
