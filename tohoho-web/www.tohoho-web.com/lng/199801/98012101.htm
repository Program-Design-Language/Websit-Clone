<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>JavaScriptでジャンプがうまくいかないときは？</title>
<link rel="stylesheet" href="../style.css" tppabs="http://www.tohoho-web.com/lng/style.css">
</head>
<body>
<h3>JavaScriptでジャンプがうまくいかないときは？</h3>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199801/index.htm">[上に]</a>
<a href="98012100.htm" tppabs="http://www.tohoho-web.com/lng/199801/98012100.htm">[前に]</a>
<a href="98012102.htm" tppabs="http://www.tohoho-web.com/lng/199801/98012102.htm">[次に]</a>
<hr>
<span class=name>ゆき</span>
<span class=time>1998/01/21(水) 16:01:34</span><br>
お客様をバージョン別に振り分けてジャンプさせたいのですが、<br>
NN3.0xだけエラーが出てしまいます。<br>
なぜか教えてください。<br>
ちなみに、この下にnn4.xやie3.x、4.xを分けるif文が続き、<br>
他ではでは正常動作します。<br>
<br>
こんなん書いてます。<br>
<br>
&lt;BODY onLoad="setTimeout('next()',1500)"&gt;<br>
&lt;SCRIPT LANGUAGE="JavaScript"&gt;<br>
&lt;!--<br>
var msg = "あなたはバージョン" + navigator.appVersion + "をお使いですね&lt;br&gt;";<br>
document.write( msg );<br>
<br>
var browser = navigator.appName.charAt( 0 );<br>
var version = navigator.appVersion.charAt( 0 );<br>
if( browser == "M" &amp;&amp; version == "4" ){<br>
&nbsp;&nbsp;&nbsp;&nbsp;document.write( "NN 3.xのページへジャンプします" );<br>
	function next(){<br>
		location.href="nw_home.html";<br>
	}<br>
}<br>
//--&gt;<br>
&lt;/SCRIPT&gt;<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>
<hr>
<span class=name>匿名希望</span>
<span class=time>1998/01/21(水) 19:47:01</span><br>
NN 3.xなら、<br>
if( browser == "M" &amp;&amp; version == "4" ){<br>
ここは"N"と"3"じゃあないかな？<br>
<hr>
<span class=name>ゆき</span>
<span class=time>1998/01/21(水) 21:45:27</span><br>
申し訳ありません。<br>
ここでのミスです。<br>
実際に書いてるページでは、<br>
if( browser == "N" &amp;&amp; version == "3" ){<br>
と書いております・・・<br>
<hr>
<span class=name>hiro-kim</span>
<span class=time>1998/01/22(木) 07:24:28</span><br>
NN3.0xでちょっと試してみました。<br>
function 自作関数名() {……} の構文はあくまで，主ルーチンの外部であらかじめ関数を定義しておくための文法として解釈しているようですね。関数の定義と実行を同時におこなう，今風のプログラム言語の文法は使えないわけです。<br>
　　&lt;HEAD&gt;<br>
　　&lt;SCRIPT LANGUAGE="JavaScript"&gt;<br>
　　&lt;!--<br>
　　function next(){<br>
　　　　location.href="nw_home.html";<br>
　　}<br>
　　//--&gt;<br>
　　&lt;/SCRIPT&gt;<br>
　　&lt;/HEAD&gt;<br>
のように書いておけば，前もって，関数の定義と構文チェックはできますから，あとは，次のように関数を呼ぶだけです。<br>
　　if(……){<br>
　　　　document.write(……);<br>
　　　　next();<br>
　　}<br>
もちろん，はなから関数を使わずに，このように書いてもよいのですけれど。<br>
　　if(……){<br>
　　　　document.write(……);<br>
　　　　location.href="nw_home.html";<br>
　　}<br>
<hr>
<span class=name>ゆき</span>
<span class=time>1998/01/22(木) 11:20:15</span><br>
<span class=resolv>[[解決]]</span><br>
hiro-kimさんどうもありがとうございました！！<br>
<hr>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199801/index.htm">[上に]</a>
<a href="98012100.htm" tppabs="http://www.tohoho-web.com/lng/199801/98012100.htm">[前に]</a>
<a href="98012102.htm" tppabs="http://www.tohoho-web.com/lng/199801/98012102.htm">[次に]</a>
</body>
</html>
