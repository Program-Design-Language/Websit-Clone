<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>IE5でwindow.closedを使うには？</title>
<link rel="stylesheet" href="../style.css" tppabs="http://www.tohoho-web.com/lng/style.css">
</head>
<body>
<h3>IE5でwindow.closedを使うには？</h3>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199907/index.htm">[上に]</a>
<a href="99070237.htm" tppabs="http://www.tohoho-web.com/lng/199907/99070237.htm">[前に]</a>
<a href="99070239.htm" tppabs="http://www.tohoho-web.com/lng/199907/99070239.htm">[次に]</a>
<hr>
<span class=name>くみぽん</span>
<span class=time>1999/07/22(木) 21:31:52</span><br>
初心者なのでプログラムにおかしな<br>
ところがあるかもしれませんが教え<br>
て下さい。親ウィンドウからフレ<br>
ーム分割したサブウィンドウを開い<br>
て、そのサブウィンドウ(の中のフレ<br>
ーム)から以下のjavascript関数で<br>
親ウィンドウが開いているかチェック<br>
したいのですが、<br>
<br>
function AAA(){<br>
&nbsp;&nbsp;&nbsp;var sw=window.parent;<br>
&nbsp;&nbsp;&nbsp;if(sw.opener.closed==false)<br>
&nbsp;&nbsp;&nbsp;{<br>
	alert("親ウィンドウはオープンしています。");<br>
&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;else<br>
&nbsp;&nbsp;&nbsp;{<br>
	alert("親ウィンドウはクローズしています。");<br>
&nbsp;&nbsp;&nbsp;}<br>
}<br>
<br>
NN4やIE4ではうまくいくのですがIE5では<br>
親ウィンドウを閉じても<br>
<br>
alert("親ウィンドウはオープンしています。");<br>
<br>
が出てきてしまいます。どこがいけないん<br>
でしょう？どなたか教えていただけませんか？<br>
<hr>
<span class=name>ばーばまま</span>
<span class=time>1999/07/23(金) 00:22:19</span><br>
確かめてみたところ、フレームのサブウィンドウを<br>
<br>
&lt;A TARGET="FOO" HREF="frame.html"&gt;<br>
<br>
で開いた時は駄目で、<br>
<br>
&lt;A HREF="BOO" onClick="window.open('frame.html', 'FOO')"&gt;<br>
<br>
で開いた時はうまくいくような気がします・・・<br>
<hr>
<span class=name>Nobu3</span>
<span class=time>1999/07/23(金) 00:33:36</span><br>
う〜ん・・・。IE5のバグじゃないんでしょうか？<br>
フレームに限らず、通常のウィンドウの場合でも同じ動作です。<br>
いちおうNN4.6で試してみましたが、正常に動いたので、<br>
スクリプトはあっていると思います。<br>
<hr>
<span class=name>ばび〜ん</span>
<span class=time>1999/07/23(金) 00:57:31</span><br>
フラグをひとつ立てて、親ウィンドウの onUnloadを拾うとか。<br>
その時に子ウィンドウが閉じてたらエラーでるし、色々な状況を想定すると<br>
エラーが出ないようにフラグ立てまくることになるかも。<br>
<hr>
<span class=name>こうの</span>
<span class=email><a href="mailto:kohnyo@mcn.ne.jp">[E-Mail]</a></span>
<span class=time>2000/03/09(木) 02:37:21</span><br>
親Window（Zとします。）からAというWindowを開き、そのWindowから（Onloadイベントなどで）BというWindowを開いて、A（親）B（子）の関係でそのスクリプトを試してみたらうまくいきませんか？<br>
でもZから直接Bを開いても、Z、Bの関係ではうまくいかないのですよね。<br>
<br>
私もまえにそれで悩んだ記憶が...<br>
多分IE5のバグだと思います。<br>
ばび〜んさんのような方法を試してみてはどうでしょうか？<br>
<hr>
<span class=name>無責任官庁</span>
<span class=time>2000/03/09(木) 09:28:09</span><br>
ＩＥ４でもそうだったような気がしますけども、<br>
インターネットオプションの中にある<br>
「新しいプロセスでブラウズを開始」のチェックが付いてると、<br>
うまくいかないような事例があったような記憶があります。<br>
ＩＥ５は、デフォルトでチェック付いてたと思います。<br>
（ＩＥ４は、デフォルトでチェック付いてない）<br>
私の所はＩＥ５入れてないので、アレですけども…<br>
チェックを外して試してみてもらえます？<br>
<br>
＃これ、チェックを外して“ＯＫ”したら、一旦全てのＩＥを<br>
＃終了させないと、うまく適用されません。<br>
<hr>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199907/index.htm">[上に]</a>
<a href="99070237.htm" tppabs="http://www.tohoho-web.com/lng/199907/99070237.htm">[前に]</a>
<a href="99070239.htm" tppabs="http://www.tohoho-web.com/lng/199907/99070239.htm">[次に]</a>
</body>
</html>
