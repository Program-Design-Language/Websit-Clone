<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>…そうなんでしょうか。</title>
<link rel="stylesheet" href="../style.css" tppabs="http://www.tohoho-web.com/lng/style.css">
</head>
<body>
<h3>…そうなんでしょうか。</h3>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199907/index.htm">[上に]</a>
<a href="99070143.htm" tppabs="http://www.tohoho-web.com/lng/199907/99070143.htm">[前に]</a>
<a href="99070145.htm" tppabs="http://www.tohoho-web.com/lng/199907/99070145.htm">[次に]</a>
<hr>
<span class=name>ひよこ</span>
<span class=email><a href="mailto:sagawa@jbc.co.jp">[E-Mail]</a></span>
<span class=time>1999/07/14(水) 17:23:34</span><br>
初歩的な質問ですみません。<br>
perlで1/100と計算すると、0.010000000000000000208となります。<br>
1*0.1とすると0.10000000000000000555となります。<br>
これって、2進数で表せる近似値で計算しているってことなんでしょうか？<br>
そして、これをきれいに計算する(0.01や0.1のように)ことはperlでは無理なのでしょうか？<br>
教えて下さい。<br>
<hr>
<span class=name>B-Cus</span>
<span class=time>1999/07/14(水) 18:53:38</span><br>
<font color="#CC8000">&gt; …そうなんでしょうか。</font><br>
まず、こういう意味不明なタイトルを付けるのはやめましょう。<br>
「perlでの小数の扱い」とか、そういうわかりやすいタイトルにしましょう。<br>
<br>
本題ですが、0.1は2進表現では循環小数になるので、正しい値を<br>
保持するのは無理です。近似値になるのは仕方ないです。<br>
# もしかしたらちゃんと扱えるパッケージはあるかもしれんけど。<br>
<br>
<font color="#CC8000">&gt; perlで1/100と計算すると、0.010000000000000000208となります。</font><br>
ところで、逆に質問なのですが、この値ってどうやって出るんですか?<br>
　% perl -e 'print 1*0.1,"\n",1/100,"\n"'<br>
　0.1<br>
　0.01<br>
となりましたし、printfの%d %u %f %gでもその値は出ませんでした。<br>
<br>
もしどうしても0.010000...となってしまうなら、小数点以下第3位まで<br>
しか扱わないなどと決めておいて、<br>
　- 計算は普通に行ない、表示するときにprintf("%.3f",$i) とする<br>
　- ゲタを履かせて常に1000倍した値で計算し、表示するときに文字列として<br>
　　小数点をずらず<br>
などの方法があると思います。<br>
<hr>
<span class=name>ひよこ</span>
<span class=email><a href="mailto:sagawa@jbc.co.jp">[E-Mail]</a></span>
<span class=time>1999/07/15(木) 09:11:56</span><br>
<font color="#CC8000">&gt;まず、こういう意味不明なタイトルを付けるのはやめましょう。</font><br>
・・・すみませんxxx<br>
送ってから、「やっぱりああいうタイトルはまずいよなぁ」と思いました。<br>
以後気を付けます。<br>
<br>
<font color="#CC8000">&gt;ところで、逆に質問なのですが、この値ってどうやって出るんですか?</font><br>
あれ？じゃあ、書き方が悪いのでしょうか？<br>
$num1 = 1 * 0.1;<br>
$num2 = 1 / 100;<br>
<br>
print $num1;<br>
print $num2;<br>
<br>
としています。<br>
<hr>
<span class=name>ふじ</span>
<span class=time>1999/07/15(木) 11:44:08</span><br>
Perlのバージョンによって違うみたい。<br>
<br>
私の確認できたところでは、<br>
Perl 5.005_3(Win32)、Perl 5.004_01(Free BSD)だと<br>
0.1<br>
0.01<br>
<br>
Perl 4.0(SunOS 5.6)では<br>
0.10000000000000000555<br>
0.010000000000000000208<br>
<br>
と表示されました。<br>
<hr>
<span class=name>ひよこ</span>
<span class=time>1999/07/15(木) 13:16:53</span><br>
<span class=resolv>[[解決]]</span><br>
あ、バージョンで違うんですかぁ。<br>
なるほど。<br>
確かにPerl 4.0です。<br>
ありがとうございました！！<br>
ゲタを履かせて計算させてから…という方法を取ることにします。<br>
<hr>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199907/index.htm">[上に]</a>
<a href="99070143.htm" tppabs="http://www.tohoho-web.com/lng/199907/99070143.htm">[前に]</a>
<a href="99070145.htm" tppabs="http://www.tohoho-web.com/lng/199907/99070145.htm">[次に]</a>
</body>
</html>
