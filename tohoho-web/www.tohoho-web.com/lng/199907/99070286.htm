<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>イントラネット内のＨＰのカウンタ</title>
<link rel="stylesheet" href="../style.css" tppabs="http://www.tohoho-web.com/lng/style.css">
</head>
<body>
<h3>イントラネット内のＨＰのカウンタ</h3>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199907/index.htm">[上に]</a>
<a href="99070285.htm" tppabs="http://www.tohoho-web.com/lng/199907/99070285.htm">[前に]</a>
<a href="99070287.htm" tppabs="http://www.tohoho-web.com/lng/199907/99070287.htm">[次に]</a>
<hr>
<span class=name>ＵＳＫ</span>
<span class=time>1999/07/27(火) 16:02:48</span><br>
イントラネット内のＨＰに「とほほカウンター」を設置しました。<br>
同一アドレスチェック機能をしようするために<br>
「$do_address_check = 1;」にするとカウンタが全く上がらなく<br>
なります。<br>
改善策を教えて下さい。<br>
<hr>
<span class=name>エイ</span>
<span class=time>1999/07/27(火) 16:33:30</span><br>
イントラ内部の事情がよく分からんし、ここのカウンターは使って無いから<br>
確信あるわけじゃないんだが、ちょっと推測してみるに。。。<br>
<br>
１．外に書き込めるみたいだからファイアウォール有り。<br>
２．設定上ファイアウォールに繋がないと外見れない。<br>
３．この時、ブラウザのプロクシ設定から「以下のIPはプロクシを通さない」を<br>
　だぁれも設定してない。<br>
４．イントラ内に設置されたWEBページは皆同じIP（プロクシ）になる。<br>
５．従ってカウントアップされない。<br>
<br>
こんな感じでどないだ？　正解だとしたら対応策は以下２点。<br>
<br>
１．$do_address_check は 0　で我慢。<br>
２．全ての社内ブラウザの設定を変えて貰う。<br>
<br>
現実味のあるのは１だな。<br>
試しに　$do_address_check = 0　で暫くログ取ってみることをお勧めする。<br>
っていうか、これ試してIPは違うのにカウントアップされないんだろーか？？<br>
<hr>
<span class=name>ぺぱーど</span>
<span class=time>1999/07/28(水) 00:16:49</span><br>
使っているプロクシにもよるけど<br>
CGIの中のREMOTE_ADDRをHTTP_X_FORWARDED_FORに変えてみるとか．<br>
これならプロクシのアドレスではなくて各マシンのアドレスが取れるだろうから<br>
ブラウザの設定はそのままで対応出来る可能性あり．<br>
<hr>
<span class=name>ＵＳＫ</span>
<span class=time>1999/07/28(水) 09:01:38</span><br>
エイさんの言うように同じＩＰを取っているようです。<br>
ペパードさんが言うように、「REMOTE_ADDR」を<br>
「HTTP_X_FORWARDED_FOR」にするとちゃんと動いているようです。<br>
wwwcount.cgi内に「REMOTE_ADDR」は３ヶ所あるのですが<br>
全て「HTTP_X_FORWARDED_FOR」に変えてもよいのでしょうか？<br>
あと各マシンのアドレスとは何の事を指しているのでしょうか？<br>
ぺぱーどさん、その他わかる方、教えて下さい。<br>
<hr>
<span class=name>ぺぱーど</span>
<span class=time>1999/07/29(木) 00:34:44</span><br>
<font color="#CC8000">＞全て「HTTP_X_FORWARDED_FOR」に変えてもよいのでしょうか？</font><br>
３つとも変えないと正常に動かないはず．<br>
<br>
<font color="#CC8000">＞あと各マシンのアドレスとは何の事を指しているのでしょうか？</font><br>
（各マシンの）ＩＰアドレスの事．<br>
<hr>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199907/index.htm">[上に]</a>
<a href="99070285.htm" tppabs="http://www.tohoho-web.com/lng/199907/99070285.htm">[前に]</a>
<a href="99070287.htm" tppabs="http://www.tohoho-web.com/lng/199907/99070287.htm">[次に]</a>
</body>
</html>
