<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>画像呼び出しのＣＧＩで、何とかしてリンク元を記録しておくには</title>
<link rel="stylesheet" href="../style.css" tppabs="http://www.tohoho-web.com/lng/style.css">
</head>
<body>
<h3>画像呼び出しのＣＧＩで、何とかしてリンク元を記録しておくには</h3>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199806/index.htm">[上に]</a>
<a href="98060065.htm" tppabs="http://www.tohoho-web.com/lng/199806/98060065.htm">[前に]</a>
<a href="98060067.htm" tppabs="http://www.tohoho-web.com/lng/199806/98060067.htm">[次に]</a>
<hr>
<span class=name>パァルを今日やり始めた人</span>
<span class=email><a href="mailto:mfujita@kz.tsukuba.ac.jp">[E-Mail]</a></span>
<span class=time>1998/06/27(土) 19:27:42</span><br>
ＣＧＩを使って、画像呼び出しのアクセスカウンターを<br>
作って、ついでにアクセスログも記録するようにしたのですが、<br>
時間と、ホストのアドレスしか記録できません。<br>
何とかして「直前に参照していたぺーじのＵＲＬ」を<br>
記録できないものでしょうか。<br>
何となく、JavaScriptと併用すれば出来ないかなーと思うのですが<br>
どなたか良い知恵をお願いします。<br>
<hr>
<span class=name>パァルを今日やり始めた人</span>
<span class=email><a href="mailto:mfujita@kz.tsukuba.ac.jp">[E-Mail]</a></span>
<span class=time>1998/06/27(土) 21:00:29</span><br>
出来ちゃいました。すいません。でもまだ質問なんですが。<br>
どうやったかというとJavaScriptで<br>
document.images["counter"].src+="&amp;link="+document.referrer;<br>
というのを画像の後に実行しのですが、<br>
何か問題ありますか？例えば、referrerのアドレスによっては<br>
変なことが起こるとか…<br>
<hr>
<span class=name>B-Cus</span>
<span class=time>1998/06/27(土) 23:15:49</span><br>
$ENV{'HTTP_REFERER'}を参照すればいいと思います。<br>
<hr>
<span class=name>パァルを今日やり始めた人</span>
<span class=email><a href="mailto:mfujita@kz.tsukuba.ac.jp/~s983432">[E-Mail]</a></span>
<span class=time>1998/06/28(日) 21:07:19</span><br>
画像呼び出しの場合、ＣＧＩを呼んだのが画像のあるページに<br>
なってしまって、<br>
$ENV{'HTTP_REFERER'}は自分のページになってしまうと思うのですが。<br>
<br>
<hr>
<span class=name>B-Cus</span>
<span class=time>1998/06/28(日) 23:28:20</span><br>
なるほど2個前のページということですね。ならCGIでは不可能で、<br>
SSIを使うしかないでしょう<br>
# JavaScirptは全く知らないのでパス。<br>
<hr>
<span class=name>mm</span>
<span class=time>1998/06/29(月) 01:27:24</span><br>
あれ？<br>
とほほさんのカウンタは、JavaScriptを使ってREFERERを記録する<br>
機能がある筈ですよ。<br>
<a href="../../wwwcount.htm#CounterRefFind" tppabs="http://www.tohoho-web.com/wwwcount.htm#CounterRefFind">http://www.tohoho-web.com/wwwcount.htm#CounterRefFind</a><br>
<hr>
<span class=name>パァルを今日やり始めた人</span>
<span class=email><a href="mailto:mfujita@kz.tsukuba.ac.jp">[E-Mail]</a></span>
<span class=time>1998/06/30(火) 06:37:17</span><br>
<span class=resolv>[[解決]]</span><br>
mmさん、B-Cusさん、ありがとうございました。<br>
とほほさんのページは全部見たと思ってたのに…甘かったです<br>
<br>
早速この%とか+を除去するスクリプトを付け足しておくことにします。<br>
<hr>
<span class=name>パァルを今日やり始めた人</span>
<span class=email><a href="mailto:mfujita@kz.tsukuba.ac.jp">[E-Mail]</a></span>
<span class=time>1998/06/30(火) 07:34:29</span><br>
と、思ったんですが、僕の作ったスクリプトだと、+とか%の入った<br>
URLから飛んできても全然平気でカウンターを出力してるんですけど。<br>
ログもきちんと取ってるし。とほほさんのスクリプトだとどこで+とか<br>
%が引っかかるんでしょうか。（すいません、自分であの長いスクリプトを<br>
調べるほど詳しくないんです）<br>
<hr>
<span class=name>とほほ</span>
<span class=time>1998/06/30(火) 22:13:44</span><br>
私のカウンターの場合、@ARGV を利用しているため、Webサーバー自身<br>
が + を引数デリミタとして解釈してしまいます。QUERY_STRINGを自前<br>
で解釈すれば、+ を + として扱うこともできそうですね。<br>
<hr>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199806/index.htm">[上に]</a>
<a href="98060065.htm" tppabs="http://www.tohoho-web.com/lng/199806/98060065.htm">[前に]</a>
<a href="98060067.htm" tppabs="http://www.tohoho-web.com/lng/199806/98060067.htm">[次に]</a>
</body>
</html>
