<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>改行に正しく扱うには？</title>
<link rel="stylesheet" href="../style.css" tppabs="http://www.tohoho-web.com/lng/style.css">
</head>
<body>
<h3>改行に正しく扱うには？</h3>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199903/index.htm">[上に]</a>
<a href="99030070.htm" tppabs="http://www.tohoho-web.com/lng/199903/99030070.htm">[前に]</a>
<a href="99030072.htm" tppabs="http://www.tohoho-web.com/lng/199903/99030072.htm">[次に]</a>
<hr>
<span class=name>まる</span>
<span class=email><a href="mailto:maruyama@techno-brain.co.jp">[E-Mail]</a></span>
<span class=time>1999/03/12(金) 14:32:42</span><br>
\n(改行)と\rの違いを教えてください。<br>
<br>
テキストやテキストエリアなどに入力されたデータを、<br>
解析して、CSVファイルに出力したり、入力データをメール送信する<br>
CGIをいくつか作ったのですが、いつも改行の処理で悩んでしまいます。<br>
<br>
ちなみにサーバOSはLinuxで、改行はLFです。そのサーバにWindowsで<br>
作成したファイルをアップロードしています。この時当然改行は、CRからLFに変換はしています。<br>
<br>
テキストエリアに改行を含むデータを入力された時の処理に困っています。同じフォーム解析用の関数を利用して改行を削除したりしています。 $value =~ s/\n//g; という具合に改行を削除しています。<br>
これだと、あるHTMLファイルから呼び出した時は改行が削除されるの<br>
ですが、べつのHTMLファイルから呼び出した時は改行が削除されなかったりする場合があります。この時、\nを\rに変えて実行してみると、改行を削除する場合があります。<br>
\nと\rの違いはいったいどこにあるのでしょうか、教えてください。<br>
<br>
また、同一文をメール送信する場合、メーラによってメール本文改行の扱いが違うことがあります。<br>
OutlookやNetScapeを使用した場合と、ユードラを使用した場合、ユードラを使用したほうが改行が余分についてしまいます。<br>
現状では、Outlookの１行の改行が、ユードラでは２行の改行になって<br>
しまいます。<br>
<br>
改行の扱い方にはいつも苦労させられています。<br>
少し、文が説明不足で読みにくい面もあると思いますが、<br>
どなたか改行の扱い方やメタ文字の\nと\rの違いを教えてください。<br>
お願いします。<br>
<hr>
<span class=name>moci</span>
<span class=email><a href="mailto:moci@shift.ne.jp">[E-Mail]</a></span>
<span class=time>1999/03/12(金) 15:20:32</span><br>
まず改行コードですが、Windows系では「CR」だけではなく、<br>
「CR」+「LF」となっています。「CR」だけなのはMacだそうで。<br>
さらにこの「CR」が「\r」であり、コードは0x0D(13)、<br>
「LF」が「\n」でコードが0x0A(10)となっています。<br>
ちなみに「CR」は「キャリッジ・リターン」、「LF」は<br>
「ライン・フィード」で、それぞれ「復帰」「改行」です。<br>
<br>
# 「キャリッジ・リターン」「ライン・フィード」というのは、<br>
# タイプライターの動作を考えてもらえると良いのではないかと。<br>
# ヘッドが左右に動く形式のプリンタでもいいですね。<br>
<br>
改行削除の処理ですが、「$value =~ s/\n//g;」では<br>
「\r」が残ってしまうのではないでしょうか。<br>
<br>
改行数の違いについてはどちらのメーラも使ったことが<br>
ないのですが、たとえば「\n」をわざわざ「\r\n」に<br>
変換してくれるWindows上のソフトがあります。<br>
<br>
ex.Netscape Navigatorで「名前を付けて保存」<br>
<br>
この場合、保存するページがMicrosoft IISのような<br>
Windows上のサーバにあり、改行コードが「\r\n」と<br>
なっていても、その「\n」の部分だけを「\r\n」に変換、<br>
結果として「\r\r\n」となってしまい、最初の「\r」と<br>
次の「\r\n」とで2つの改行とみなすソフトもあります。<br>
あるいは同じことが原因なのかもしれませんね。<br>
<hr>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199903/index.htm">[上に]</a>
<a href="99030070.htm" tppabs="http://www.tohoho-web.com/lng/199903/99030070.htm">[前に]</a>
<a href="99030072.htm" tppabs="http://www.tohoho-web.com/lng/199903/99030072.htm">[次に]</a>
</body>
</html>
