<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>JavaScriptで画像置換えてクリッカブルマップは可能？</title>
<link rel="stylesheet" href="../style.css" tppabs="http://www.tohoho-web.com/lng/style.css">
</head>
<body>
<h3>JavaScriptで画像置換えてクリッカブルマップは可能？</h3>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199811/index.htm">[上に]</a>
<a href="98110068.htm" tppabs="http://www.tohoho-web.com/lng/199811/98110068.htm">[前に]</a>
<a href="98110070.htm" tppabs="http://www.tohoho-web.com/lng/199811/98110070.htm">[次に]</a>
<hr>
<span class=name>やま</span>
<span class=time>1998/11/18(水) 16:08:16</span><br>
現在会社のイントラネット用ページで、<br>
「JavaScriptで複数の画像（地図）を置き換えて、それぞれを<br>
 クリッカブルマップとして使う」という所でつまっています。<br>
ボタンを押すと３枚の地図を自由に置き換えられる所までは行ったのですが・・・<br>
サーバーはNTで、言語はVBscriptです。<br>
ブラウザはIE4.0です。<br>
どなたか、このような状態でクリッカブルマップが可能かどうか<br>
御存知ありませんか？<br>
<hr>
<span class=name>みんこ</span>
<span class=time>1998/11/18(水) 19:05:04</span><br>
クリッカブルマップのリンク範囲指定はみんな同じなんですか？<br>
マップ毎にリンク範囲やリンク先が違うのなら無理かと。<br>
<hr>
<span class=name>やま</span>
<span class=time>1998/11/18(水) 21:23:30</span><br>
はい、リンク範囲やリンク先は全部違うので・・・<br>
DHTMLが使えるかな？と捜してもみましたが、<br>
どうもDHTMLを使うホームページのスクリプトはみな<br>
極端な程複雑なので・・・<br>
私の方でも引き続きいろいろと調べてみます。<br>
なにか情報があれば宜しくお願いします。<br>
<hr>
<span class=name>おぱく堂</span>
<span class=time>1998/11/18(水) 23:50:20</span><br>
マップの違う画像を入れ換えるだけなら、そんなに複雑なDHTMLには<br>
ならないと思いますが、DHTMLだとブラウザ限定になっちゃうし……。<br>
全マップのリンク範囲が同じなら、画像別にリンク先を替えるのは<br>
JavaScriptでできるけど、そのかわり JavaScriptを無効に設定された<br>
場合にクリッカブルマップが機能しなくなっちゃいますね。リンク画像<br>
の違うマップだと、みんこさんの言うとおり無理かも。<br>
<hr>
<span class=name>おぱく堂</span>
<span class=time>1998/11/18(水) 23:52:18</span><br>
↑5行目の「リンク画像」は「リンク範囲」の間違い。ごめんなさい。<br>
<hr>
<span class=name>みんこ</span>
<span class=time>1998/11/19(木) 09:37:43</span><br>
どうしても一枚のウィンドウで画像を開いたまんまで、<br>
それをボタンで切り替えて、<br>
リンク範囲とリンク先の違うクリッカブルマップを<br>
作りたいということでしたら。<br>
<br>
素直にフレーム切って、片方のフレームからもう片方に<br>
マップを呼び出してはいかがでしょうか。<br>
見かけはそんなに変わらないと思いますが。<br>
もしくは、どうしても<br>
一つのファイルしか使いたくないなら<br>
マップ３枚とも表示して、ページ内でリンクとばして<br>
よびだす（..ように見せかける）とか。<br>
<hr>
<span class=name>mo</span>
<span class=email><a href="mailto:mo@goice.co.jp">[E-Mail]</a></span>
<span class=time>1998/11/19(木) 14:41:23</span><br>
&lt;INPUT TYPE=image NAME="..."&gt; ってのを使って、<br>
CGI で処理するっていう方法もあります。<br>
<hr>
<span class=name>おぱく堂</span>
<span class=time>1998/11/19(木) 23:39:16</span><br>
イントラネット用という事は、社内全員が IE4なんですか？<br>
だとしたら、DHTML で画像切替するのが一番楽だと思いますが、その辺<br>
の状況はどうなんでしょう？<br>
<hr>
<span class=name>しなのむし</span>
<span class=time>1998/11/20(金) 06:53:38</span><br>
ボタンをクリックして画像を変えた時に任意の変数に<br>
そのボタンを示す値が入るようにしておいて<br>
mapの各area部分のhrefから呼んだ関数が<br>
「変数の値によって行き先を選ぶ」といったように<br>
条件分岐させてやることは出来ますよね。<br>
こうすれば少なくとも画像ごとに同じ位置を押しても違う場所に<br>
飛ぶように出来るわけですけど<br>
<br>
- 各画像が同サイズの必要があるので小さい画像には余白をつけなくてはならない<br>
- 画像によっては本来クリックすべきでないところもクリック出来てしまう<br>
- 恐らく細かいます目のようなマップにしなくてはならない<br>
<br>
等の制約はやはりありますよね。<br>
<hr>
<span class=name>おぱく堂</span>
<span class=time>1998/11/20(金) 23:10:42</span><br>
&lt;html&gt;&lt;head&gt;<br>
&lt;script language="JavaScript1.2"&gt;&lt;!--<br>
<br>
function dasu(layerName){<br>
&nbsp;&nbsp;&nbsp;&nbsp;document.all(layerName).style.visibility="visible"<br>
}<br>
function kesu(layerName){<br>
&nbsp;&nbsp;&nbsp;&nbsp;document.all(layerName).style.visibility="hidden"<br>
}<br>
<br>
//--&gt;&lt;/script&gt;<br>
&lt;/head&gt;&lt;body&gt;<br>
<br>
&lt;map name="clickablemap1"&gt;<br>
&lt;area (地図画像１用のクリッカブル座標指定)&gt;<br>
&lt;/map&gt;<br>
<br>
&lt;map name="clickablemap2"&gt;<br>
&lt;area (地図画像２用のクリッカブル座標指定)&gt;<br>
&lt;/map&gt;<br>
<br>
&lt;map name="clickablemap3"&gt;<br>
&lt;area (地図画像３用のクリッカブル座標指定)&gt;<br>
&lt;/map&gt;<br>
<br>
&lt;div id="map1" style="position:absolute;left:左座標px;top:上座標px;visibility:visible"&gt;<br>
&lt;img src="地図画像１" usemap="#clickablemap1"&gt;<br>
&lt;/div&gt;<br>
<br>
&lt;div id="map2" style="position:absolute;left:左座標px;top:上座標px;visibility:hidden"&gt;<br>
&lt;img src="地図画像２" usemap="#clickablemap2"&gt;<br>
&lt;/div&gt;<br>
<br>
&lt;div id="map3" style="position:absolute;left:左座標px;top:上座標px;visibility:hidden"&gt;<br>
&lt;img src="地図画像３" usemap="#clickablemap3"&gt;<br>
&lt;/div&gt;<br>
<br>
&lt;div id="button" style="position:absolute;left:ボタン左座標px;top:ボタン上座標px"&gt;<br>
&lt;a href="JavaScript:dasu('map1');kesu('map2');kesu('map3')"&gt;地図１&lt;/a&gt;<br>
&lt;a href="JavaScript:dasu('map2');kesu('map3');kesu('map1')"&gt;地図２&lt;/a&gt;<br>
&lt;a href="JavaScript:dasu('map3');kesu('map1');kesu('map2')"&gt;地図３&lt;/a&gt;<br>
&lt;/div&gt;<br>
<br>
&lt;/body&gt;&lt;/html&gt;<br>
↑IE4専用ならこの DHTML でなんとかなるのでは？<br>
　これにクリックしたボタンの色を変えるスクリプトとかを追加すると<br>
見栄えが良くなるかも。<br>
<hr>
<span class=name>やま</span>
<span class=time>1998/11/25(水) 15:16:57</span><br>
<span class=resolv>[[解決]]</span><br>
出来ました！おぱく堂さん、本当にありがとうございます。<br>
ソースまで書いていただいて、なんとお礼を言ったらいいか・・・<br>
返事が遅れてすみません。実は&lt;MAP&gt;タグの存在を知らず、<br>
クリッカブルマップと言えばCGIかASPでしかできないものだと<br>
それまで思っていたもので、「えっ？！」と思って<br>
しばらくうろうろしていたのです。<br>
ともあれ大解決です。本当にありがとうございました！<br>
<hr>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199811/index.htm">[上に]</a>
<a href="98110068.htm" tppabs="http://www.tohoho-web.com/lng/199811/98110068.htm">[前に]</a>
<a href="98110070.htm" tppabs="http://www.tohoho-web.com/lng/199811/98110070.htm">[次に]</a>
</body>
</html>
