<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>msWEBT[o[[[</title>
<link rel="stylesheet" href="../style.css" tppabs="http://www.tohoho-web.com/lng/style.css">
</head>
<body>
<h3>msWEBT[o[[[</h3>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199709/index.htm">[]</a>
<a href="97092400.htm" tppabs="http://www.tohoho-web.com/lng/199709/97092400.htm">[O]</a>
<a href="97092601.htm" tppabs="http://www.tohoho-web.com/lng/199709/97092601.htm">[]</a>
<hr>
<span class=name>^J</span>
<span class=email><a href="mailto:vg3k-mtd@asahi-net.or.jp">[E-Mail]</a></span>
<span class=time>1997/09/26() 01:20:05</span><br>
ACGIS^JBAWindows NTCGI([[)B<br>
webT[o[NTAunix[MR}h(sendmail)gpB@BASoftware.compostamail()gl[et@C_CNV(&lt;)At@Cnh 0AR}hs{BpostamailLq@mAB<br>
<hr>
<span class=name>YMK</span>
<span class=url><a href="javascript:if(confirm('http://ims.hypernet.co.jp/spec=2fregexp.html  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://ims.hypernet.co.jp/spec=2fregexp.html'" tppabs="http://ims.hypernet.co.jp/~yamato">[HomePage]</a></span>
<span class=time>1997/09/26() 15:24:50</span><br>
[[ A[MAmA<br>
PWEBu[Mvm<br>
fPhc<br>
<br>
 ](T-T)<br>
| A<br>
v SMTPMH<br>
KQl<br>
<br>
#!/user/bin/perl<br>
<br>
#jisjcode.plp<br>
require 'jcode.pl';<br>
<br>
#SMTPT[o[AhX<br>
$SERVER_NAME = 'your.smtp.server.address';<br>
$SERVER_PORT = 25;<br>
$AF_INET = 2;<br>
$SOCK_STREAM = 1;<br>
<br>
#<br>
$pFrom = 'email@address';<br>
$pTo = 'email@address';<br>
$pSubject = "postmaileXg";<br>
<br>
print "Content-type: text/html\n\n";<br>
&amp;myInit();<br>
<br>
if( !$param{'pMsg'} ) {<br>
	print "bZ[W\n";<br>
	exit 0;<br>
}<br>
if( $param{'pFrom'} ) { $pFrom = $param{'pFrom'}; }<br>
if( $param{'pTo'} ) { $pTo = $param{'pTo'}; }<br>
if( $param{'pSubject'} ) { $pSubject = $param{'pSubject'}; }<br>
<br>
&amp;postMail( $pFrom, $pTo, $pSubject, $param{'pMsg'} );<br>
<br>
exit 0;<br>
<br>
#[M<br>
# $from&nbsp;&nbsp;&nbsp;&nbsp;: yourname@pop3adress xXgH<br>
# $to&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: your e-mail adress<br>
# $subject : ^Cg<br>
# $body&nbsp;&nbsp;&nbsp;&nbsp;: [{<br>
sub postMail {<br>
	my( $from, $to, $subject, $body ) = @_;<br>
<br>
	#subject  body jis<br>
	$subject = jcode'jis($subject);<br>
	$body = jcode'jis($body);<br>
<br>
	my ($template, $proto, $local_info, $remote_info, $remote_addr, $flgs);<br>
	my(@headers) = ( "HELO\n", "MAIL From:$from\n", "RCPT To: $to\n", "DATA\n" );<br>
	my(@msgs) = ( "From: $from\n", "To: $to&lt;$to&gt;\n", "Subject: $subject\n",<br>
		"Content-type: text/html; charset=ISO-2022-JP\n", "$body", "\n.\n" );<br>
<br>
	$flgs = 0;<br>
	$template = 'S n a4 x8';<br>
	$proto = getprotobyname('tcp');<br>
	$local_info = gethostbyname('localhost');<br>
	$remote_info = gethostbyname($SERVER_NAME);<br>
	$remote_addr = pack($template, $AF_INET, $SERVER_PORT, $remote_info);<br>
<br>
	while(1) {<br>
		socket(SOCK, $AF_INET, $SOCK_STREAM, $proto);<br>
		connect(SOCK, $remote_addr);<br>
		if( !&amp;sockResult() ) { last; }<br>
		for( @headers ) {<br>
			send(SOCK, $_, 0);<br>
			if( !&amp;sockResult() ) { last; }<br>
		}<br>
		while (@msgs) {<br>
			send(SOCK, shift(@msgs),0);<br>
		}<br>
		send(SOCK, "QUIT\n", 0 );<br>
		if( !&amp;sockResult() ) { last; }<br>
		$flgs = 1;<br>
		last;<br>
	}<br>
	if( $flgs ) { print "\n"; } else { print "\n"; }<br>
	shutdown(SOCK,2);<br>
	close(SOCK);<br>
}<br>
<br>
sub sockResult {<br>
	my($result,$buf);<br>
	recv( SOCK, $buf, 256, 0 );<br>
	print "$buf\n";<br>
	$result = (split(/ /,$buf) ) [0];<br>
	($result &gt;= 200 &amp;&amp; $result &lt; 400 ) ? 1 : 0;<br>
}<br>
<br>
sub myInit {<br>
	jcode'init();<br>
	if( $ENV{'REQUEST_METHOD'} eq 'GET' ) {<br>
		$query_string = $ENV{'QUERY_STRING'};<br>
	} else {<br>
		read( STDIN, $query_string, $ENV{'CONTENT_LENGTH'} );<br>
	}<br>
<br>
	foreach (split('&amp;',$query_string)){<br>
		($variable,$value)=split('=');<br>
		$value=~ tr/+/ /;<br>
		$value=~ s/%([0-9a-fA-F][0-9a-fA-F])/pack("c",hex($1))/eg;<br>
		&amp;jcode'convert(*value,'euc');<br>
		$value=~ s/\r\n/\n/g;<br>
		$value=~ s/\r/\n/g;<br>
		$param{$variable}=$value;<br>
	}<br>
}<br>
<br>
<hr>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199709/index.htm">[]</a>
<a href="97092400.htm" tppabs="http://www.tohoho-web.com/lng/199709/97092400.htm">[O]</a>
<a href="97092601.htm" tppabs="http://www.tohoho-web.com/lng/199709/97092601.htm">[]</a>
</body>
</html>
