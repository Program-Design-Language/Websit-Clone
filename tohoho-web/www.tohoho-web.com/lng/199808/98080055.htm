<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>PerlfYtt@C\t</title>
<link rel="stylesheet" href="../style.css" tppabs="http://www.tohoho-web.com/lng/style.css">
</head>
<body>
<h3>PerlfYtt@C\t</h3>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199808/index.htm">[]</a>
<a href="98080054.htm" tppabs="http://www.tohoho-web.com/lng/199808/98080054.htm">[O]</a>
<a href="98080056.htm" tppabs="http://www.tohoho-web.com/lng/199808/98080056.htm">[]</a>
<hr>
<span class=name>[</span>
<span class=time>1998/08/27() 12:41:37</span><br>
Ytt@Cfo^iAbv[hj@soB<br>
TvvOB<br>
<hr>
<span class=name>]</span>
<span class=time>1998/08/27() 14:47:47</span><br>
emF_B<br>
<br>
1. f[z[y[W<br>
i[it@CAbv[hT[o<br>
jB<br>
2. t@CAbv[hfXNvgp<br>
BFTP\tgpB<br>
3. f^OgB<br>
4. YtAPANA<br>
t@CeAf\B<br>
<br>
1.A^fAlft@CAbv[h<br>
vBZpIvA<br>
B<br>
2.AOviR1.jB<br>
AfufBNgAt@CAbv<br>
fBNgmFB<br>
3.gAvBgvO<br>
iAZLeBCB^Og<br>
jAgvO<br>
TB<br>
4.NA2.fBNgw<br>
Aaimg^ON<br>
vBf\A[[AvO<br>
B<br>
<br>
AA<br>
AvB<br>
<hr>
<span class=name>tetsuya</span>
<span class=time>1998/08/28() 00:57:43</span><br>
@vHf<br>
@PerlAfvA<br>
@t@CuvH<br>
<br>
@ObiB<br>
<br>
@uIMG^OtvPo<br>
@B<br>
@zgt@CAbv[hA<br>
@vuEUt@CAbvvB<br>
@uHTMLt@XvEEE<br>
@<a href="../../html/form.htm" tppabs="http://www.tohoho-web.com/html/form.htm">http://www.tohoho-web.com/html/form.htm</a><br>
@{IgA<br>
@~\uENCTYPE="multipart/form-data"vA<br>
@t@Cg@B<br>
<br>
@uHTMLt@XvTvEEwwwupl.cgi<br>
@gvB<br>
@ucgi--lib.plvQlA<br>
@ut@CiFormf[^jov<br>
@oB<br>
@t@Cmime^CvA<br>
@vOuPB<br>
<br>
AXCuEEo<br>
<br>
@umultipartcgi-lib.plv<br>
@AB<br>
<hr>
<span class=name>[</span>
<span class=time>1998/08/28() 09:55:43</span><br>
[Aet\B<br>
fAiojB<br>
fuEUt@CAbvB<br>
tetsuyaQlBBBo<br>
uENCTYPE="multipart/form-data"vA<br>
t@Cg@B<br>
Ytt@CAbv[hB<br>
<br>
AC_tetsuya ucgi--lib.plv<br>
HHQlB<br>
<hr>
<span class=name>tetsuya</span>
<span class=time>1998/08/29(y) 00:19:25</span><br>
@[cgi-lib.plAperl4ycgipCuB<br>
@5VFXA<br>
@gi<br>
<br>
@CuAB<br>
@<a href="javascript:if(confirm('http://www.bekkoame.or.jp/~syunji/perl/yuki14.gif  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://www.bekkoame.or.jp/~syunji/perl/yuki14.gif'" tppabs="http://www.bekkoame.or.jp/~syunji/perl/cgi_sam1.html">http://www.bekkoame.or.jp/~syunji/perl/cgi_sam1.html</a><br>
<br>
@{Igp@<br>
@require 'cgi-lib.pl';<br>
@&amp;ReadParse(*opts);<br>
<br>
@AoptsnbVtH[f[^i[B<br>
@L[tH[LqeuNAMEvB<br>
<br>
<br>
@mB<br>
@prsKACB<br>
@CA<br>
@NvB<br>
@gp@B<br>
<br>
#!/usr/bin/perl -- -*- C -*-<br>
sub ReadData {<br>
&nbsp;&nbsp;&nbsp;&nbsp;($ENV{'REQUEST_METHOD'} eq "POST") || return "error";<br>
&nbsp;&nbsp;&nbsp;&nbsp;local (*in) = @_ if @_;<br>
&nbsp;&nbsp;&nbsp;&nbsp;local ($s,$i,$key,$val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;while(&lt;STDIN&gt;){<br>
	if (/(-+[0-9]+).*/) {<br>
	&nbsp;&nbsp;&nbsp;&nbsp;$s = $1;<br>
	&nbsp;&nbsp;&nbsp;&nbsp;last;<br>
	}<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;while ($i&nbsp;&nbsp;= &lt;STDIN&gt;){<br>
	$i =~ /.*; name="(.*?)"/;<br>
	$key = $1;<br>
	if ($i =~ /.*filename="(.*?)"/){<br>
	&nbsp;&nbsp;&nbsp;&nbsp;$i = &lt;STDIN&gt;;<br>
	&nbsp;&nbsp;&nbsp;&nbsp;$i =~ /Content-Type: (.*)\015$/;<br>
	&nbsp;&nbsp;&nbsp;&nbsp;$in{$key."_TYPE"} = $1;<br>
	}<br>
	&lt;STDIN&gt;;<br>
	while($i = &lt;STDIN&gt;){<br>
	&nbsp;&nbsp;&nbsp;&nbsp;( $i =~ /$s.*/ ) &amp;&amp; last;<br>
	&nbsp;&nbsp;&nbsp;&nbsp;$in{$key} .=$i;<br>
	}<br>
	chop($in{$key});<br>
	chop($in{$key});<br>
	($i =~ /$s--.*/) &amp;&amp; return length($in);<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;return length($in);<br>
}<br>
1; #return true<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
@<br>
<hr>
<span class=name>X</span>
<span class=email><a href="mailto:slakichi@cds.ne.jp">[E-Mail]</a></span>
<span class=time>1998/08/29(y) 00:41:27</span><br>
fB<br>
<br>
sub read_formdata<br>
@@{<br>
@@local(@record,$buffer,$card);<br>
@@local($title,$data);<br>
@@undef(%formdata);<br>
@@if($ENV{'REQUEST_METHOD'} eq "POST")<br>
@@@@{<br>
@@@@read(STDIN,$buffer,$ENV{'CONTENT_LENGTH'});<br>
@@@@$formdata_method_post=1;<br>
@@@@}<br>
@@else<br>
@@@@{<br>
@@@@$buffer=$ENV{'QUERY_STRING'};<br>
@@@@$formdata_method_post=0;<br>
@@@@}<br>
@@if($formdata_method_post==1 &amp;&amp; substr($ENV{'CONTENT_TYPE'},0,30) eq "multipart/form-data; boundary=")<br>
@@@@{<br>
@@@@if(read_formdata2($buffer)==1)<br>
@@@@@@{<br>
@@@@@@return;<br>
@@@@@@}<br>
@@@@}<br>
@@@record=split(/&amp;/,$buffer);<br>
@@foreach $card(@record)<br>
@@@@{<br>
@@@@($title,$data)=split(/=/,$card);<br>
@@@@$data=~ tr/+/ /;<br>
@@@@$data=~ s/%([a-fA-F0-9][a-fA-F0-9])/pack("C",hex($1))/eg;<br>
@@@@$formdata{$title}=$data;<br>
@@@@}<br>
@@}<br>
<br>
sub read_formdata2<br>
@@{<br>
@@local($buffer)=$_[0];<br>
@@local($splitter,@lines);<br>
@@local($data,$i,$title,$mode);<br>
@@$splitter="--".substr($ENV{'CONTENT_TYPE'},30);<br>
@@$buffer=~ s/\r\n\n/\n/g;<br>
@@$buffer=~ s/\r\n/\n/g;<br>
@@$buffer=~ s/\r/\n/g;<br>
@@@lines=split(/\n/,$buffer);<br>
@@if($lines[0] ne $splitter &amp;&amp; $lines[0] ne $splitter."--")<br>
@@@@{<br>
@@@@return 0;<br>
@@@@}<br>
@@$mode=0;<br>
@@$data="";<br>
@@$title="";<br>
@@for($i=0;$i&lt;scalar(@lines);$i++)<br>
@@@@{<br>
@@@@if($splitter eq $lines[$i])<br>
@@@@@@{<br>
@@@@@@if($mode==2 &amp;&amp; $title ne "")<br>
@@@@@@@@{<br>
@@@@@@@@chop($data);<br>
@@@@@@@@$formdata{$title}=$data;<br>
@@@@@@@@}<br>
@@@@@@$mode=1;<br>
@@@@@@$title="";<br>
@@@@@@$data="";<br>
@@@@@@}<br>
@@@@elsif($splitter."--" eq $lines[$i])<br>
@@@@@@{<br>
@@@@@@if($mode==2 &amp;&amp; $title ne "")<br>
@@@@@@@@{<br>
@@@@@@@@chop($data);<br>
@@@@@@@@$formdata{$title}=$data;<br>
@@@@@@@@}<br>
@@@@@@return 1;<br>
@@@@@@}<br>
@@@@elsif($mode==2)<br>
@@@@@@{<br>
@@@@@@$data.=$lines[$i]."\n";<br>
@@@@@@}<br>
@@@@elsif($lines[$i] =~ /^Content\-Disposition: form\-data; name=\"([^\"]*)\".*/ &amp;&amp; $mode==1)<br>
@@@@@@{<br>
@@@@@@$title=$1;<br>
@@@@@@}<br>
@@@@elsif($lines[$i] eq "" &amp;&amp; $mode==1)<br>
@@@@@@{<br>
@@@@@@$mode=2;<br>
@@@@@@}<br>
@@@@}<br>
@@return 1;<br>
@@}<br>
<br>
ACGIN<br>
read_formdata();<br>
<br>
%formdata<br>
Si[...B<br>
<hr>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199808/index.htm">[]</a>
<a href="98080054.htm" tppabs="http://www.tohoho-web.com/lng/199808/98080054.htm">[O]</a>
<a href="98080056.htm" tppabs="http://www.tohoho-web.com/lng/199808/98080056.htm">[]</a>
</body>
</html>
