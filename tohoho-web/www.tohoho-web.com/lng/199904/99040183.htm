<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>JavaScript：IE4.0以降で日本語を扱うには？</title>
<link rel="stylesheet" href="../style.css" tppabs="http://www.tohoho-web.com/lng/style.css">
</head>
<body>
<h3>JavaScript：IE4.0以降で日本語を扱うには？</h3>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199904/index.htm">[上に]</a>
<a href="99040182.htm" tppabs="http://www.tohoho-web.com/lng/199904/99040182.htm">[前に]</a>
<a href="99040184.htm" tppabs="http://www.tohoho-web.com/lng/199904/99040184.htm">[次に]</a>
<hr>
<span class=name>綾瀬</span>
<span class=time>1999/04/26(月) 08:24:54</span><br>
HTML本文中の一定の項目を、プロンプトを出してそこで入力された項目に置換して書き出す<br>
スクリプトを組んだんですが、NCでは完璧に動作するもののIEではからきしダメです。<br>
IEではそういった形では日本語は扱えないんでしょうか？<br>
<br>
ソースはこんな感じです。<br>
<br>
・HEADタグ内の記述<br>
&lt;SCRIPT LANGUAGE="JavaScript"&gt;<br>
var Name = prompt ("名前を入れてください。","");<br>
if ((Name == "") || (Name == null)) { Name = "誰かさん"; }<br>
&lt;/SCRIPT&gt;<br>
<br>
・本文中の記述<br>
&lt;SCRIPT LANGUAGE=JavaScript&gt;document.write ("&lt;&lt;ここから本文。本文中、" + Name + "<br>
がすべて入力ボックスで入力した値に変換される…はずだったのですがIEでは<br>
全然ダメでした（苦笑）&gt;&gt;");<br>
&lt;/SCRIPT&gt;<br>
<br>
という感じだったのです。<br>
<hr>
<span class=name>無責任官庁</span>
<span class=time>1999/04/26(月) 09:20:58</span><br>
ちょっとテストしてみました。<br>
↓これね。<br>
<br>
&lt;html&gt;&lt;head&gt;&lt;title&gt;test&lt;/title&gt;<br>
&lt;SCRIPT LANGUAGE="JavaScript"&gt;<br>
var Name = prompt ("名前を入れてください。","");<br>
if ((Name == "") || (Name == null)) { Name = "誰かさん"; }<br>
&lt;/SCRIPT&gt;<br>
&lt;/head&gt;<br>
&lt;body&gt;<br>
&lt;SCRIPT LANGUAGE="JavaScript"&gt;<br>
document.write ("&lt;&lt;ここから本文。本文中、"<br>
 + Name<br>
 + "がすべて入力ボックスで入力した値に変換される&gt;&gt;");<br>
&lt;/SCRIPT&gt;<br>
&lt;/body&gt;&lt;/html&gt;<br>
<br>
Win+IE5ですけど、このテストでは問題なく動きます。<br>
”ダメ”にも色々あるので、どんな風にダメなのか書いていただけると、<br>
分かるかもしれません・・・<br>
（・・・というエラーが、とか、何も表示しない、とか）<br>
<hr>
<span class=name>たこすけ</span>
<span class=time>1999/04/26(月) 09:46:18</span><br>
Name 以降が出力されない場合がありますね（Win98+IE4）<br>
document.write()中の + を , に置き換えたら<br>
うまくいきました。<br>
<hr>
<span class=name>綾瀬</span>
<span class=time>1999/04/26(月) 14:09:57</span><br>
無責任官庁さん、たこすけさん、早速のresありがとうございました。<br>
（嬉しい驚きでした）<br>
<br>
どんな風にダメなのか＞<br>
1度目のName変換を行った以降の処理が行われず、表示されないんです。<br>
（環境はWin98+IE4.01＆NC4.5）<br>
<br>
ところでたこすけさんのご指摘の通りの処理をしたら、IEで表示されました。<br>
しかし今度は、同じものがNCver4.5で何も表示されなくなってしまうという結果になっています。<br>
どちらのブラウザーでも問題無く表示する方法はないものなのでしょうか？？<br>
<hr>
<span class=name>綾瀬</span>
<span class=time>1999/04/26(月) 14:57:49</span><br>
上の発言なのですが、ごめんなさい、キャッシュを捨てたらきちんとできました。<br>
無責任官庁さん、たこすけさん、ど素人のくだらない疑問にお答え下さいまして<br>
本当にありがとうございました！！<br>
<br>
…で、ご迷惑おかけついでにお伺いできれば幸いなのですが、<br>
+ を , にすることでどちらのブラウザーでも読めるようになるというのはどうしてなのでしょう？<br>
ご教授いただければ幸甚です。<br>
<hr>
<span class=name>たこすけ</span>
<span class=time>1999/04/27(火) 16:58:52</span><br>
どうしてなんでしょ？<br>
分からないです。<br>
<br>
お役に立てなくてごめんなさい。<br>
<hr>
<a href="index.htm" tppabs="http://www.tohoho-web.com/lng/199904/index.htm">[上に]</a>
<a href="99040182.htm" tppabs="http://www.tohoho-web.com/lng/199904/99040182.htm">[前に]</a>
<a href="99040184.htm" tppabs="http://www.tohoho-web.com/lng/199904/99040184.htm">[次に]</a>
</body>
</html>
