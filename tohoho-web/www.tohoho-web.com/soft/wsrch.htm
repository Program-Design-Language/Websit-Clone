<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>WwwSearch Ver3.15利用メモ - とほほのWWW入門</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<link rel="stylesheet" href="../style3.css" tppabs="http://www.tohoho-web.com/style3.css">
</head>
<body>
<h2>WwwSearch Ver3.15利用メモ</h2>

<h4>目次</h4>
<div class=i>
<ul>
<li><a href="#WhatIs">WwwSearchとは？</a>
<li><a href="#Files">同梱ファイル</a>
<li><a href="#Caution">注意事項</a>
<li><a href="#History">更新履歴</a>
<li><a href="#Howto">設置方法</a>
<li><a href="#Replace">検索結果のアドレスが異なる場合の対処</a>
<li><a href="#OtherServer">他サーバーのファイルを検索するには？</a>
</ul>
</div>

<h4 id="WhatIs">WwwSearchとは？</h4>
<div class=i>
<p>WwwSearch は、Webサーバー上のファイルから、特定の文字を含むファイルを検索する機能をもった CGI スクリプトです。フリーソフトとして配布しています。商用・使用を問わず、利用・改造・流用・再配布はご自由にどうぞ。</p>
</div>

<h4 id="Files">同梱ファイル</h4>
<div class=i>
<ul>
<li>readme.htm - このファイル。
<li>wwwsrch.cgi - CGIスクリプトファイル。
<li>wwwsrch.log - ログファイルテンプレート。
<li>wwwsrch.htm - 設置サンプル。
<li>jcode.pl - 漢字コード変換ライブラリ。（By Utashiro氏）
</ul>
<p>jcode.pl は、Utashiro 氏が開発、配布されている漢字コード変換ライブラリです。Utashiro 氏に感謝いたします。</p>
</div>

<h4 id="Caution">注意事項</h4>
<div class=i>
<ol>
<li><p>あらかじめ検索用のインデックスを作成しておくタイプではなく、検索の都度、全文を検索するタイプですので、設置は簡単ですが、Webサーバーには多大な負荷をかけてしまいます。多量のファイルを対象に検索を行う場合は、Namazu などのインデックス作成型検索エンジンのご利用をオススメします。</p>
<ul>
<li><a href="javascript:if(confirm('http://www.kusastro.kyoto-u.ac.jp/~baba/wais/===a.type?!1:!0}).map(function(a){if(  \n\nļ޷ Teleport Ultra , Ϊ һ·ⲿΪʼַĵַ  \n\nڷϴ?'))window.location='http://www.kusastro.kyoto-u.ac.jp/~baba/wais/===a.type?!1:!0}).map(function(a){if('" tppabs="http://www.kusastro.kyoto-u.ac.jp/~baba/wais/other-system.html">日本語全文検索エンジンソフトウェアのリスト</a></li>
</ul>
<br>
</li>
<li><p>検索対象ファイルは、同じWebサーバー上にあるもののみとなります。他のサーバーにあるファイルを検索することはできません。どうしても検索したい場合は、後述の説明を参照してください。</p></li>
<li><p>速度向上やサーバー負荷低減のため、あまり厳密な検索を行っていません。たまに、誤った語句が検索されたり、検索されなかったり、検索結果が文字化けすることもありますので、ご了承ください。</p></li>
<li><p>検索結果には、ヒットしたファイルのタイトル、ファイル名、最初にヒットした部分の数行が表示されます。ヒットしたすべての行が表示されるわけではありません。</p></li>
<li><p>&lt;title&gt;～&lt;/title&gt;は1行で記述してください。</p></li>
<li><p>検索対象とできるのは、.htm や .txt などのテキストファイル（Windowsのメモ帳などで編集できる形式）のみです。Excel や Word のファイルを検索することはできません。</p></li>
</ol>
</div>

<h4 id="History">更新履歴</h4>
<div class=i>
<ul>
<li>Ver3.15 - Ver3.14のバグ修正。(2004.8.8)
<li>Ver3.14 - 複数語指定時、すべてを太字で表示する。(2004.6.20)
<li>Ver3.13 - 検索用語に " を含む場合に対処。（2002.3.24）
<li>Ver3.12 - デザインの変更など。（2001.12.2）
<li>Ver3.11 - SSIをサポートするサーバーにおけるセキュリティホールに対応。また、ロギングファイル名を変更可能に。（2001.11.25）
<li>Ver3.10 - スクリプトの漢字コードと検索ファイルの漢字コードが異なると検索ができないバグ修正。（2001.9.23）
<li>Ver3.09 - 検索の高速化やバグ修正など。（2001.5.9）
<li>Ver3.08 - サイト移転に伴う説明などの修正。
<li>Ver3.07 - @ARGVで引数を受け取れないサーバーに対応。
<li>Ver3.06 - 複数の全角スペースがあるときの不具合を修正。
<li>Ver3.05 - Ver3.04修正時の不具合を修正。
<li>Ver3.04 - perl4で、ファイルの検索が途中で終わってしまうことがあるという問題に対応。
<li>Ver3.03 - $how_many_linesの指定が無視されるというバグを修正。
<li>Ver3.02 - 検索結果のタイトルが文字化けすることがあるというバグを修正。検索結果が太字にならないことがあるというバグを修正。Macintosh形式の改行コードの場合に検索結果が全文になるというバグを修正。
<li>Ver3.01 - perlのバージョンにより、検索結果が文字化けすることがあるというバグを修正。
<li>Ver3.00 - 「ブラウブ」が「ブラウザ」にマッチしてしまうというバグに対処。その代わり若干処理速度に影響有り。JISコードの検索対象ファイルにも対応。
</ul>
</div>

<h4 id="Howto">設置方法</h4>
<div class=i>
<ol>
<li><p>CGIの設置経験の無い方は、まず、「<a href="../wwwcgi.htm" tppabs="http://www.tohoho-web.com/wwwcgi.htm">とほほのCGI入門</a>」などを参考に、簡単なCGIの設置練習を行ってください。</p></li>
<li><p>wwwsrch.cgi を、メモ帳などのテキストエディタで開き、★ 印の項目を説明に従って変更してください。</p>
<li><p>下記のファイルをサーバーに転送してください。この時、それぞれのファイルの改行コードが、サーバーに適したものになるようにしてください。サーバーがUNIXの場合はパーミッションも変更してください。</p>
<table class="tb1">
<tr><th>ファイル</th><th>パーミッション</th></tr>
<tr><td>wwwsrch.cgi</td><td>755（rwxr-xr-x）</td></tr>
<tr><td>wwwsrch.log</td><td>666（rw-rw-rw-）</td></tr>
<tr><td>jcode.pl</td><td>変更不要</td></tr>
</table>
<br>
<ul>
<li>参考：「<a href="../wwwxx011.htm" tppabs="http://www.tohoho-web.com/wwwxx011.htm">改行コードについて</a>」
<li>参考：「<a href="../wwwxx012.htm" tppabs="http://www.tohoho-web.com/wwwxx012.htm">パーミッションを変更するには</a>」
</ul>
<br>
<li><p>検索窓を貼り付けたいページに、以下の記述を追加してください。wwwsrch.cgi の部分は、wwwsrch.cgi を設置したフォルダに合わせて適切に変更してください。例えば、cgi-bin の下に設置した場合は cgi-bin/wwwsrch.cgi となります。</p>
<pre class=c>
&lt;form method="POST" action="wwwsrch.cgi"&gt;
&lt;input type="text" name="WORD"&gt;
&lt;input type="radio" name="ANDOR" value="and" checked&gt;AND
&lt;input type="radio" name="ANDOR" value="or"&gt;OR
&lt;input type="submit" value="検索"&gt;
&lt;/form&gt;
</pre>
<p>もしくは単に、wwwsrch.cgi へのリンクを追記してください。</p>
<pre class=c>
&lt;a href="wwwsrch.cgi"&gt;このサイトを検索&lt;/a&gt;
</pre>
</ol>
</div>

<h4 id="Replace">検索結果のアドレスが異なる場合の対処</h4>
<div class=i>
<p>検索結果のジャンプ先のアドレス（URL）が、期待したものと異なる場合、例えば、http://xx.yy.zz/aa/bb/index.htm へのリンクになって欲しいのに、../cc/dd/index.htm へのリンクになってしまう場合は、wwwsrch.cgi の382行目あたりの</p>
<pre class=c>
# $target =~ s|○○|△△|;
</pre>
<p>という行を次のように変更してください。</p>
<pre class=c>
$target =~ s|../cc/dd|http://xx.yy.zz/aa/bb|;
</pre>
<p>ここで、「$target =~ s|文字列A|文字列B|;」は、「文字列A」を「文字列B」に置換することを意味します。</p>
<p>置換は、リンクにマウスを乗せたときにステータスバーに表示されるものではなく、必ず、HTMLソースの、「&lt;a href="○○"&gt;」の ○○ の部分に対して行ってください。</p>
</div>

<h4 id="OtherServer">他サーバーのファイルを検索するには？</h4>
<div class=i>
<p>$target_dir に http://～ で始まるアドレスを指定しても、他サーバーのファイルを検索することはできません。どうしても検索した場合は、CGIを設置するサーバーに検索したいドキュメントファイルのコピーを置き、これをCGIサーバーで検索し、上記のアドレス置換を用いてサーバー名を置換して表示するようにしてください。</p>
</div>

<hr>
<div>Copyright (C) 1996-2004 杜甫々</div>
<div>初版：1997年9月28日、最終更新：2004年8月8日</div>
<div>http://www.tohoho-web.com/soft/wsrch.htm</div>
</body>
</html>
