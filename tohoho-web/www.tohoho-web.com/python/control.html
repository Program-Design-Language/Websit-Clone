<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>とほほのPython入門 - 制御構文 - とほほのWWW入門</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<link rel="stylesheet" href="../style3.css" tppabs="http://www.tohoho-web.com/style3.css">
</head>
<body>
<h2>とほほのPython入門 - 制御構文</h2>
<a href="../www.htm" tppabs="http://www.tohoho-web.com/www.htm">トップ</a> &gt;
<a href="index.html" tppabs="http://www.tohoho-web.com/python/index.html">Python入門</a> &gt;
制御構文

<h4 id="if">もし～ならば(if, else, elsif)</h4>
<div class=i>
<div class="title-tab">文法</div>
<pre class=c2>
<b>if</b> <i>expression</i><b>:</b>
    <i>suite</i>...
[<b>elif</b> <i>expr</i><b>:</b>
    <i>suite</i>...]
[<b>else:</b>
    <i>suite</i>...]
</pre>
<p><b>if</b> は「もし」を意味します。式が真であれば、インデントされたブロックを実行します。下記の例では、num の値が 10より大きければ BIG を3回表示します。</p>
<div class="tab">Python</div>
<pre class=c2>
<em>if</em> num &gt; 10<em>:</em>
    print "BIG"
    print "BIG"
    print "BIG"
</pre>
<p><b>else</b> は「さもなくば」を意味します。下記の例では、num が 10より大きければ BIG を、さもなくば SMALL を表示します。</p>
<div class="tab">Python</div>
<pre class=c2>
<em>if</em> num &gt; 10<em>:</em>
    print "BIG"
<em>else:</em>
    print "SMALL"
</pre>
<p><b>elif</b> は「さもなくばもし」を意味します。下記の例では、num が 10より大きければ BIG を、10と等しければ NORMAL を、さもなくば SMALL を表示します。</p>
<div class="tab">Python</div>
<pre class=c2>
<em>if</em> num &gt; 10<em>:</em>
    print "BIG"
<em>elif</em> num == 10<em>:</em>
    print "NORMAL"
<em>else:</em>
    print "SMALL"
</pre>
<p>if文では、False、数値の 0 や 0.0、空文字("")、空リスト([])、空タプル(())、空辞書({})などを偽とみなし、それ以外を真とみなします。</p>
</div>

<h4 id="while">～のあいだ(while, else)</h4>
<div class=i>
<div class="title-tab">文法</div>
<pre class=c2>
<b>while</b> <i>expression</i><b>:</b>
    <i>suite</i>...
[<b>else:</b>
    <i>suite</i>...]
</pre>
<p><b>while</b> は「～のあいだ」を意味します。下記の例では、i の値が 10よりも小さい間 i の値を表示します。</p>
<div class="tab">Python</div>
<pre class=c2>
n = 0
<em>while</em> n &lt; 10<em>:</em>
    print n
    n += 1
</pre>
<p><b>else</b> がある場合は、ループの最後に else節を実行します。</p>
<div class="tab">Python</div>
<pre class=c2>
n = 0
<em>while</em> n &lt; 10<em>:</em>
    print n
    n += 1
<em>else:</em>
    print 'END'
</pre>
</div>

<h4 id="for">～のあいだ(for, in)</h4>
<div class=i>
<div class="title-tab">文法</div>
<pre class=c2>
<b>for</b> <i>var</i> <b>in</b> <i>expression</i><b>:</b>
    <i>suite</i>...
[<b>else:</b>
    <i>suite</i>...]
</pre>
<p><b>for</b> はリスト、タプルの各要素、辞書のキー、文字列の各文字、ファイルの各行などに対して処理を繰り返します。</p>
<div class="tab">Python</div>
<pre class=c2>
<em>for</em> n <em>in</em> [1, 2, 3]<em>:</em>
    print n                  #=&gt; 1, 2, 3
<em>for</em> n <em>in</em> (1, 2, 3)<em>:</em>
    print n                  #=&gt; 1, 2, 3
<em>for</em> k <em>in</em> {'one': 1, 'two': 2, 'three': 3}<em>:</em>
    print k                  #=&gt; one, two, three
<em>for</em> c <em>in</em> "123"<em>:</em>
    print c                  #=&gt; 1, 2, 3
<em>for</em> line <em>in</em> open("sample.txt")<em>:</em>
    print line               # 1行ずつ表示
</pre>
<p>処理を10回繰り返したい場合は <b>range()</b> を用います。</p>
<div class="tab">Python</div>
<pre class=c2>
for n in <em>range(10)</em>:
    print n
</pre>
<p>文字列に指定した場合は、それぞれの文字に対して実行します。</p>
<div class="tab">Python</div>
<pre class=c2>
<em>for</em> c <em>in</em> u'あいうえお'<em>:</em>
    print c                  # あ, い, う, え, お
</pre>
<p><b>else</b> がある場合は、ループの最後に else節を実行します。</p>
<div class="tab">Python</div>
<pre class=c2>
for n in [1, 2, 3]:
    print n
<em>else:</em>
    print 'END'
</pre>
</div>

<h4 id="break">ループを抜ける(break)</h4>
<div class=i>
<p><b>break</b> は最も内側の while, for などのループ処理を抜けます。下記の例では n が 5の時に forループを抜けます。</p>
<div class="tab">Python</div>
<pre class=c2>
for n in range(10):
    if n == 5:
        <em>break</em>
    print n                  # 0, 1, 2, 3, 4
</pre>
</div>

<h4 id="continue">ループを繰り返す(continue)</h4>
<div class=i>
<p><b>continue</b> は最も内側の while, for などのループ処理を繰り返します。下記の例では n が 5の時に forループの先頭に戻ります。</p>
<div class="tab">Python</div>
<pre class=c2>
for n in range(10):
    if n == 5:
        <em>continue</em>
    print n                  # 0, 1, 2, 3, 4, 6, 7, 8, 9
</pre>
</div>

<h4 id="try">例外処理(try, except, else, finally, raise)</h4>
<div class=i>
<div class="title-tab">文法</div>
<pre class=c2>
<b>try:</b>
    <i>suite...</i>
[<b>except</b> [<i>expression</i>]<b>:</b>
    <i>suite...</i>]
[<b>else:</b>
    <i>suite...</i>]
[<b>finally:</b>
    <i>suite...</i>]
</pre>
<p><b>try</b>, <b>except</b>, <b>else</b>, <b>finally</b> は例外を扱います。</p>
<div class="tab">Python</div>
<pre class=c2>
str = 'ABC'
<em>try:</em>
    c = str[5]                    # 5番目の文字が無いので、IndexError例外が発生します
<em>except</em> IOError<em>:</em>
    print 'IOError'               # IOError例外の場合、このブロックが実行されます
<em>except</em> IndexError<em>:</em>
    print 'IndexError'            # IndexError例外の場合、このブロックが実行されます
<em>except:</em>
    print 'Unknown'               # 上記以外の例外の場合、このブロックが実行されます
<em>else:</em>
    print 'Other'                 # 例外が発生しなかった場合、このブロックが実行されます
<em>finally:</em>
    print 'Finally'               # 常に、このブロックが実行されます
</pre>
<p><b>raise</b> は例外を発生させます。下記の例は、直近に発生した例外を再発生させます。例外が発生していない場合は TypeError例外を発生させます。</p>
<div class="tab">Python</div>
<pre class=c2>
try:
    ...
except:
    <em>raise</em>
</pre>
<p>下記の例は、SystemErrorクラスのインスタンスを生成し、これを引数に例外を発生させます。</p>
<div class="tab">Python</div>
<pre class=c2>
try:
    <em>raise SystemError('Error message')</em>
except SystemError as e:
    print "SystemError"
    print e
</pre>
<p>下記の例は、'Error message' を引数に SystemError のコンストラクタを呼び出し、生成したインスタンスを引数に例外を発生させます。</p>
<div class="tab">Python</div>
<pre class=c2>
try:
    <em>raise SystemError, 'Error message'</em>
except SystemError as e:
    print "SystemError"
    print e
</pre>
<p>下記の例では自作した例外に引数を与え、生成したインスタンスを引数に例外を発生させています。</p>
<div class="tab">Python</div>
<pre class=c2>
class MyError(Exception):
    def __init__(self, file, lineno):
        self.file = file
        self.lineno = lineno

try:
    <em>raise MyError("test.txt", 1163)</em>
except MyError as e:
    print "MyError"
    print e.file
    print e.lineno
</pre>
<p>例外処理の中で例外を発生させるには、次のパターンがあります。</p>
<div class="tab">Python</div>
<pre class=c2>
<span class="cm"># 元の例外をそのまま投げる</span>
excent Exception as e:
    <em>raise e</em>

<span class="cm"># 新たな例外を生成して投げる</span>
excent Exception:
    <em>raise MyError()</em>

<span class="cm"># 元の例外情報をつけて、新たな例外を投げる</span>
excent Exception as e:
    <em>raise MyError() from e</em>

<span class="cm"># 元の例外を無視して、新たな例外を投げる</span>
excent Exception:
    <em>raise MyError() from None</em>
</pre>
</div>

<h4 id="with">with構文(with)</h4>
<div class=i>
<div class="title-tab">文法</div>
<pre class=c2>
<b>with</b> <i>expression</i> [<b>as</b> <i>target</i>] [, <i>expression</i> [<b>as</b> <i>target</i>]]... <b>:</b>
    <i>suite...</i>
</pre>
<p><b>with</b> を用いると、withブロックが終了した際に、オブジェクトの終了処理が自動的に呼ばれます。例えば、open() で返却される file オブジェクトは、終了処理として、close() が自動的に呼び出されます。下記の例で、with を用いた書き方では、withブロックが終了した際に f.close() が自動的に呼び出されます。</p>
<div class="tab">Python</div>
<pre class=c2>
# withを用いない書き方
f = open("test.txt")
print f.read()
f.close()

# withを用いた書き方1
<em>with</em> open("test.txt") <em>as</em> f<em>:</em>
    print f.read()

# withを用いた書き方2
f = open("test.txt")
<em>with</em> f<em>:</em>
    print f.read()
</pre>
</div>

<h4 id="assert">アサーション文(assert)</h4>
<div class=i>
<p><b>assert</b> はテストの際に値が期待通りに設定されているかを確認するための仕組みです。__debug__ が True の時のみ動作し、式を評価して偽であれば、AssertionError例外を発生させます。python を -O オプション付きで起動することで、__debug__ の値は False になります。</p>
<div class="tab">Python</div>
<pre class=c2>
f = func()
<em>assert f == 5</em>              # f の値が期待通り 5になっていることを確認する
</pre>
<p>assert <i>expression</i> は、下記と等価です。</p>
<div class="tab">Python</div>
<pre class=c2>
if __debug__:
    if not <i>expression</i>: raise AssertionError
</pre>
<p>assert <i>expression1</i>, <i>expression2</i> は、下記と等価です。</p>
<div class="tab">Python</div>
<pre class=c2>
if __debug__:
    if not <i>expression1</i>: raise AssertionError(<i>expression2</i>)
</pre>
</div>

<h4 id="pass">パス文(pass)</h4>
<div class=i>
<p><b>pass</b> は何もしない文です。中身の無い関数やクラスを作成する際に使用されます。</p>
<div class="tab">Python</div>
<pre class=c2>
def myfunc():
    <em>pass</em>

class MyClass:
    <em>pass</em>
</pre>
</div>

<h4 id="del">デリート文(del)</h4>
<div class=i>
<p><b>del</b> はオブジェクトを削除します。</p>
<div class="tab">Python</div>
<pre class=c2>
x = 5
y = [1, 2, 3]
z = MyClass()
<em>del x, y, z</em>
</pre>
</div>

<h4 id="print">print文(print)</h4>
<div class=i>
<p><b>print</b> は変数やオブジェクトを標準出力に出力します。Python 3 では実装が変わっているので、ここでは、Python 2 の print文について説明します。</p>
<div class="tab">Python</div>
<pre class=c2>
<em>print 3</em>                    #=&gt; 3
<em>print [1, 2, 3]</em>            #=&gt; [1, 2, 3]
<em>print (1, 2, 3)</em>            #=&gt; (1, 2, 3)
<em>print {'k1':10, 'k2':20}</em>   #=&gt; {'k2': 20, 'k1': 10}
</pre>
<p>引数をカンマ(,)で複数指定すると、ひとつのスペースで区切って複数の値を表示します。</p>
<div class="tab">Python</div>
<pre class=c2>
print "AAA"<em>,</em> "BBB"          #=&gt; AAA BBB
</pre>
<p>通常は、最後に改行(\n)を書き出します。最後の引数の後ろにカンマ(,)をつけると、改行しません。</p>
<div class="tab">Python</div>
<pre class=c2>
<em>print "AAA",</em>                # 改行しない
print "BBB"                 # 改行する
</pre>
<p>下記の様に、フォーマットを指定することもできます。</p>
<div class="tab">Python</div>
<pre class=c2>
print "My name is <em>%s</em>." <em>% "Tanaka"</em>
print "<em>%s</em> is <em>%d</em> years old." <em>% ("Tanaka", 28)</em>
print "<em>%(name)s</em> is <em>%(age)d</em> years old." <em>% {'name': "Tanaka", 'age': 28}</em>
</pre>
<p>標準出力以外に出力するには、<b>&gt;&gt;</b> を用います。</p>
<div class="tab">Python</div>
<pre class=c2>
f = open("test.txt", "w")
print <em>&gt;&gt; f,</em> "Hello world!"
f.close()
</pre>
<p>print文で複数の値を出力すると半角スペースで区切られますが、半角スペースを入れたくない場合は、sys.stdout.write() を使用します。</p>
<div class="tab">Python</div>
<pre class=c2>
import sys
<em>sys.stdout.write("Hello")</em>
<em>sys.stdout.write("World")</em>
</pre>
</div>

<h4 id="exec">exec文(exec)</h4>
<div class=i>
<p><b>exec文</b>(<b>exec</b>)は、引数の文字列を Python のスクリプトとして実行します。</p>
<div class="title-tab">文法</div>
<pre class=c2>
<b>exec</b> <i>statements</i> [<b>as</b> <i>global</i> [, <i>local</i>]]
</pre>
<p>サンプルを下記に示します。</p>
<div class="tab">Python</div>
<pre class=c2>
<em>exec "print 'Hello'"</em>
</pre>
<p><i>global</i> と <i>local</i> には、グローバル変数、ローカル変数を辞書形式で渡します。ローカル変数を省略した場合は、<i>global</i> が両方に適用されます。</p>
<div class="tab">Python</div>
<pre class=c2>
exec "print global_x, local_y" <em>in {'global_x': 100}, {'local_y': 200}</em>
</pre>
<p><i>statements</i> にはオープンしたファイルや、コンパイルしたコードオブジェクトを渡すこともできます。</p>
<div class="tab">Python</div>
<pre class=c2>
f = open("sample.py")
<em>exec f</em>

code = compile("print 'Hello'", "&lt;string&gt;", "exec");
<em>exec code</em>
</pre>
</div>

<hr>
<div>Copyright(C) 2014-2020 杜甫々</div>
<div>初版：2014年12月30日、最終更新：2020年3月22日</div>
<div>http://www.tohoho-web.com/python/control.html</div>
</body>
</html>

