<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>HTML5 - File API - ã¨ã»ã»ã®WWWå…¥é–€</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<link rel="stylesheet" href="../style3.css" tppabs="http://www.tohoho-web.com/style3.css">
</head>
<body>
<h2>HTML5 - File API</h2>
<a href="../www.htm" tppabs="http://www.tohoho-web.com/www.htm">ãƒˆãƒƒãƒ—</a> &gt;
<a href="index.html" tppabs="http://www.tohoho-web.com/html5/index.html">HTML5</a> &gt;
File API

<h4 id="features">File APIã¨ã¯</h4>
<div class=i>
<p>File API ã¨ã¯ã€JavaScript ã‹ã‚‰ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã® API ã§ã™ã€‚ä¸‹è¨˜ã§ä»•æ§˜ãŒæ¤œè¨ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
<ul>
<li>æœ€æ–°ç‰ˆ: <a target="_top" href="javascript:if(confirm('http://www.w3.org/TR/FileAPI/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.w3.org/TR/FileAPI/'" tppabs="http://www.w3.org/TR/FileAPI/">http://www.w3.org/TR/FileAPI/</a>
<li>ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ‰ãƒ©ãƒ•ãƒˆ: <a target="_top" href="javascript:if(confirm('https://www.w3.org/TR/2017/WD-FileAPI-20171026/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.w3.org/TR/2017/WD-FileAPI-20171026/'" tppabs="https://www.w3.org/TR/2017/WD-FileAPI-20171026/">https://www.w3.org/TR/2017/WD-FileAPI-20171026/</a> [WD]
</ul>
<p>ãŸã ã—ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’è€ƒæ…®ã—ã¦ã€ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªã®ã¯ã€åˆ©ç”¨è€…ãŒæ„è­˜çš„ã«é¸æŠã€ã‚ã‚‹ã„ã¯ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã«é™ã‚‰ã‚Œã¾ã™ã€‚</p>
<p>ç¾æ™‚ç‚¹ã§ã¯ä¸‹è¨˜ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
<ul>
<li>Internet Explorer 10
<li>Firefox 3.6
<li>Google Chrome 6
<li>Safari 6
<li>Edge 12
<li>Opera 11.5
</ul>
</div>

<h4>ã‚µãƒ³ãƒ—ãƒ«</h4>
<div class=i>
<p>File API ã®ã‚µãƒ³ãƒ—ãƒ«ã‚’ä¸‹è¨˜ã«ç¤ºã—ã¾ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠéƒ¨å“ã§ã€UTF-8 ã§ä¿å­˜ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã™ã‚‹ã¨ã€ãã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;div&gt;&lt;input type="file" id="file1"&gt;&lt;/div&gt;
&lt;div&gt;&lt;output id="output1"&gt;&lt;/output&gt;&lt;/div&gt;
&lt;script&gt;
window.addEventListener("load", function() {
  document.getElementById("file1").addEventListener("change", function() {
    var files = <em>document.getElementById('file1').files;</em>
    for (var i = 0; i &lt; files.length; i++) {
      var file = files[i];
      console.log("Name: " + file.name);
      console.log("Size: " + file.size);
      console.log("Type: " + file.type);
      console.log("Date: " + file.lastModified);
      console.log("Date: " + file.lastModifiedDate);
      var reader = <em>new FileReader();</em>
      reader.<em>onprogress</em> = function(evt) {
        console.log("State: " + target.readyState);
        console.log("Loaded: " + evt.loaded);
        console.log("Total: " + evt.total);
      };;
      reader.<em>onload</em> = function(evt) {
        console.log("State: " + evt.target.readyState);
        console.log("Result: " + evt.target.result);
        document.getElementById("output1").innerHTML = evt.target.result;
      };
      reader.<em>onerror</em> = function(evt) {
        console.log(evt.target.error.name);
      };
      <em>reader.readAsText(file, "utf-8");</em>
    }
  });
});
&lt;/script&gt;
</pre>
<div class="tab">è¡¨ç¤º</div>
<div class=c2>
<div><input type="file" id="file1"></div>
<div><output id="output1"></output></div>
<script>
window.addEventListener("load", function() {
  document.getElementById("file1").addEventListener("change", function(e) {
    var files = e.target.files;
    for (var i = 0; i < files.length; i++) {
      var file = files[i];
      console.log("Name: " + file.name);
      console.log("Size: " + file.size);
      console.log("Type: " + file.type);
      console.log("Date: " + file.lastModified);
      console.log("Date: " + file.lastModifiedDate);
      var reader = new FileReader();
      reader.onprogress = function(evt) {
        console.log("State: " + evt.target.readyState);
        console.log("Loaded: " + evt.loaded);
        console.log("Total: " + evt.total);
      };;
      reader.onload = function(evt) {
        console.log(evt.target);
        console.log("State: " + evt.target.readyState);
        console.log("Result: " + evt.target.result);
        document.getElementById("output1").innerHTML = evt.target.result;
      };
      reader.onerror = function(evt) {
        console.log(evt.target.error.name);
      };
      reader.readAsText(file, "utf-8");
    }
  });
});
</script>
</div>
</div>

<h4>ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©</h4>
<div class=i>
<div class="tab">ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©</div>
<pre class=c2>
interface <a href="#FileList">FileList</a> {
  readonly attribute unsigned long <a href="#length">length</a>;
  getter File <a href="#item">item</a>(unsigned long index);
};

interface <a href="#Blob">Blob</a> {
  readonly attribute unsigned long long <a href="#size">size</a>;
  readonly attribute DOMString <a href="#type">type</a>;
  Blob <a href="#slice">slice</a>(
    optional long long start,
    optional long long end,
    optional DOMString contentType);
};

interface <a href="#File">File</a> : Blob {
  readonly attribute DOMString <a href="#name">name</a>;
  readonly attribute long long <a href="#lastModified">lastModified</a>;
};

interface FileReader : EventTarget {
  readonly attribute unsigned short <a href="#readyState">readyState</a>;
  const unsigned short EMPTY = 0;
  const unsigned short LOADING = 1;
  const unsigned short DONE = 2;
  readonly attribute (DOMString or ArrayBuffer) <a href="#result">result</a>;
  readonly attribute DOMException <a href="#error">error</a>;

  void <a href="#readAsArrayBuffer">readAsArrayBuffer</a>(Blob blob);
  void <a href="#readAsBinaryString">readAsBinaryString</a>(Blob blob);
  void <a href="#reasAsText">readAsText</a>(Blob blob, optional DOMString encoding);
  void <a href="#readAsDataURL">readAsDataURL</a>(Blob blob);

  attribute EventHandler <a href="#onloadstart">onloadstart</a>;
  attribute EventHandler <a href="#onprogress">onprogress</a>;
  attribute EventHandler <a href="#onload">onload</a>;
  attribute EventHandler <a href="#onabort">onabort</a>;
  attribute EventHandler <a href="#onerror">onerror</a>;
  attribute EventHandler <a href="#onloadend">onloadend</a>;
};
</pre>
</div>

<h4 id="FileList">FileList ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</h4>
<div class=i>
<p><b>FileList</b> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ä¸‹è¨˜ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã€ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒã¡ã¾ã™ã€‚</p>
</div>

<h5>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</h5>
<div class=i>
<dl class="htmlattr">
<dt id="length">length</dt>
<dd>ãƒ•ã‚¡ã‚¤ãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å€‹æ•°ã€‚</dd>
</dl>
</div>

<h5>ãƒ¡ã‚½ãƒƒãƒ‰</h5>
<div class=i>
<dl class="htmlattr">
<dt id="item">item(<i>index</i>)</dt>
<dd>0 ã‹ã‚‰æ•°ãˆã¦ <i>index</i> ç•ªç›®ãƒ•ã‚¡ã‚¤ãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€‚</dd>
</dl>
</div>

<h4 id="Blob">Blob ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</h4>
<div class=i>
<p><b>Blob</b> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ä¸‹è¨˜ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã€ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒã¡ã¾ã™ã€‚</p>
</div>

<h5>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</h5>
<div class=i>
<dl class="htmlattr">
<dt id="size"><i>blob</i>.size</dt>
<dd>ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆæ•°å˜ä½)ã€‚</dd>
<dt id="type"><i>blob</i>.type</dt>
<dd>text/plain, image/png ãªã©ã®ãƒ•ã‚¡ã‚¤ãƒ«ç¨®åˆ¥ã€‚</dd>
</dl>
</div>

<h5>ãƒ¡ã‚½ãƒƒãƒ‰</h5>
<div class=i>
<dl class="htmlattr">
<dt id="slice"><i>blob</i>.slice(<i>start</i>, <i>stop</i>, <i>contentType</i>)</dt>
<dd>ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¤‡æ•°ã®ã‚¹ãƒ©ã‚¤ã‚¹ã«åˆ†å‰²ã—ã¦èª­ã¿è¾¼ã‚€éš›ã«ä½¿ç”¨ã—ã¾ã™ã€‚</dd>
</dl>
</div>

<h4 id="File">File ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</h4>
<div class=i>
<p><b>File</b> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€Blob ãŒæŒã¤ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã€ãƒ¡ã‚½ãƒƒãƒ‰ã«åŠ ãˆã€ä¸‹è¨˜ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒã¡ã¾ã™ã€‚</p>
</div>

<h5>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</h5>
<div class=i>
<dl class="htmlattr">
<dt id="name"><i>file</i>.name</dt>
<dd>ãƒ•ã‚¡ã‚¤ãƒ«åã€‚</dd>
<dt id="lastModified"><i>file</i>.lastModified</dt>
<dd>æœ€çµ‚æ›´æ–°æ—¥æ™‚ã€‚new Date(file.lastModified) ã§ Date ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›å¯èƒ½ã€‚</dd>
</dl>
</div>

<h4 id="FileReader">FileReader ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</h4>
<div class=i>
<p><b>FileReader</b> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ä¸‹è¨˜ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã€ãƒ¡ã‚½ãƒƒãƒ‰ã€ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã‚’æŒã¡ã¾ã™ã€‚</p>
</div>

<h5>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</h5>
<div class=i>
<dl class="htmlattr">
<dt id="readyState"><i>reader</i>.readyState</dt>
<dd>èª­ã¿è¾¼ã¿çŠ¶æ…‹ã‚’ç¤ºã—ã¾ã™ã€‚EMPTY(0), LODAING(1), DONE(2) ã„ãšã‚Œã‹ã®å€¤ã‚’æŒã¡ã¾ã™ã€‚</dd>
<dt id="result"><i>reader</i>.result</dt>
<dd>èª­ã¿è¾¼ã¿çµæœã‚’ä¿æŒã—ã¾ã™ã€‚èª­ã¿è¾¼ã¿å½¢å¼(readAsXxxx) ã«ã‚ˆã£ã¦å½¢å¼ãŒç•°ãªã‚Šã¾ã™ã€‚</dd>
<dt id="error"><i>reader</i>.error</dt>
<dd>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸéš›ã® DOMExtension ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä¿æŒã—ã¾ã™ã€‚</dd>
</dl>
</div>

<h5>ãƒ¡ã‚½ãƒƒãƒ‰</h5>
<div class=i>
<dl class="htmlattr">
<dt id="readAsArrayBuffer"><i>reader</i>.readAsArrayBuffer(<i>file</i>)</dt>
<dd>ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ ArrayBuffer å½¢å¼ã§èª­ã¿è¾¼ã¿ã¾ã™ã€‚</dd>
<dt id="readAsBinaryString"><i>reader</i>.readAsBinaryString(<i>file</i>)</dt>
<dd>ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ãƒã‚¤ãƒŠãƒªå½¢å¼ã§èª­ã¿è¾¼ã¿ã¾ã™ã€‚</dd>
<dt id="readAsText"><i>reader</i>.readAsText(<i>file</i>, <i>encoding</i>)</dt>
<dd>ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã§èª­ã¿è¾¼ã¿ã¾ã™ã€‚<i>encoding</i> ã«ã¯ "utf-8" ãªã©ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚çœç•¥æ™‚ã¯ "utf-8" ã¨ã¿ãªã•ã‚Œã¾ã™ã€‚</dd>
<dt id="readAsDataURL"><i>reader</i>.readAsDataURL(<i>file</i>)</dt>
<dd>ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ãƒ‡ãƒ¼ã‚¿URLå½¢å¼ã§èª­ã¿è¾¼ã¿ã¾ã™ã€‚</dd>
<dt id="abort"><i>reader</i>.abort()</dt>
<dd>ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã‚’ä¸­æ–­ã—ã¾ã™ã€‚</dd>
</dl>
</div>

<h5>ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©</h5>
<div class=i>
<dl class="htmlattr">
<dt id="onloadstart"><i>reader</i>.onloadstart</dt>
<dd>èª­ã¿è¾¼ã¿ãŒé–‹å§‹ã—ãŸéš›ã«å‘¼ã°ã‚Œã¾ã™ã€‚</dd>
<dt id="onprogress"><i>reader</i>.onprogress</dt>
<dd>é€”ä¸­çµŒéã®éš›ã«å‘¼ã°ã‚Œã¾ã™ã€‚FileReader ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã® readyState å±æ€§ã«çŠ¶æ…‹ãŒã€total å±æ€§ã«ç·ãƒã‚¤ãƒˆæ•°ã€loaded å±æ€§ã«èª­ã¿è¾¼ã¿æ¸ˆãƒã‚¤ãƒˆæ•°ãŒè¨­å®šã•ã‚Œã¾ã™ã€‚</dd>
<dt id="onload"><i>reader</i>.onload</dt>
<dd>èª­ã¿è¾¼ã¿ãŒå®Œäº†ã—ãŸéš›ã«å‘¼ã°ã‚Œã¾ã™ã€‚FileReader ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã® result å±æ€§ã«ã€èª­ã¿è¾¼ã¿ã‚’è¡Œã£ãŸãƒ¡ã‚½ãƒƒãƒ‰ã«å¿œã˜ãŸèª­ã¿è¾¼ã¿çµæœãŒæ ¼ç´ã•ã‚Œã¾ã™ã€‚</dd>
<dt id="onabort"><i>reader</i>.onabort</dt>
<dd>èª­ã¿è¾¼ã¿ãŒä¸­æ–­ã—ãŸéš›ã«å‘¼ã°ã‚Œã¾ã™ã€‚</dd>
<dt id="onerror"><i>reader</i>.onerror</dt>
<dd>èª­ã¿è¾¼ã¿ãŒã‚¨ãƒ©ãƒ¼ã¨ãªã£ãŸéš›ã«å‘¼ã°ã‚Œã¾ã™ã€‚FileReader ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã® error å±æ€§ãŒ DOMException ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç¤ºã—ã€ãã® name å±æ€§ãŒ "NotDoundError", "SecurityError", "NoReadableError" ãªã©ã®ã‚¨ãƒ©ãƒ¼ç¨®åˆ¥ã‚’ç¤ºã—ã¾ã™ã€‚</dd>
<dt id="onloadend"><i>reader</i>.onloadend</dt>
<dd>èª­ã¿è¾¼ã¿ãŒçµ‚äº†ã—ãŸéš›ã«å‘¼ã°ã‚Œã¾ã™ã€‚onload ãŒæˆåŠŸã—ãŸå ´åˆã®ã¿ã«å‘¼ã³å‡ºã•ã‚Œã‚‹ã®ã«å¯¾ã—ã€onloadend ã¯æˆåŠŸãƒ»å¤±æ•—ã«é–¢ã‚ã‚‰ãšå‘¼ã³å‡ºã•ã‚Œã¾ã™ã€‚</dd>
</dl>
</div>

<h4>ãƒ•ã‚¡ã‚¤ãƒ«å–å¾—</h4>
<div class=i>
<p>èª­ã¿è¾¼ã¿å¯èƒ½ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã™ã‚‹ã«ã¯ã€2é€šã‚Šã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚</p>
<ul>
<li>ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠéƒ¨å“ã§é¸æŠã™ã‚‹
<li>ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹
</ul>
<p>ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠéƒ¨å“ã§é¸æŠã™ã‚‹ã«ã¯æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠéƒ¨å“(&lt;input type="file"&gt;) ãŒå¤‰æ›´ã•ã‚ŒãŸæ™‚ç‚¹ã§ãƒãƒ³ãƒ‰ãƒ©ãŒå‘¼ã³å‡ºã•ã‚Œã€ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ãƒ¼ã‚²ãƒƒãƒˆã§ã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠéƒ¨å“(e.target) ã® files å±æ€§ã‚’å‚ç…§ã—ã¾ã™ã€‚</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;div&gt;&lt;input type="file" id="fileF1"&gt;&lt;/div&gt;
&lt;div&gt;&lt;output id="outputF1"&gt;&lt;/output&gt;&lt;/div&gt;
&lt;script&gt;
window.addEventListener("load", function() {
  document.getElementById("fileF1").addEventListener("change", function(e) {
    var files = <em>e.target.files;</em>
    for (var i = 0; i &lt; files.length; i++) {
      document.getElementById("outputF1").innerHTML += "&lt;div&gt;" + files[i].name + "&lt;/div&gt;";
    }
  });
});
&lt;/script&gt;
</pre>
<div class="tab">è¡¨ç¤º</div>
<div class=c2>
<div><input type="file" id="fileF1"></div>
<div><output id="outputF1"></output></div>
<script>
window.addEventListener("load", function() {
  document.getElementById("fileF1").addEventListener("change", function(evt) {
    var files = evt.target.files;
    for (var i = 0; i < files.length; i++) {
      document.getElementById("outputF1").innerHTML += "<div>" + files[i].name + "</div>";
    }
  });
});
</script>
</div>
<p>ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã™ã‚‹ã«ã¯æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ãƒ¼ã‚²ãƒƒãƒˆã§ã‚ã‚‹ãƒ‰ãƒ­ãƒƒãƒ—é ˜åŸŸã® dataTransfer.files å±æ€§ã‚’å‚ç…§ã—ã¾ã™ã€‚</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;div id="dropF2" style="height:50px; border: 1px solid gray;"&gt;
  ã“ã“ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ãã•ã„
&lt;/div&gt;
&lt;div&gt;&lt;output id="outputF2"&gt;&lt;/output&gt;&lt;/div&gt;
&lt;script&gt;
window.addEventListener("load", function() {
  document.getElementById("dropF2").addEventListener("<em>dragover</em>", function(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    evt.dataTransfer.dropEffect = "copy";
  });
  document.getElementById("dropF2").addEventListener("<em>drop</em>", function(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    var files = <em>evt.dataTransfer.files;</em>
    for (var i = 0; i &lt; files.length; i++) {
      document.getElementById("outputF2").innerHTML += "&lt;div&gt;" + files[i].name + "&lt;/div&gt;";
    }
  });
});
&lt;/script&gt;
</pre>
<div class="tab">è¡¨ç¤º</div>
<div class=c2>
<div id="dropF2" style="height:50px; border: 1px solid gray;">
  ã“ã“ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ãã•ã„
</div>
<div><output id="outputF2"></output></div>
<script>
window.addEventListener("load", function() {
  document.getElementById("dropF2").addEventListener("dragover", function(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    evt.dataTransfer.dropEffect = "copy";
  });
  document.getElementById("dropF2").addEventListener("drop", function(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    var files = evt.dataTransfer.files;
    for (var i = 0; i < files.length; i++) {
      document.getElementById("outputF2").innerHTML += "<div>" + files[i].name + "</div>";
    }
  });
});
</script>
</div>
</div>

<h4>ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿</h4>
<div class=i>
<p>ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿æ–¹ã¨ã—ã¦ã€ä¸‹è¨˜ã® 4é€šã‚Šã®æ–¹æ³•ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
<ul>
<li><b>readAsText()</b> : ãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦èª­ã¿è¾¼ã‚€
<li><b>readAsDataURL()</b> : ãƒ‡ãƒ¼ã‚¿URLå½¢å¼ã§èª­ã¿è¾¼ã‚€
<li><b>readAsBinaryString()</b> : ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦èª­ã¿è¾¼ã‚€
<li><b>readAsArrayBuffer()</b> : ArrayBuffer å½¢å¼ã§èª­ã¿è¾¼ã‚€
</ul>
<p><b>readAsText(</b><i>file</i>, <i>encoding</i><b>)</b> ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¨ã¿ãªã—ã¦èª­ã¿è¾¼ã¿ã¾ã™ã€‚<i>encoding</i> ã«ã¯ã€"utf-8", "Shift_JIS", "euc-jp", "iso-2022-jp" ãªã©ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚çœç•¥æ™‚æ™‚ã¯ "utf-8" ã¨ã¿ãªã•ã‚Œã¾ã™ã€‚</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;div&gt;&lt;input type="file" id="fileR1"&gt;&lt;/div&gt;
&lt;div&gt;&lt;output id="outputR1"&gt;&lt;/output&gt;&lt;/div&gt;
&lt;script&gt;
window.addEventListener("load", function() {
  document.getElementById("fileR1").addEventListener("change", function(e) {
    var files = e.target.files;
    for (var i = 0; i &lt; files.length; i++) {
      var file = files[i];
      var reader = new FileReader();
      reader.onload = function(evt) {
        document.getElementById("outputR1").innerHTML = <em>evt.target.result</em>;
      };
      <em>reader.readAsText(file, "utf-8");</em>
    }
  });
});
&lt;/script&gt;
</pre>
<div class="tab">è¡¨ç¤º</div>
<div class=c2>
<div><input type="file" id="fileR1"></div>
<div><output id="outputR1"></output></div>
<script>
window.addEventListener("load", function() {
  document.getElementById("fileR1").addEventListener("change", function(e) {
    var files = e.target.files;
    for (var i = 0; i < files.length; i++) {
      var file = files[i];
      var reader = new FileReader();
      reader.onload = function(evt) {
        document.getElementById("outputR1").innerHTML = evt.target.result;
      };
      reader.readAsText(file, "utf-8");
    }
  });
});
</script>
</div>
<p><b>readAsDataURL(</b><i>file</i><b>)</b> ã¯ã€URL ã®ä»£ã‚ã‚Šã«æŒ‡å®šå¯èƒ½ãªå½¢å¼ã§èª­ã¿è¾¼ã¿ã¾ã™ã€‚ãƒ†ã‚­ã‚¹ãƒˆã®å ´åˆã¯ data:text/plain;base64,77u/44GC44GE44GGDQo=ã€ç”»åƒã®å ´åˆã¯ data:image/png;base64,iVBORw0... ã®ã‚ˆã†ãªå½¢å¼ã§èª­ã¿è¾¼ã¾ã‚Œã¾ã™ã€‚ã“ã“ã§å¾—ã‚‰ã‚ŒãŸæ–‡å­—åˆ—ã‚’ <a href="../html/img.htm" tppabs="http://www.tohoho-web.com/html/img.htm">&lt;img&gt;</a> ã® src å±æ€§ã«æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€ç”»åƒã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;div&gt;&lt;input type="file" id="fileR2"&gt;&lt;/div&gt;
&lt;div&gt;&lt;output id="outputR2"&gt;&lt;/output&gt;&lt;/div&gt;
&lt;script&gt;
window.addEventListener("load", function() {
  document.getElementById("fileR2").addEventListener("change", function(e) {
    var files = e.target.files;
    for (var i = 0; i &lt; files.length; i++) {
      var file = files[i];
      var reader = new FileReader();
      reader.onload = function(evt) {
        document.getElementById("outputR2").innerHTML = <em>evt.target.result</em>;
      };
      <em>reader.readAsDataURL(file);</em>
    }
  });
});
&lt;/script&gt;
</pre>
<div class="tab">è¡¨ç¤º</div>
<div class=c2>
<div><input type="file" id="fileR2"></div>
<div><output id="outputR2"></output></div>
<script>
window.addEventListener("load", function() {
  document.getElementById("fileR2").addEventListener("change", function(e) {
    var files = e.target.files;
    for (var i = 0; i < files.length; i++) {
      var file = files[i];
      var reader = new FileReader();
      reader.onload = function(evt) {
        document.getElementById("outputR2").innerHTML = evt.target.result;
      };
      reader.readAsDataURL(file);
    }
  });
});
</script>
</div>
<p><b>readAsBinaryString(</b><i>file</i><b>)</b> ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒã‚¤ãƒŠãƒªå½¢å¼ã§èª­ã¿è¾¼ã¿ã¾ã™ã€‚Internet Explorer 11 ã§ã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ç¾æ™‚ç‚¹ã§ã¯ã€readAsBinaryString() ã¯å¾Œæ–¹äº’æ›æ€§ã®ãŸã‚ã«æ®‹ã•ã‚Œã¦ãŠã‚Šã€ä»£ã‚ã‚Šã« readAsArrayBuffer() ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;div&gt;&lt;input type="file" id="fileR3"&gt;&lt;/div&gt;
&lt;div&gt;&lt;output id="outputR3"&gt;&lt;/output&gt;&lt;/div&gt;
&lt;script&gt;
window.addEventListener("load", function() {
  document.getElementById("fileR3").addEventListener("change", function(e) {
    var files = e.target.files;
    for (var i = 0; i &lt; files.length; i++) {
      var file = files[i];
      var reader = new FileReader();
      reader.onload = function(evt) {
        document.getElementById("outputR3").innerHTML = <em>window.btoa(evt.target.result)</em>;
      };
      <em>reader.readAsBinaryString(file);</em>
    }
  });
});
&lt;/script&gt;
</pre>
<div class="tab">è¡¨ç¤º</div>
<div class=c2>
<div><input type="file" id="fileR3"></div>
<div><output id="outputR3"></output></div>
<script>
window.addEventListener("load", function() {
  document.getElementById("fileR3").addEventListener("change", function(e) {
    var files = e.target.files;
    for (var i = 0; i < files.length; i++) {
      var file = files[i];
      var reader = new FileReader();
      reader.onload = function(evt) {
        document.getElementById("outputR3").innerHTML = window.btoa(evt.target.result);
      };
      reader.readAsBinaryString(file);
    }
  });
});
</script>
</div>
<p><b>readAsArrayBuffer(</b><i>file</i><b>)</b> ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ ArrayBuffer å½¢å¼ã§èª­ã¿è¾¼ã¿ã¾ã™ã€‚ArrayBuffer ã¯ã€Uint8Array(), Uint16Array(), Uint32Array(), Float64Array() ãªã©ã®ãƒ“ãƒ¥ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”¨ã„ã¦ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;div&gt;&lt;input type="file" id="fileR4"&gt;&lt;/div&gt;
&lt;div&gt;&lt;output id="outputR4"&gt;&lt;/output&gt;&lt;/div&gt;
&lt;script&gt;
window.addEventListener("load", function() {
  document.getElementById("fileR4").addEventListener("change", function(e) {
    var files = e.target.files;
    for (var i = 0; i &lt; files.length; i++) {
      var file = files[i];
      var reader = new FileReader();
      reader.onload = function(evt) {
        <em>var data = new Uint8Array(evt.target.result);</em>
        for (var j = 0; j &lt; data.length; j++) {
          document.getElementById("outputR4").innerHTML += (<em>data[j]</em> + " ");
          console.log(data[j]);
        }
      };
      <em>reader.readAsArrayBuffer(file);</em>
    }
  });
});
&lt;/script&gt;
</pre>
<div class="tab">è¡¨ç¤º</div>
<div class=c2>
<div><input type="file" id="fileR4"></div>
<div><output id="outputR4"></output></div>
<script>
window.addEventListener("load", function() {
  document.getElementById("fileR4").addEventListener("change", function(e) {
    var files = e.target.files;
    for (var i = 0; i < files.length; i++) {
      var file = files[i];
      var reader = new FileReader();
      reader.onload = function(evt) {
        var data = new Uint8Array(evt.target.result);
        for (var j = 0; j < data.length; j++) {
          document.getElementById("outputR4").innerHTML += (data[j] + " ");
          console.log(data[j]);
        }
      };
      reader.readAsArrayBuffer(file);
    }
  });
});
</script>
</div>
</div>

<h4>ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¹ãƒ©ã‚¤ã‚¹èª­ã¿è¾¼ã¿</h4>
<div class=i>
<p>ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¤‡æ•°ã®ã‚¹ãƒ©ã‚¤ã‚¹ã«åˆ†å‰²ã—ã€æ–­ç‰‡çš„ã«èª­ã¿è¾¼ã‚€ã“ã¨ã§ã€å·¨å¤§ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¤‡æ•°ã® HTTP é€šä¿¡ã«åˆ†å‰²ã—ã¦é€ä¿¡ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã¨ãªã‚Šã¾ã™ã€‚ä¸‹è¨˜ã®ä¾‹ã§ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ 1024 ãƒã‚¤ãƒˆãšã¤èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™ã€‚</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;div&gt;&lt;input type="file" id="fileS1"&gt;&lt;/div&gt;
&lt;script&gt;
<em>var splitSize = 1024;</em>
window.addEventListener("load", function() {
  document.getElementById("fileS1").addEventListener("change", function(e) {
    var files = document.getElementById("fileS1").files;
    for (var i = 0; i &lt; files.length; i++) {
      var file = files[i];
      for (var j = 0; j &lt; file.size; j += splitSize) {
        <em>blob = file.slice(j, j + splitSize);</em>
        var reader = new FileReader(blob);
        reader.onload = function (e) {
          // e.target.result ã‚’ Ajux ç­‰ã§ã‚µãƒ¼ãƒã«é€ä¿¡ã™ã‚‹
        }
        reader.readAsBinaryString(<em>blob</em>);
      }
    }
  });
});
&lt;/script&gt;
</pre>
</div>


<div class=c>
<div><input type="file" id="fileS1"></div>
<div><output id="outputS1"></output></div>
<script>
var splitSize = 10;
window.addEventListener("load", function() {
  document.getElementById("fileS1").addEventListener("change", function(e) {
    var files = document.getElementById("fileS1").files;
    for (var i = 0; i < files.length; i++) {
      var file = files[i];
      for (var j = 0; j < file.size; j += splitSize) {
        blob = file.slice(j, j + splitSize);
        var reader = new FileReader(blob);
        reader.onload = function (e) {
          // e.target.result ã‚’ Ajux ç­‰ã§ã‚µãƒ¼ãƒã«é€ä¿¡ã™ã‚‹
          document.getElementById("outputS1").innerHTML += (e.target.result + "<br>");
        }
        reader.readAsBinaryString(blob);
      }
    }
  });
});
</script>
</div>

<h4><a id="links">ãƒªãƒ³ã‚¯</a></h4>
<div class=i>
<ul>
<li><a target="_top" href="javascript:if(confirm('http://www.w3.org/TR/FileAPI/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.w3.org/TR/FileAPI/'" tppabs="http://www.w3.org/TR/FileAPI/">http://www.w3.org/TR/FileAPI/</a>
<li><a target="_top" href="javascript:if(confirm('https://caniuse.com/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://caniuse.com/#search=File%20API'" tppabs="https://caniuse.com/#search=File%20API">https://caniuse.com/#search=File%20API</a>
</ul>
</div>

<hr>
<div>Copyright (C) 2012-2018 æœç”«ã€…</div>
<div>åˆç‰ˆï¼š2012å¹´5æœˆ6æ—¥ã€æœ€çµ‚æ›´æ–°ï¼š2018å¹´1æœˆ7æ—¥</div>
<div>http://www.tohoho-web.com/html5/index.html</div>
</body>
</html>
