<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>PHP入門 - 変数 - とほほのWWW入門</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<link rel="stylesheet" href="../style3.css" tppabs="http://www.tohoho-web.com/style3.css">
</head>
<body>
<h2>PHP入門 - 変数</h2>
<a href="../www.htm" tppabs="http://www.tohoho-web.com/www.htm">トップ</a> &gt;
<a href="index.html" tppabs="http://www.tohoho-web.com/php/index.html">PHP入門</a> &gt;
変数

<h4 id="variables">変数($xxx)</h4>
<div class=i>
<p>PHP ではすべての変数はドルマーク(<b>$</b>)＋変数名で現します。変数名には、アンダーバー(_)、数字(0～9)、文字(a～z, A～Z, 日本語等)を使用できます。ただし、数字で始まる変数名は使用できません。</p>
<div class="tab">PHP</div>
<pre class=c2>
&lt;?php
<em>$var</em> = "Hello";
<em>$Foo</em> = "World";
<em>$line_count</em> = 123;
<em>$名前</em> = "田中";             // 日本語も使用可能
<em># $365days</em> = "";           // 先頭が数字なので使用できない
</pre>
</div>

<h4 id="refference">変数の参照(&amp;$xxx)</h4>
<div class=i>
<p>アンパサンド(<b>&amp;</b>)を用いて変数の参照を表すことができます。下記の例では、$bar は $foo 変数への参照となり、$bar を変更することで、その実体である $foo の値を変更することが可能となります。</p>
<div class="tab">PHP</div>
<pre class=c2>
&lt;?php
$foo = "AAA";           // 変数 $foo に "AAA" を代入する
$bar = <em>&amp;$foo</em>;           // 変数 $foo への参照を $bar に代入する
$bar = "BBB";           // $bar を変更する (実体である $foo も変更される)
echo "$foo\n";          // BBB が出力される
echo "$bar\n";          // BBB が出力される
</pre>
<p>関数の引数でも参照を用いることができます。詳細は「<a href="function.html#refference" tppabs="http://www.tohoho-web.com/php/function.html#refference">値の参照渡し</a>」を参照してください。</p>
</div>

<h4 id="server">サーバ情報($_SERVER)</h4>
<div class=i>
<p><b>$_SERVER</b> には、HTTPサーバやHTTP通信に関わる情報が格納されます。</p>
<div class="tab">PHP</div>
<pre class=c2>
<em>$_SERVER['SERVER_ADDR']</em>           サーバのIPアドレス(例:192.168.0.1)
<em>$_SERVER['SERVER_NAME']</em>           サーバの名前(例:www.example.com)
<em>$_SERVER['SERVER_PORT']</em>           サーバのポート番号(例:80)
<em>$_SERVER['SERVER_PROTOCOL']</em>       サーバプロトコル(例:HTTP/1.1)
<em>$_SERVER['SERVER_ADMIN']</em>          サーバの管理者(例:root@localhost)
<em>$_SERVER['SERVER_SIGNATURE']</em>      サーバのシグニチャ(例:Apache/2.2.15...)
<em>$_SERVER['SERVER_SOFTWARE']</em>       サーバソフトウェア(例:Apache/2.2.15...)
<em>$_SERVER['GATEWAY_INTERFACE']</em>     CGIバージョン(例:CGI/1.1)
<em>$_SERVER['DOCUMENT_ROOT']</em>         ドキュメントルート(例:/var/www/html)
<em>$_SERVER['PATH']</em>                  環境変数PATHの値(例:/sbin:/usr/sbin:/bin:/usr/bin)
<em>$_SERVER['PATH_TRANSLATED']</em>       スクリプトファイル名(例:/var/www/html/test.php)
<em>$_SERVER['SCRIPT_FILENAME']</em>       スクリプトファイル名(例:/var/www/html/test.php)
<em>$_SERVER['REQUEST_URI']</em>           リクエストのURI(例:/test.php)
<em>$_SERVER['PHP_SELF']</em>              PHPスクリプト名(例:/test.php)
<em>$_SERVER['SCRIPT_NAME']</em>           スクリプト名(例:/test.php)
<em>$_SERVER['PATH_INFO']</em>             URLの引数に指定されたパス名(例:/test.php/aaa)
<em>$_SERVER['ORIG_PATH_INFO']</em>        PHPで処理される前のPATH_INFO情報
<em>$_SERVER['QUERY_STRING']</em>          URLの?以降に記述された引数(例:q=123)
<em>$_SERVER['REMOTE_ADDR']</em>           クライアントのIPアドレス(例:192.168.0.123)
<em>$_SERVER['REMOTE_HOST']</em>           クライアント名(例:client32.example.com)
<em>$_SERVER['REMOTE_PORT']</em>           クライアントのポート番号(例:64799)
<em>$_SERVER['REMOTE_USER']</em>           クライアントのユーザ名(例:tanaka)
<em>$_SERVER['REQUEST_METHOD']</em>        リクエストメソッド(例:GET)
<em>$_SERVER['REQUEST_TIME']</em>          リクエストのタイムスタンプ(例:1351987425)
<em>$_SERVER['REQUEST_TIME_FLOAT']</em>    リクエストのタイムスタンプ(マイクロ秒)(PHP 5.1.0以降)
<em>$_SERVER['REDIRECT_REMOTE_USER']</em>  リダイレクトされた場合の認証ユーザ(例:tanaka)
<em>$_SERVER['HTTP_ACCEPT']</em>           リクエストのAccept:ヘッダの値(例:text/html)
<em>$_SERVER['HTTP_ACCEPT_CHARSET']</em>   リクエストのAccept-Charset:ヘッダの値(例:utf-8)
<em>$_SERVER['HTTP_ACCEPT_ENCODING']</em>  リクエストのAccept-Encoding:ヘッダの値(例:gzip)
<em>$_SERVER['HTTP_ACCEPT_LANGUAGE']</em>  リクエストのAccept-Language:ヘッダの値(ja,en-US)
<em>$_SERVER['HTTP_CACHE_CONTROL']</em>    リクエストのCache-Control:ヘッダの値(例:max-age=0)
<em>$_SERVER['HTTP_CONNECTION']</em>       リクエストのConnection:ヘッダの値(例:keep-alive)
<em>$_SERVER['HTTP_HOST']</em>             リクエストのHost:ヘッダの値(例:www.example.com)
<em>$_SERVER['HTTP_REFERER']</em>          リンクの参照元URL(例:http://www.example.com/)
<em>$_SERVER['HTTP_USER_AGENT']</em>       リクエストのUser-Agent:ヘッダの値(例:Mozilla/5.0...)
<em>$_SERVER['HTTPS']</em>                 HTTPSを利用しているか否か(例:on)
<em>$_SERVER['PHP_AUTH_DIGEST']</em>       ダイジェスト認証時のAuthorization:ヘッダの値
<em>$_SERVER['PHP_AUTH_USER']</em>         HTTP認証時のユーザ名
<em>$_SERVER['PHP_AUTH_PW']</em>           HTTP認証時のパスワード
<em>$_SERVER['AUTH_TYPE']</em>             HTTP認証時の認証形式
</pre>
</div>

<h4 id="get">GETメソッド情報($_GET)</h4>
<div class=i>
<p><b>$_GET</b> には、HTTPのGETメソッドで渡される引数が格納されます。例えば、http://www.example.com/test.php?key=ABC&amp;page=3 にアクセスした場合、下記の変数が格納されます。</p>
<div class="tab">PHP</div>
<pre class=c2>
&lt;?php
echo <em>$_GET['key']</em>;   // ABC が出力される
echo <em>$_GET['page']</em>;  // 3 が出力される
</pre>
</div>

<h4 id="post">POSTメソッド情報($_POST)</h4>
<div class=i>
<p><b>$_POST</b> には、HTTPのPOSTメソッドで渡される引数が格納されます。例えば、下記のようなフォームからデータが送信されたとします。</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;form method="POST" action="test.php"&gt;
  &lt;input type="text" name="key" value="ABC"&gt;
  &lt;input type="text" name="page" value="3"&gt;
  &lt;input type="submit" value="OK"&gt;
&lt;/form&gt;
</pre>
<p>PHPでは、下記の変数を参照することができます。</p>
<div class="tab">PHP</div>
<pre class=c2>
&lt;?php
echo <em>$_POST['key']</em>;   // ABC が出力される
echo <em>$_POST['page']</em>;  // 3 が出力される
</pre>
</div>

<h4 id="cookie">Cookie情報($_COOKIE)</h4>
<div class=i>
<p><b>$_COOKIE</b> には、Cookieの値が格納されます。</p>
<div class="tab">PHP</div>
<pre class=c2>
&lt;?php
setCookie("mycookie", "mydata");
echo <em>$_COOKIE['mycookie']</em>;
</pre>
</div>

<h4 id="request">リクエスト情報($_REQUEST)</h4>
<div class=i>
<p><b>$_REQUEST</b> には、$_GET、$_POST の情報をマージした情報が格納されます。php.ini の variables_order に "GPC" と指定した場合は $_COOKIE の値も格納されます。</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;form method="POST" action="test.php?key1=AAA&amp;key2=BBB"&gt;
  &lt;input type="text" name="key3" value="CCC"&gt;
  &lt;input type="text" name="key4" value="DDD"&gt;
  &lt;input type="submit" value="OK"&gt;
&lt;/form&gt;
</pre>
<p>PHPでは、下記の変数を参照することができます。</p>
<div class="tab">PHP</div>
<pre class=c2>
&lt;?php
echo <em>$_REQUEST['key1']</em>;   // AAA が出力される
echo <em>$_REQUEST['key2']</em>;   // BBB が出力される
echo <em>$_REQUEST['key3']</em>;   // CCC が出力される
echo <em>$_REQUEST['key4']</em>;   // DDD が出力される
</pre>
</div>

<h4 id="files">ファイルアップロード($_FILES)</h4>
<div class=i>
<p><b>$_FILES</b> には、フォームからアップロードしたファイルに関する情報が格納されます。</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;form method="POST" enctype="multipart/form-data" action="test.php"&gt;
  &lt;input type="file" name="myfile"&gt;
  &lt;input type="submit" value="OK"&gt;
&lt;/form&gt;
</pre>
<p>上記のフォームからアップロードした場合、$_FILES には下記の値が格納されます。</p>
<div class="tab">PHP</div>
<pre class=c2>
&lt;?php
echo <em>$_FILES['myfile']['name']</em>;      // クライアント側ファイル名(例:test.jpg)
echo <em>$_FILES['myfile']['tmp_name']</em>;  // サーバ側ファイル名(例:/tmp/phpAnBAQe)
echo <em>$_FILES['myfile']['type']</em>;      // ファイルタイプ(例:image/jpeg)
echo <em>$_FILES['myfile']['size']</em>;      // ファイルサイズ(例:12345)
echo <em>$_FILES['myfile']['error']</em>;     // エラー番号(例:0)
</pre>
</div>

<h4 id="env">環境変数($_ENV)</h4>
<div class=i>
<p><b>$_ENV</b> には、環境変数の値が格納されます。</p>
<div class="tab">PHP</div>
<pre class=c2>
&lt;?php
echo <em>$_ENV['PATH']</em>;    // 環境変数 PATH の値が出力される
</pre>
</div>

<h4 id="session">セッション変数($_SESSION)</h4>
<div class=i>
<p><b>$_SESSION</b> には、セッション情報が格納されます。下記の例では、ページを再表示する度に、セッション変数に格納されたカウンター(counter)がインクリメント(加算)されながら表示されます。</p>
<div class="tab">PHP</div>
<pre class=c2>
&lt;?php
session_start();
if ($_SESSION['counter']) {
    $_SESSION['counter']++;
} else {
    $_SESSION['counter'] = 1;
}
echo <em>$_SESSION['counter']</em>;
</pre>
</div>

<h4 id="globals">グローバル変数($GLOBALS)</h4>
<div class=i>
<p><b>$GLOBALS</b> には、グローバル変数の連想配列が格納されます。例えば、グローバル変数 $foo が存在する時、$GLOBALS['foo'] で $foo の値を参照することができます。</p>
<div class="tab">PHP</div>
<pre class=c2>
&lt;?php
var_dump(<em>$GLOBALS</em>);
</pre>
</div>

<h4 id="args">コマンド引数($argc, $argv)</h4>
<div class=i>
<p><b>$argc</b>, <b>$argv</b> には、PHPスクリプトをコマンドラインから実行した際の、コマンド引数の個数、および引数の配列が格納されます。</p>
<div class="tab">PHP</div>
<pre class=c2>
&lt;?php
echo "Number of args: <em>$argc</em>\n";
foreach (<em>$argv</em> as $arg) {
    echo "$arg\n";
}
</pre>
</div>

<h4 id="php_errormsg">エラーメッセージ($php_errormsg)</h4>
<div class=i>
<p><b>$php_errormsg</b> には、直近のエラーメッセージが格納されます。php.ini で track_errors が On になっている場合のみ有効(デフォルトは Off)です。</p>
<div class="tab">PHP</div>
<pre class=c2>
&lt;?php
ini_set('track_errors', 1);

@strpos();
echo <em>$php_errormsg</em>;       // 例: strpos() expects at least 2 parameters, 0 given
</pre>
</div>

<h4 id="variable">可変変数($$xxx)</h4>
<div class=i>
<p>変数名を変数で表現することも可能です。$name が "var1" の時 $$name は $var1 を、$name が "var2" の時 $$name は $var2 と等価になります。</p>
<div class="tab">PHP</div>
<pre class=c2>
&lt;?php
$var1 = "AAA";
$var2 = "BBB";

$name = "var1";
echo <em>$$name</em>;    // AAA が出力される

$name = "var2";
echo <em>$$name</em>;    // BBB が出力される
</pre>
</div>

<hr>
<div>Copyright(C) 2013 杜甫々</div>
<div>初版：2013年5月12日、最終更新：2013年5月12日</div>
<div>http://www.tohoho-web.com/php/variables.html</div>
</body>
</html>
