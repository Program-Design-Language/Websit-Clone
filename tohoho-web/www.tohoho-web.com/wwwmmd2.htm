<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Windows Media Player - とほほのWWW入門</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<link rel="stylesheet" href="style3.css" tppabs="http://www.tohoho-web.com/style3.css">
</head>
<body>
<h2>Windows Media Player</h2>
<a href="www.htm" tppabs="http://www.tohoho-web.com/www.htm">トップ</a> &gt;
<a href="wwwmmdia.htm" tppabs="http://www.tohoho-web.com/wwwmmdia.htm">マルチメディア入門</a> &gt;
Windows Media Player

<h4 id="contents">目次</h4>
<ul>
<li><a href="#whatis">Windows Mediaとは？</a>
<li><a href="#filetype">ファイル形式</a>
<li><a href="#webauthor">Webページへの貼り付け方</a>
<li><a href="#javascript">JavaScriptから操作する</a>
<li><a href="#metafile">メタファイル</a>
<li><a href="#links">関連リンク</a>
</ul>

<h4 id="whatis">Windows Mediaとは？</h4>
<div class=i>
<p>WMT（Windows Media Technology）は、Microsoft社が開発したマルチメディア配信技術です。音声・動画のファイルフォーマット、再生ソフトの「Windows Media Player」、エンコードソフトの「Windows Media Encoder」、著作権管理の「Windows Media DRM」などから構成されます。</p>
<p>一昔前は、動画再生といえば Apple社の QuickTime が有名でしたが、インターネット配信時代になると RealNetworks社の RealPlayer が有名になりました。この RealPlayer に対抗して Microsoft社が独自開発したのが Windows Media Player です。</p>
</div>

<h4 id="filetype">ファイル形式</h4>
<div class=i>
<p>Windows Media に関連する主なファイルには下記のものがあります。</p>
<table class="tb1">
<tr><th>拡張子</th><th>MIMEタイプ</th><th>説明</th></tr>
<tr><td>.asf</td><td class="nowrap">video/x-ms-asf</td><td>Advanced Streaming Format。音声・動画ファイル。</td></tr>
<tr><td>.wma</td><td class="nowrap">audio/x-ms-wma</td><td>Windows Media Audio。音声ファイル。</td></tr>
<tr><td>.wmv</td><td class="nowrap">video/x-ms-wmv</td><td>Windows Media Audio/Video。音声・動画ファイル。</td></tr>
<tr><td>.asx</td><td class="nowrap">video/x-ms-asx</td><td>ASF用のメタファイル。</td></tr>
<tr><td>.wax</td><td class="nowrap">audio/x-ms-wax</td><td>WMA、ASF用のメタファイル。</td></tr>
<tr><td>.wvx</td><td class="nowrap">video/x-ms-wvx</td><td>WMV、WMA、ASF用のメタファイル。</td></tr>
</table>
<p>また、Windows Media Player では、上記の他に、CDオーディオ（.cda）、MIDIファイル（.mid .midi）、オーディオファイル（.wav .snd .au .aif .aifc .aiff）、ビデオファイル（.avi）、MPEGファイル（.mpg .mpeg）、MP3ファイル（.mp3）などを再生することができます。</p>
</div>

<h4 id="webauthor">Webページへの貼り付け方</h4>
<h5>◆ &lt;a href="..."&gt;</h5>
<div class=i>
<p><a href="html/a.htm" tppabs="http://www.tohoho-web.com/html/a.htm">&lt;a&gt;</a> で直接リンクします。リンクをクリックすると、IE, Firefox の場合、ウィンドウの左側にメディアバーが表示され、再生が始まります。Chrome, Opera の場合対象ファイルをダウンロードします。</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;a href="xxx.asf"&gt;サンプル&lt;/a&gt;
</pre>
</div>
<h5>◆ &lt;bgsound src="..."&gt;</h5>
<div class=i>
<p><a href="html/bgsound.htm" tppabs="http://www.tohoho-web.com/html/bgsound.htm">&lt;bgsound&gt;</a> を用いると、ページを開いたときに音声ファイルが再生されます。画面には何も表示されないので、閲覧者が止めたりすることはできません。古いバージョンの IE でのみ使用可能です。</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;bgsound src="xxx.asf"&gt;
</pre>
</div>
<h5>◆ &lt;img dynsrc="..."&gt;</h5>
<div class=i>
<p><a href="html/img.htm" tppabs="http://www.tohoho-web.com/html/img.htm">&lt;img dynsrc="..."&gt;</a> を用いると、ページを開いたときに動画ファイルがページ中で再生されます。IE でのみ使用可能です。</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;img dynsrc="xxx.wmv"&gt;
</pre>
</div>
<h5>◆ &lt;embed src="..."&gt;</h5>
<div class=i>
<p><a href="html/embed.htm" tppabs="http://www.tohoho-web.com/html/embed.htm">&lt;embed&gt;</a> を用いて音声ファイルや動画ファイルを貼り付けます。音量、左右バランス、ループ回数などをページ作成者や閲覧者が制御することができます。</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;embed src="xxx.asf"&gt;
</pre>
</div>
<h5>◆ &lt;object ...&gt;</h5>
<div class=i>
<p><a href="html/object.htm" tppabs="http://www.tohoho-web.com/html/object.htm">&lt;object&gt;</a> を用いるとさらに、再生するプラグインの種類やバージョンを指定することができます。古いバージョンの IE で利用可能です。IE11 や Edge ではサポートされなくなりました。</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;!-- Windows Media Player 6.3 の場合 --&gt;
&lt;object classid="CLSID:22D6F312-B0F6-11D0-94AB-0080C74C7E95"&gt;
 &lt;param name="FileName" value="xxx.asf"&gt;
 &lt;param name="AutoStart" value="true"&gt;
&lt;/object&gt;
</pre>
<div class="tab">HTML</div>
<pre class=c2>
&lt;!-- Windows Media Player 7.0 以降の場合 --&gt;
&lt;object classid="CLSID:6BF52A52-394A-11D3-B153-00C04F79FAA6"&gt;
 &lt;param name="URL" value="xxx.asf"&gt;
 &lt;param name="AutoStart" value="true"&gt;
&lt;/object&gt;
</pre>
<p>&lt;param&gt; でいろいろなパラメータを指定することができます。</p>
<table class="tb1">
<caption>【Windows Media Player 6.3】</caption>
<tr><th>パラメータ</th><th>説明</th></tr>
<tr><td>FileName</td><td>コンテンツファイルのURL。</td></tr>
<tr><td>AutoStart</td><td>true を指定するとページを開いたときに自動的に再生が始まる。</td></tr>
<tr><td>PlayCount</td><td>繰り返し回数。0 を指定すると無限に繰り返す。</td></tr>
<tr><td>AutoRewind</td><td>ture を指定すると停止時に開始位置に戻る。</td></tr>
<tr><td>Volume</td><td>音量。0 が最大音量。-10000 が最小音量。</td></tr>
<tr><td>Balance</td><td>左右バランス。-10000 が完全左のみの音声。10000 が完全右のみの音声。</td></tr>
<tr><td>ShowTracker</td><td>false を指定するとトラックコントロール（再生位置表示バー）を表示しない。</td></tr>
<tr><td>ShowAudioControls</td><td>false を指定するとオーディオコントロール（音量つまみなど）を表示しない。</td></tr>
<tr><td>ShowPositionControls</td><td>false を指定すると位置コントロール（早送りボタンなど）を表示しない。</td></tr>
<tr><td>ShowControls</td><td>false を指定するとすべてのコントロールを表示しない。</td></tr>
<tr><td>CurrentPosition</td><td>再生位置（先頭からの秒数）を示します。</td></tr>
<tr><td>その他</td><td><a href="javascript:if(confirm('http://www.microsoft.com/japan/msdn/library/ja/wmplay/mmp_sdk/lks_search.html  \n\nļ޷ Teleport Ultra , Ϊ һ·ⲿΪʼַĵַ  \n\nڷϴ?'))window.location='http://www.microsoft.com/japan/msdn/library/ja/wmplay/mmp_sdk/lks_search.html'" tppabs="http://www.microsoft.com/japan/msdn/library/ja/wmplay/mmp_sdk/windowsmediaplayercontrolversion64scriptingreference.asp?frame=true" target="_top">Windows Media 6.4 コントロールリファレンス</a> → [プロパティ]</td></tr>
</table>
<table class="tb1">
<caption>【Windows Media Player 7.0以降】</caption>
<tr><th class="nowrap">パラメータ</th><th>説明</th></tr>
<tr><td>URL</td><td>コンテンツファイルのURL。</td></tr>
<tr><td>AutoStart</td><td>true を指定するとページを開いたときに自動的に再生が始まる。</td></tr>
<tr><td>uiMode</td><td>表示モード。none（コントロール無し）、mini（最小限のコントロール）、full（すべてのコントロール）のいずれか。</td></tr>
<tr><td>その他</td><td>
<div><a href="javascript:if(confirm('http://www.microsoft.com/japan/msdn/library/ja/wmplay/mmp_sdk/628  \n\nļ޷ Teleport Ultra , Ϊ һ·ⲿΪʼַĵַ  \n\nڷϴ?'))window.location='http://www.microsoft.com/japan/msdn/library/ja/wmplay/mmp_sdk/628'" tppabs="http://www.microsoft.com/japan/msdn/library/ja/wmplay/mmp_sdk/windowsmediaplayeractivexcontrol.asp?frame=true" target="_top">Windows Media Player 7 ActiveX コントロール</a> → [コントロールリファレンス] → [Player]</div>
<div><a href="javascript:if(confirm('http://msdn2.microsoft.com/en-us/library/wcnt316.zip  \n\nļ޷ Teleport Ultra , Ϊ һ·ⲿΪʼַĵַ  \n\nڷϴ?'))window.location='http://msdn2.microsoft.com/en-us/library/wcnt316.zip'" tppabs="http://msdn2.microsoft.com/en-us/library/bb249282.aspx">Windows Media Player 11 SDK</a>→[Windows Media Player Object Model]→[Player Control Guide]→[Using the Windows Media Player Control in a Web Page]→[PARAM Tags]</div>
</td></tr>
</table>
</div>

<h4 id="javascript">JavaScriptから操作する</h4>
<div class=i>
<p>貼り付けた Windows Media Player を、JavaScript から操作することが可能です。下記では、再生、停止、一時停止、再生コンテンツの変更などを JavaScript から制御する例を示しています。</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;object id="p1"
  classid="CLSID:22D6F312-B0F6-11D0-94AB-0080C74C7E95" height=150 width=200&gt;
 &lt;param name="FileName" value="A.asf"&gt;
 &lt;param name="AutoStart" value="false"&gt;
 &lt;param name="ShowControls" value="false"&gt;
&lt;/object&gt;
&lt;div&gt;
 &lt;input type="radio" name="f" onclick="p1.FileName='A.asf'" checked&gt;動画Ａ
 &lt;input type="radio" name="f" onclick="p1.FileName='B.asf'"&gt;動画Ｂ
&lt;/div&gt;
&lt;div&gt;
 &lt;input type="button" value="再生" onclick="p1.play()"&gt;
 &lt;input type="button" value="停止" onclick="p1.stop(); p1.CurrentPosition=0;"&gt;
 &lt;input type="button" value="一時停止" onclick="p1.pause()"&gt;
&lt;/div&gt;
</pre>
<p>下記のようにして、再生が終了したときに発生されるイベントを捕獲して JavaScript を動かすこともできます。</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;object id="p1" classid="CLSID:22D6F312-B0F6-11D0-94AB-0080C74C7E95"&gt;
 &lt;param name="FileName" value="xxx.asf"&gt;
 &lt;param name="AutoStart" value="true"&gt;
&lt;/object&gt;

&lt;script for="p1" event="EndOfStream(lResult)"&gt;
alert("終わったよ!");
&lt;/script&gt;
</pre>
</div>

<h4 id="metafile">メタファイル</h4>
<div class=i>
<p>.asx .wax .wvx ファイルは、.asf .wma .wmv ファイルの再生方法などを指示するテキスト形式のメタファイルです。下記に最も簡単な例（xxx.asx）を示します。</p>
<div class="tab">ASX/WAX/WVX</div>
<pre class=c2>
&lt;ASX VERSION="3.0"&gt;
 &lt;ENTRY&gt;
  &lt;REF HREF="xxx.asf"/&gt;
 &lt;/ENTRY&gt;
&lt;/ASX&gt;
</pre>
<p>これを、Webページに次のようにして貼り付けます。</p>
<div class="tab">HTML</div>
<pre class=c2>
&lt;!-- Windows Media Player 6.3 の場合 --&gt;
&lt;object classid="CLSID:22D6F312-B0F6-11D0-94AB-0080C74C7E95"&gt;
 &lt;param name="FileName" value="xxx.asx"&gt;
 &lt;param name="AutoStart" value="true"&gt;
&lt;/object&gt;
</pre>
<p>このようなメタファイルを使用することにより、複数のコンテンツを連続再生したり、コンテントのタイトル、著作権情報を含めることが可能になります。下記は、メタファイルのちょっと複雑な例です。</p>
<div class="tab">ASX/WAX/WVX</div>
<pre class=c2>
&lt;ASX VERSION="3.0"&gt;
 &lt;TITLE&gt;タイトル&lt;/TITLE&gt;
 &lt;COPYRIGHT&gt;著作権情報&lt;/COPYRIGHT&gt;
 &lt;AUTHOR&gt;作者情報&lt;/AUTHOR&gt;
 &lt;ENTRY&gt;
  &lt;TITLE&gt;１曲目のタイトル&lt;/TITLE&gt;
  &lt;COPYRIGHT&gt;１曲目の著作権情報&lt;/COPYRIGHT&gt;
  &lt;AUTHOR&gt;１曲目の作者情報&lt;/AUTHOR&gt;
  &lt;REF HREF="xxx1.asf"/&gt;
 &lt;/ENTRY&gt;
 &lt;ENTRY&gt;
  &lt;TITLE&gt;２曲目のタイトル&lt;/TITLE&gt;
  &lt;COPYRIGHT&gt;２曲目のクリックの著作権情報&lt;/COPYRIGHT&gt;
  &lt;AUTHOR&gt;２曲目のクリップの作者情報&lt;/AUTHOR&gt;
  &lt;REF HREF="xxx2.asf"/&gt;
 &lt;/ENTRY&gt;
&lt;/ASX&gt;
</pre>
<p>詳細は、「<a href="javascript:if(confirm('http://www.microsoft.com/japan/msdn/library/wbord262.zip  \n\nļ޷ Teleport Ultra , Ϊ һ·ⲿΪʼַĵַ  \n\nڷϴ?'))window.location='http://www.microsoft.com/japan/msdn/library/wbord262.zip'" tppabs="http://www.microsoft.com/japan/msdn/library/default.asp?url=/japan/msdn/library/ja/wmplay/mmp_sdk/typesofplaylists.asp" target="_top">Windows Media Player SDK</a>」の「Windows Media メタファイル要素のリファレンス」を参照してください。</p>
</div>

<h4 id="links">関連リンク</h4>
<ul>
<li><a href="javascript:if(confirm('http://www.microsoft.com/japan/windows/windowsmedia/default.asp  \n\nļ޷ Teleport Ultra , Ϊ һ·ⲿΪʼַĵַ  \n\nڷϴ?'))window.location='http://www.microsoft.com/japan/windows/windowsmedia/default.asp'" tppabs="http://www.microsoft.com/japan/windows/windowsmedia/default.asp" target="_top">Windows Media</a>
<li><a href="javascript:if(confirm('http://www.microsoft.com/japan/msdn/library/ja/wmplay/mmp_sdk/default.asp  \n\nļ޷ Teleport Ultra , Ϊ һ·ⲿΪʼַĵַ  \n\nڷϴ?'))window.location='http://www.microsoft.com/japan/msdn/library/ja/wmplay/mmp_sdk/default.asp'" tppabs="http://www.microsoft.com/japan/msdn/library/ja/wmplay/mmp_sdk/default.asp" target="_top">Windows Media Player SDK</a>
<li><a href="javascript:if(confirm('http://www.microsoft.com/japan/msdn/windowsmedia/default.asp  \n\nļ޷ Teleport Ultra , Ϊ һ·ⲿΪʼַĵַ  \n\nڷϴ?'))window.location='http://www.microsoft.com/japan/msdn/windowsmedia/default.asp'" tppabs="http://www.microsoft.com/japan/msdn/windowsmedia/default.asp" target="_top">Windows Media Developer Center</a>
</ul>

<hr>
<div>Copyright (C) 2003-2016 杜甫々</div>
<div>初版：2002年1月19日、最終更新：2016年8月29日</div>
<div>http://www.tohoho-web.com/wwwmmd2.htm</div>
</body>
</html>
